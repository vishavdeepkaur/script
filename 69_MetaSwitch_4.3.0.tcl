#Start of MetaSwitch TGs

TESTGROUP 200
  RECSTARTGROUP "200 MetaSwitch Run All Working TGs"
  #The following do not work:  212 Hot and Warmline These have been commented out.
	
	##########101_Sanity Test Group#########
	  
	  TC 204
	  TC 75
	  TC 201100
	  TC 201101	  
	  TC 201102	  
	  TC 201103	  
	  TC 201104	  
	  TC 201105
	  TC 201106
	  TC 201107
	  TC 201108
	  TC 201109
	  TC 201110
	  TC 201111
	  TC 201112
	  TC 201113
	  TC 201114
	  TC 201115
	  TC 201116
	  TC 201117
	  TC 201118
	  TC 201119
	  TC 201120
	  TC 201121
	  TC 201122
	  TC 201123
	  TC 201124
	  TC 201121
	  TC 201125
	  TC 201126
	  TC 201127	  
	  TC 201128
	  #TC 201129
	  TC 401130
	  TC 201131
	  #TC 201132
	  #TC 201133
	  TC 401134
	  TC 201135
	  TC 201136
	  TC 201137
	  TC 401138
	  TC 204
  

  # ##202_Directory
			
		TC 202100
		TC 202102
		TC 202121
		TC 202122
		TC 202123
		TC 202124
		TC 2021041
		TC 2021131
		TC 202125
		TC 2021071
		TC 2021171
		#TC 202128
		TC 2021071
		#TC 202127
		TC 2021071
		TC 202129
		TC 2021071
		TC 2021301
		TC 2021071
		#TC 202131
		#TC 2021071
		TC 202132
		TC 2021071
		TC 2021161
		TC 2021071
		TC 2021181
		TC 2021071
		TC 2021331
		TC 2021071
		TC 2021151
		TC 2021071
		#TC 202134
		#TC 2021071
		#TC 202135 #For MetaSwitch and ClearSpan
		TC 204

  #203_Redial_MetaSwitch
		
		TC 203100
		TC 203102
		TC 203103
		TC 203104
		TC 203105
		TC 203106
		TC 203107
		TC 203108
		TC 203109
		#TC 203110 #No Add to directory
		#TC 203111 #No Add to directory
		TC 203112
		TC 203113
		TC 203114
		TC 203115
		TC 203116
		#TC 203117 #Copy from redial
		#'TC 203118
		# TC 203119
		#'TC 203120
		TC 203121
		#TC 203122 #DEfect, already in notice
		TC 203123
		#'TC 203124
		#'TC 203125
		TC 204

  #204_Callers_MetaSwitch

		TC 204100		
		TC 204102
		TC 204103
		TC 204104
		TC 204105
		#TC 204106
		TC 204107
		TC 204108
		#TC 204109 #Add to Directory
		##TC 204110 #^^^^
		TC 204111
		TC 204112
		TC 204113
		TC 204114
		TC 204115
		TC 204
  
  #205_Service_MetaSwitch
		
	#	TC 205100
	#	TC 205101
	#	TC 205102
	#	TC 205103
	#	TC 205104
	#	TC 205105
	#	TC 205106
	#	TC 205105
	#	TC 205107
	#	TC 205108
	#	TC 205109
	#	TC 205110
	#	TC 205111
	#	TC 205112
	#	TC 205113
	#	TC 205114
	#	TC 204
  
  #206_Xfer_MetaSwitch
	  	 
        TC 75		 
		TC 206100	
		TC 206101
		TC 206102
		TC 2061031
		TC 206104
		TC 2061051
		TC 206106 
		TC 206107
		#TC 206108
		TC 206109
		#TC 206110
		#TC 206111
		TC 206112
		TC 206113
		TC 206115
		TC 206116
		#TC 206117
		TC 206118
		TC 204
		
	##2061_Xfer_MetaSwitch(Speaker On)
	  	  
		#Press on  XML Menu to change the configuration
		TC 206100
		TC 206201
		TC 206202
		TC 206203
		TC 206204
		TC 206205
		TC 206206
		TC 206207
		#TC 206208
		TC 206209
		#TC 206210
		#TC 206211
		TC 206212
		#TC 206215
		TC 204

	  #207_Conf_MetaSwitch
	  
		TC 207100
		TC 2071001
		TC 207101
		TC 207102
		TC 207103
		#TC 207104
		TC 207105
		TC 207106
		#TC 207107
		#TC 207108 Known Defect CLN32808
		#TC 207109
		TC 207110
		#TC 207111 #Bug commented ut for now
		TC 207112
		TC 207113
		#TC 207114 #Dial out of directory
		#TC 5551
		#TC 207115
		#TC 207116
		TC 207118
		#TC 207119 #Key Message light does't blink
		TC 207120
		TC 207121
		TC 204

  #207_Conf_MetaSwitch
	  
		#Press on  XML Menu to change the configuration
		TC 75
		TC 207100
		#TC 12
		TC 2071001
		TC 207201
		TC 207202
		TC 207203
		#TC 207204
		TC 207205
		TC 207206 
		#TC 207207
		#TC 207208 Crash
		#TC 207209 Crash
		TC 207210 
		TC 207211 
		TC 207212
		#TC 207213    DEF42118
		#TC 207214 #Dials out of Directory
		#TC 5551
		#TC 207215 #Commented out for now because phone A doesn't selects the appropriate person to drop
		#TC 207216
		TC 207218
		#TC 207219 #Key Message light does't blink
		TC 204

		
		
	
	#211_Park/Pickup
	  
 		TC 211100
		TC 411101
		TC 411102
		TC 411201
		TC 411202
		TC 204
  
  
  # # 212_Hotline_Warmline

		# TC 212100
		# TC 212102
		# TC 212103
		# #'TC 212104
		# #'TC 212105
		# TC 212106
		# #'TC 212107
		# #'TC 212108
		# TC 212109
		# TC 212110
		# TC 204
  
   # 430 BLF Switch #TG ignored due to BLF problems, needs to fix the problem and then run it.TC's 430111 and 230115 needs to fix
		#TC 230100
		#TC 1
		#TC 230101
		#TC 230117
		#TC 230102
		#TC 230118
		#TC 230102
		#TC 230119
		#TC 230102
		#TC 230117
		#TC 230103
		#TC 230119
		#TC 230104
		#TC 230105
		#TC 230118
		#TC 230105
		#TC 230117
		#TC 230105
		#TC 230119
		#TC 230106
		#TC 230107
		#TC 230117
		#TC 230107
		#TC 230118
		#TC 230107
		# Commented from before #TC 230108	'DEFECT LAST FIRMWARE TESTED 3.3.344
		# Commented from before #TC 230119
		# Commented from before #TC 230108
		#TC 230117
		# Commented from before #TC 230108
		#TC 230109
		#TC 230119
		# Commented from before #TC 230110	'DEFECT LAST FIRMWARE TESTED 3.3.344
		#TC 430111
		#TC 230117
		#TC 230112
		#TC 230118
		#TC 230113
		#TC 230117
		#TC 230114
		#TC 230119
		#TC 230115
		# Commented from before #TC 230116 			Requires 7 phones
		
		#TC 204
		
  #236_Xfer_Live_Dial_MetaSwitch
	  	  
		TC 236100	
		TC 236101
		TC 236102
		TC 236103
		TC 236104
		TC 236105
		TC 236106
		TC 236107
		#TC 236108
		TC 236109
		#TC 236110
		#TC 236111
		TC 236112
		TC 236113
		TC 236115
		TC 204

  #237_Conf_Live_Dial_MetaSwitch
	  
	    TC 75
		TC 237100
		TC 2371001
		TC 237101
		TC 237102
		TC 237103
		#TC 237104
		TC 237105
		TC 237106
		#TC 237107
		#TC 237108 Crash
		#TC 237109 Crash
		TC 237110
		TC 237111
		TC 237112
		TC 237113
		#TC 237114 #Directory dail out
		#TC 5551
		#TC 237115
		#TC 237116
		TC 237118
		#TC 237119 #Bug key message doesn't blink
		TC 204

  
  #236_Xfer_Live_Dial_MetaSwitch
	  	  
		TC 75
		TC 236100	
		TC 2362011
		TC 2362021
		TC 236203
		TC 236204
		TC 236205
		TC 236206
		TC 236207
		#TC 236208 2 Line Xfer not working
		TC 236209
		#TC 236210
		TC 236211
		TC 236212
		#TC 236215
		TC 204

  #237_Conf_Live_Dial_MetaSwitch
	  
		TC 237100
		TC 2371001
		TC 237201
		TC 237202
		TC 237203
		#TC 237204
		TC 237205
		TC 237206
		#TC 237107
		#TC 237208
		#TC 237209 Crash
		#TC 237210 #bug so commented out
		TC 237211
		TC 237212
		TC 237213
		#TC 237214 #Direcotry Dial out
		#TC 5551
		#TC 237215 #Commented out for now because phone A doesn't selects the appropriate person to drop
		#TC 237216
		TC 204


	 # #Preferences
	    
		TC 75
		TC 140100
		#TC 2
		TC 140001
		TC 140002
		TC 140003
		TC 204
    
  ##250_MetaSwitch_Far_End_Bye
	  
		TC 250100
		TC 2501001
		TC 250101
		TC 250102
		TC 250103
		TC 250104
		#TC 250105
		TC 2501051
		TC 250106
		TC 250107
		TC 250108
		TC 250109
		TC 250110
		TC 250111
		TC 250112
		TC 250113
		TC 250114
		TC 250115
		#TC 250116
		TC 2501161
		#TC 250117
		TC 2501171
		TC 250118
		TC 250119
		TC 250120
		TC 250121
		TC 250122
		#TC 250123
		TC 2501231
		TC 250124
		TC 204
	  
	#260 SoftKeys
		#TC 160100
		#TC 3
		#TC 260101
		#TC 260102
		#TC 260103
		#TC 204

	#270 DTMF Digits
		#TC 170100
		#TC 555
		#TC 170100
		#TC 4
		#TC 270101
		#TC 270102
		#TC 270103
		#TC 270104
		#TC 270105
		##TC 270106
		##TC 270107
		#TC 204

   #280 MRTP
		#TC 180100
		#TC 280001
		#TC 280023
		#TC 280024
		#TC 280049
		#TC 280052111
		#TC 280053
		#TC 280033
		#TC 280066
		#TC 28005411
		#TC 280055
		#TC 28005611
		##TC 280057 
		#TC 280057111
		#TC 280058
		#TC 280059
		#TC 280060
		#TC 280064
		#TC 280071
		#TC 280077
		#TC 280078
		#TC 280080
		#TC 280081
		#TC 280082
		#TC 280101
		#TC 280102
		#TC 280103
		#TC 280104
		##TC 280105
		#TC 2801051
		#TC 280106
		#TC 280108
		#TC 280109
		#TC 280110
		##TC 280111
		#TC 2801111
		##TC 280112
		#TC 2801121
		##TC 280113
		#TC 2801131
		##TC 280114
		#TC 2801141
		##TC 280115
		##TC 280116
		##TC 280117 #Ignore this TC, the reason is given in the next TC. See the comment by opening the TESTCASE 2801171
		#TC 2801171
		#TC 280118
		#TC 2801191
		#TC 2801201
		#TC 280121 
		#TC 204

		#SCA Xfer # Ignored due to platform issues. Needs to fix it
		#TC 75
		#TC 426100
		#TC 426101
		#TC 426102
		#TC 426104
		#TC 426105
		#TC 426106
		#TC 426107
		#TC 426108
		#TC 426109
		#TC 426110
		#TC 426111
		#TC 426112
		#TC 426113
		#TC 426114
		##TC 426115
		#TC 204
		
		#TC 75
		#TC 426100
		#TC 426201A
		#TC 426202A
		#TC 426203A
		#TC 426204A
		#TC 426205A
		#TC 426206A
		#TC 426207A
		#TC 426208A
		#TC 426209A
		#TC 426210A
		#TC 426211A
		#TC 426212A
		#TC 426213A
		#TC 204

		#SCA Conf # Ignored due to platform issues. Needs to fix it
		
		#TC 75
		#TC 427100
		#TC 427101
		#TC 427102
		#TC 427103
		#TC 427104
		#TC 427105
		#TC 427106
		#TC 427107
		#TC 427108
		#TC 427109
		#TC 427110
		#TC 427111
		#TC 427112
		#TC 427113
		#TC 427114
		#TC 427115
		#TC 427116
		#TC 204
		
		#TC 75
		#TC 427100
		#TC 427201
		#TC 427202
		#TC 427203
		#TC 427204
		#TC 427205
		#TC 427206
		#TC 427207
		#TC 427208
		#TC 427209
		#TC 427210
		#TC 427211
		#TC 427212
		#TC 427213
		#TC 427214
		#TC 427215
		#TC 204
		
	#208 Call Forwarding
		TC 208100		
		TC 208102
		TC 208103
		TC 208104
		TC 208105
		TC 208106
		TC 204
	
	#209 Call Forwarding AFE
		#TC 209100
		#TC 208103
		#TC 208104
		#TC 208105
		#TC 208106
		#TC 204
ENDTG 
  
TESTGROUP 401
RECSTARTGROUP "401_Metaswitch_Sanity"
	##########101_Sanity Test Group#########
	  

	  TC 204
	  TC 75
	  TC 201100
	  TC 201101	  
	  TC 201102	  
	  TC 201103	  
	  TC 201104	  
	  TC 201105
	  TC 201106
	  TC 201107
	  TC 201108
	  TC 201109
	  TC 201110
	  TC 201111
	  TC 201112
	  TC 201113
	  TC 201114
	  TC 201115
	  TC 201116
	  TC 201117
	  TC 201118
	  TC 201119
	  TC 201120
	  TC 201121
	  TC 201122
	  TC 201123
	  TC 201124
	  TC 201121
	  TC 201125
	  TC 201126
	  TC 201127	  
	  TC 201128
	  #TC 201129
	  TC 401130
	  TC 201131
	  #TC 201132
	  #TC 201133
	  TC 401134
	  TC 201135
	  TC 201136
	  TC 201137
	  TC 401138
	  TC 204
  
ENDTG

TESTGROUP 202
  RECSTARTGROUP "202_Master_Dir_TestGroup"

##202_Directory
			
		TC 202100
		TC 202102
		TC 202121
		TC 202122
		TC 202123
		TC 202124
		TC 2021041
		TC 2021131
		TC 202125
		TC 2021071
		TC 2021171
		TC 202125
		#TC 202128
		#TC 202125
		TC 2021071
		#TC 202127
		TC 2021071
		TC 202129
		TC 2021071
		TC 2021301
		TC 2021071
		#TC 202131
		#TC 2021071
		TC 202132
		TC 2021071
		TC 2021161
		TC 2021071
		TC 2021181
		TC 2021071
		TC 2021331
		TC 2021071
		TC 2021151
		TC 2021071
		#TC 202134
		#TC 2021071
		#TC 202135 #For MetaSwitch and ClearSpan
		TC 204
	
	
ENDTG

TESTGROUP 203
  RECSTARTGROUP "203_Master_Redial_TestGroup"

		TC 203100
		TC 203102
		TC 203103
		TC 203104
		TC 203105
		TC 203106
		TC 203107
		TC 203108
		TC 203109
		#TC 203110 #No Add to directory
		#TC 203111 #No Add to directory
		TC 203112
		TC 203113
		TC 203114
		TC 203115
		TC 203116
		#TC 203117 #Copy from redial
		#'TC 203118
		# TC 203119
		#'TC 203120
		TC 203121
		#TC 203122 #DEfect, already in notice
		TC 203123
		#'TC 203124
		#'TC 203125
		TC 204
		
ENDTG

TESTGROUP 204
  RECSTARTGROUP "204_Master_Callers_TestGroup"
  
		TC 204100		
		TC 204102
		TC 204103
		TC 204104
		TC 204105
		#TC 204106
		TC 204107
		TC 204108
		#TC 204109 #Add to Directory
		##TC 204110 #^^^^
		TC 204111
		TC 204112
		TC 204113
		TC 204114
		TC 204115
		TC 204
  
ENDTG

TESTGROUP 205
  RECSTARTGROUP "205_Master_Services_TestGroup"

	#	TC 205100
	#	TC 205101
	#	TC 205102
	#	TC 205103
	#	TC 205104
	#	TC 205105
	#	TC 205106
	#	TC 205105
	#	TC 205107
	#	TC 205108
	#	TC 205109
	#	TC 205110
	#	TC 205111
	#	TC 205112
	#	TC 205113
	#	TC 205114
	#	TC 204
ENDTG


TESTGROUP 206
  RECSTARTGROUP "206_Xfer_MetaSwitch"
#206_Xfer_MetaSwitch
	  	  
       TC 75		 
		TC 206100	
		TC 206101
		TC 206102
		TC 2061031
		TC 206104
		TC 2061051
		TC 206106 
		TC 206107
		#TC 206108
		TC 206109
		#TC 206110
		#TC 206111
		TC 206112
		TC 206113
		TC 206115
		TC 206116
		#TC 206117
		TC 206118
		TC 204
		
 ENDTG

TESTGROUP 2061
  RECSTARTGROUP "2061_Xfer_MetaSwitch(Speaker On)" 
	##2061_Xfer_MetaSwitch(Speaker On)
	  	  
		#Press on  XML Menu to change the configuration
		TC 206100
		TC 206201
		TC 206202
		TC 206203
		TC 206204
		TC 206205
		TC 206206
		TC 206207
		#TC 206208
		TC 206209
		#TC 206210
		#TC 206211
		TC 206212
		#TC 206215
		TC 204
		
 ENDTG

 TESTGROUP 207
  RECSTARTGROUP "207_Conf_MetaSwitch" 
	  #207_Conf_MetaSwitch
	  
		TC 207100
		TC 2071001
		TC 207101
		TC 207102
		TC 207103
		#TC 207104
		TC 207105
		TC 207106
		#TC 207107
		#TC 207108 Known Defect CLN32808
		#TC 207109
		TC 207110
		#TC 207111 #Bug commented ut for now
		TC 207112
		TC 207113
		#TC 207114 #Dial out of directory
		#TC 5551
		#TC 207115
		#TC 207116
		TC 207118
		#TC 207119 #Key Message light does't blink
		TC 207120
		TC 207121
		TC 204
		
 ENDTG

 TESTGROUP 2071
  RECSTARTGROUP "2071_Conf_MetaSwitch(Speaker On)" 
  
  #207_Conf_MetaSwitch
	  
		#Press on  XML Menu to change the configuration
		TC 75
		TC 207100
		#TC 12
		TC 2071001
		TC 207201
		TC 207202
		TC 207203
		#TC 207204
		TC 207205
		TC 207206 
		#TC 207207
		#TC 207208 Crash
		#TC 207209 Crash
		TC 207210 
		TC 207211 
		TC 207212
		#TC 207213    DEF42118
		#TC 207214 #Dials out of Directory
		#TC 5551
		#TC 207215 #Commented out for now because phone A doesn't selects the appropriate person to drop
		#TC 207216
		TC 207218
		#TC 207219 #Key Message light does't blink
		TC 204

 ENDTG
		
	TESTGROUP 208
  RECSTARTGROUP "208_Call_Forward_TestGroup"
		
		TC 208100		
		TC 208102
		TC 208103
		TC 208104
		TC 208105
		TC 208106
		TC 204
		
ENDTG
		
TESTGROUP 209
  RECSTARTGROUP "209_Call_Forward_AFE_TestGroup"
  
		TC 209100
		TC 208103
		TC 208104
		TC 208105
		TC 208106
		TC 204
		
ENDTG

TESTGROUP 211
   RECSTARTGROUP "211_Park and Pick Up_TestGroup"
   
 		TC 211100
		TC 411101
		TC 411102
		TC 411201
		TC 411202
		TC 204
  
 ENDTG
  
  # # 212_Hotline_Warmline

		# TC 212100
		# TC 212102
		# TC 212103
		# #'TC 212104
		# #'TC 212105
		# TC 212106
		# #'TC 212107
		# #'TC 212108
		# TC 212109
		# TC 212110
		# TC 204
  
  ENDTG
  
   # 430 BLF Switch #TG ignored due to BLF problems, needs to fix the problem and then run it.TC's 430111 and 230115 needs to fix
	#TC 230100
		#TC 1
		#TC 230101
		#TC 230117
		#TC 230102
		#TC 230118
		#TC 230102
		#TC 230119
		#TC 230102
		#TC 230117
		#TC 230103
		#TC 230119
		#TC 230104
		#TC 230105
		#TC 230118
		#TC 230105
		#TC 230117
		#TC 230105
		#TC 230119
		#TC 230106
		#TC 230107
		#TC 230117
		#TC 230107
		#TC 230118
		#TC 230107
		# Commented from before #TC 230108	'DEFECT LAST FIRMWARE TESTED 3.3.344
		# Commented from before #TC 230119
		# Commented from before #TC 230108
		#TC 230117
		# Commented from before #TC 230108
		#TC 230109
		#TC 230119
		# Commented from before #TC 230110	'DEFECT LAST FIRMWARE TESTED 3.3.344
		#TC 430111
		#TC 230117
		#TC 230112
		#TC 230118
		#TC 230113
		#TC 230117
		#TC 230114
		#TC 230119
		#TC 230115
		# Commented from before #TC 230116 			Requires 7 phones
		#TC 204
		
 ENDTG

 
TESTGROUP 236
   RECSTARTGROUP "236_Xfer_Live_Dial_MetaSwitch"
   
   
  #236_Xfer_Live_Dial_MetaSwitch
	  	  
		TC 236100	
		TC 236101
		TC 236102
		TC 236103
		TC 236104
		TC 236105
		TC 236106
		TC 236107
		#TC 236108
		TC 236109
		#TC 236110
		#TC 236111
		TC 236112
		TC 236113
		TC 236115
		TC 204

 ENDTG


TESTGROUP 237
   RECSTARTGROUP "237_Conf_Live_Dial_MetaSwitch"
   
  #237_Conf_Live_Dial_MetaSwitch
	  
	    TC 75
		TC 237100
		TC 2371001
		TC 237101
		TC 237102
		TC 237103
		#TC 237104
		TC 237105
		TC 237106
		#TC 237107
		#TC 237108 Crash
		#TC 237109 Crash
		TC 237110
		TC 237111
		TC 237112
		TC 237113
		#TC 237114 #Directory dail out
		#TC 5551
		#TC 237115
		#TC 237116
		TC 237118
		#TC 237119 #Bug key message doesn't blink
		TC 204
 
 ENDTG

TESTGROUP 2361
   RECSTARTGROUP "2361_Xfer_Live_Dial_MetaSwitch"
   
  #236_Xfer_Live_Dial_MetaSwitch
	  	  
		TC 75
		TC 236100	
		TC 2362011
		TC 2362021
		TC 236203
		TC 236204
		TC 236205
		TC 236206
		TC 236207
		#TC 236208 2 Line Xfer not working
		TC 236209
		#TC 236210
		TC 236211
		TC 236212
		#TC 236215
		TC 204

 ENDTG
 
 TESTGROUP 2371
   RECSTARTGROUP "2371_Conf_Live_Dial_MetaSwitch"
   
   
  #237_Conf_Live_Dial_MetaSwitch
	  
		TC 237100
		TC 2371001
		TC 237201
		TC 237202
		TC 237203
		#TC 237204
		TC 237205
		TC 237206
		#TC 237107
		TC 237208
		#TC 237209 Crash
		#TC 237210 #bug so commented out
		TC 237211
		TC 237212
		TC 237213
		#TC 237214 #Direcotry Dial out
		#TC 5551
		#TC 237215 #Commented out for now because phone A doesn't selects the appropriate person to drop
		#TC 237216
		TC 204

ENDTG

TESTGROUP 140
  RECSTARTGROUP "280_Master_Preferences"

		TC 75
		TC 140100
		TC 140001
		TC 140002
		TC 140003
		TC 204
	
ENDTG    

TESTGROUP 250
  RECSTARTGROUP "250_Master_Far_End_Bye_TestGroup"

		TC 250100
		TC 2501001
		TC 250101
		TC 250102
		TC 250103
		TC 250104
		#TC 250105
		TC 2501051
		TC 250106
		TC 250107
		TC 250108
		TC 250109
		TC 250110
		TC 250111
		TC 250112
		TC 250113
		TC 250114
		TC 250115
		#TC 250116
		TC 2501161
		#TC 250117
		TC 2501171
		TC 250118
		TC 250119
		TC 250120
		TC 250121
		TC 250122
		#TC 250123
		TC 2501231
		TC 250124
		TC 204
		
ENDTG

TESTGROUP 260
  RECSTARTGROUP "260_Master_SOFT_KEYS"

		#TC 160100
		#TC 3
		#TC 260101
		#TC 260102
		#TC 260103
		#TC 204

ENDTG


TESTGROUP 270
  RECSTARTGROUP "270_Master_DTMF_DIGITS"

		#TC 170100
		#TC 555
		#TC 170100
		#TC 4
		#TC 270101
		#TC 270102
		#TC 270103
		#TC 270104
		#TC 270105
		##TC 270106
		##TC 270107
		#TC 204

ENDTG

TESTGROUP 280
  RECSTARTGROUP "280_Master_MRTP"
	  
		#TC 180100
		#TC 280001
		#TC 280023
		#TC 280024
		#TC 280049
		#TC 280052111
		#TC 280053
		#TC 280033
		#TC 280066
		#TC 28005411
		#TC 280055
		#TC 28005611
		##TC 280057 
		#TC 280057111
		#TC 280058
		#TC 280059
		#TC 280060
		#TC 280064
		#TC 280071
		#TC 280077
		#TC 280078
		#TC 280080
		#TC 280081
		#TC 280082
		#TC 280101
		#TC 280102
		#TC 280103
		#TC 280104
		##TC 280105
		#TC 2801051
		#TC 280106
		#TC 280108
		#TC 280109
		#TC 280110
		##TC 280111
		#TC 2801111
		##TC 280112
		#TC 2801121
		##TC 280113
		#TC 2801131
		##TC 280114
		#TC 2801141
		##TC 280115
		##TC 280116
		##TC 280117 #Ignore this TC, the reason is given in the next TC. See the comment by opening the TESTCASE 2801171
		#TC 2801171
		#TC 280118
		#TC 2801191
		#TC 2801201
		#TC 280121 
		#TC 204

ENDTG   

# TESTGROUP 426       
  # RECSTARTGROUP "426_Metaswitch_SCA_Xfer"
	 # ######426_Xfer_TestGroup#########
		
		# TC 75
		# TC 426100
		# TC 426101
		# TC 426102
		# TC 426104
		# TC 426105
		# TC 426106
		# TC 426107
		# TC 426108
		# TC 426109
		# TC 426110
		# TC 426111
		# TC 426112
		# TC 426113
		# TC 426114
		# #TC 426115
		# TC 204
		
		# TC 75
		# TC 426100
		# TC 426201A
		# TC 426202A
		# TC 426203A
		# TC 426204A
		# TC 426205A
		# TC 426206A
		# TC 426207A
		# TC 426208A
		# TC 426209A
		# TC 426210A
		# TC 426211A
		# TC 426212A
		# TC 426213A
		# TC 204
	
# ENDTG

# TESTGROUP 427      
  # RECSTARTGROUP "427_Metaswitch_SCA_Conf"
	
	
		# TC 75
		# TC 427100
		# TC 427101
		# TC 427102
		# TC 427103
		# TC 427104
		# TC 427105
		# TC 427106
		# TC 427107
		# TC 427108
		# TC 427109
		# TC 427110
		# TC 427111
		# TC 427112
		# TC 427113
		# TC 427114
		# TC 427115
		# TC 427116
		# TC 204
		
		# TC 75
		# TC 427100
		# TC 427201
		# TC 427202
		# TC 427203
		# TC 427204
		# TC 427205
		# TC 427206
		# TC 427207
		# TC 427208
		# TC 427209
		# TC 427210
		# TC 427211
		# TC 427212
		# TC 427213
		# TC 427214
		# TC 427215
		# TC 204
  
ENDTG

#End of MetaSwitch TGs
#Start of Master TCs

#****************************************************************************************************#
#EXECUTIVE TESTCASE 13798 - COMPLETE
# Line 1 in 1st, Line 2 in 2nd and 3rd phone are in a SCA group,
# Line 1 in 2nd and 3 rd have generic number and registered to the same server as Line 2,
# All three phones should ring,
# Verify NOTIFY (alerting) sent by the server and the LED status
# Test case needs to be repeated with all IP phones.(39i,57iCT and 31i) 
#****************************************************************************************************#
TESTCASE 240001 
LOCAL title="TESTCASE 240023 - Call offered to a SCA group of two - Ring"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Clear Phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8, "1:   "	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8, "2:   "	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8, "3:   "	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End, "5:   "				
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End, "6:   "				
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End, "7:   "			
	expectMsgSend SUBA,Do.Hook, Hook.On, "8: 	"
	expectMsgSend SUBB,Do.Hook, Hook.On, "9: 	"
	expectMsgSend SUBC,Do.Hook, Hook.On, "10: 	"
	wait 500
	  
	#Dial SCA Number From CL1 & Checks
	expectMsgSend SUBC,Do.Keys,"4165142539","11: "  
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"12: " 
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  
    expectMsgWait "13: "
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes 
	expectMsgWait "14: "
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER
    expectMsgWait "16: "
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER
    expectMsgWait "17: "
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"SCA Andy Anderson"+JOCKER 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink	
    expectMsgWait "18: "
	#expectMsgAdd SUBB,Do.KeyL3,Key.LightActiveBlink
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U12
	expectMsgAdd SUBB,Do.KeyF12,Key.LightActiveBlink
	expectMsgWait "19: "
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive
	expectMsgWait "20: "
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive 
	expectMsgWait "21: "
    
	#AL1 pick up & Checks
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"45: "  
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet 
    expectMsgAdd SUBA,Do.Connected,Connected.Yes
    expectMsgWait "50: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  
	
    expectMsgAdd SUBC,Do.Connected,Connected.Yes
    expectMsgWait "57: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"SCA Andy Anderson"+JOCKER  
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive	
    expectMsgWait "18: "
	#expectMsgAdd SUBB,Do.KeyL3,Key.LightActive
	expectMsgAdd SUBB,Do.KeyF12,Key.LightActive	
	expectMsgWait "19: "
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive	
	expectMsgWait "20: "
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive,"2: "  
	expectMsgWait "21: "
	
	#AL1 Hangs Up
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"22: " 
    expectMsgAdd SUBC,Do.Connected,Connected.No 
	expectMsgAdd SUBA,Do.Connected,Connected.No 
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect 
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  
    #@#expectMsgAdd SUBB,Do.InbandTone,InbandTone.QuietMissedCalls
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet
    expectMsgWait
	
	expectMsgSend SUBA,Do.Hook, Hook.On				
	expectMsgSend SUBB,Do.Hook, Hook.On
	expectMsgSend SUBC,Do.Hook, Hook.On
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U12
	wait 5000
	expectMsgWait

	WEND
ENDTC '101

#****************************************************************************************************#
#EXECUTIVE TESTCASE 13798 - COMPLETE
# Press goodbye or ignore on one of the phones
# Other 2 phones should continue ringing.
# Test case needs to be repeated with all IP phones.
#****************************************************************************************************#
TESTCASE 240002
LOCAL title="TESTCASE 240024 - Call offered to a SCA group of three phones � Drop call from one UA in the SCA group:"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
     WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	 
	#Clear Phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8, "1:   "	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8, "2:   "	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8, "3:   "	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End, "5:   "				
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End, "6:   "				
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End, "7:   "			
	expectMsgSend SUBA,Do.Hook, Hook.On, "8: 	"
	expectMsgSend SUBB,Do.Hook, Hook.On, "9: 	"
	expectMsgSend SUBC,Do.Hook, Hook.On, "10: 	"
	wait 500
 
	#Dial SCA Number From CL1 & Checks
	expectMsgSend SUBC,Do.Keys,"4165142539","11: "  
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial 
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"12: " 
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  
    expectMsgWait "13: "
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgWait "14: "
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  
    expectMsgWait "16: "
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  
    expectMsgWait "17: "
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"SCA Andy Anderson"+JOCKER  
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink	
    expectMsgWait "18: "
	#expectMsgAdd SUBB,Do.KeyL3,Key.LightActiveBlink
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U12
	expectMsgAdd SUBB,Do.KeyF12,Key.LightActiveBlink
	expectMsgWait "19: "
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive
	expectMsgWait "20: "
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive,"2: "
	expectMsgWait "21: "
    
	#B drops
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"45: "
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  
    expectMsgAdd SUBA,Do.Connected,Connected.No 
    expectMsgWait "50: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER 	
    expectMsgAdd SUBC,Do.Connected,Connected.No  
    expectMsgWait "57: "
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"SCA Andy Anderson"+JOCKER 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink	
    expectMsgWait "18: "
	#expectMsgAdd SUBB,Do.KeyL3,Key.LightActive
	expectMsgAdd SUBB,Do.KeyF12,Key.LightActive
	expectMsgWait "19: "
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive	
	expectMsgWait "20: "
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive,"2: "
	expectMsgWait "21: "
	
	wait 1500
	
	#AL1 Hangs Up
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"22: "  
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    #@#expectMsgAdd SUBB,Do.InbandTone,InbandTone.QuietMissedCalls
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait

	expectMsgSend SUBA,Do.Hook, Hook.On					
	expectMsgSend SUBB,Do.Hook, Hook.On
	expectMsgSend SUBC,Do.Hook, Hook.On
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U12
		
	wait 5000
	expectMsgWait 

	WEND
ENDTC '024


#####################################################################################################################################################
TESTCASE 140003
  LOCAL title="140003-Disable Goodbye Cancel Incoming call, check the behavior when having second inbound call with a connected call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"6: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"10: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "13: "
   
	# Disable Goodbye Cancel Incoming Call
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"14: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	# Phone B calls Phone A
    expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"24: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
    expectMsgWait "27: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgWait "29: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
	
	# Phone A answers
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"30: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
	expectMsgWait
	wait 1000
	
	# Phone C calls Phone A
    expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgWait
	wait 1000
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"54: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
   
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgWait "62: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
	
	# Phone A press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"89: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
	expectMsgWait
	wait 1000
    expectMsgWait "96: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Preferences TG"+JOCKER  ' m1s57b
	
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgWait "62: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
	expectMsgWait
	wait 1000
	
	# End the call
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"98: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
  
    expectMsgWait "105: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Preferences TG"+JOCKER  ' m1s57c
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"106: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgWait "109: "
   
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"110: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "113: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Preferences TG"+JOCKER  ' m1s57a
	expectMsgWait
	wait 2000
	
	# Enable Goodbye Cancel Incoming Call
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"114: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	# Initial state of phones
    expectMsgSend SUBA,Do.Hook,Hook.On,"115: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"116: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"117: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"118: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"119: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"120: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 2000
	
  WEND
ENDTC 





##################################################################################
#
#		Preferences
#
###################################################################################

'write purpose of recorded tc here
'
'James on A155-ENGTEST the 08/13/2013 14:17:16
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 140100
  LOCAL title="Preferences Config"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)  
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"20: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"21: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"22: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"23: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"24: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"30: "  ' m1s57a  ' pseudo
    
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"33: "  ' m1s57b  ' pseudo
   
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"36: "  ' m1s57c  ' pseudo
   
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"39: "  ' m1s57d  ' pseudo
  
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"42: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
  WEND
ENDTC  








#######################################################################
'TC 201100- Sanity Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 201100
  LOCAL title="TC201100- Sanity Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=5

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
  WEND
ENDTC '201100







####################################################################################################
'Clear Callers List
'
'pvaastra on bos-bgalasso the 02/08/2012 10:11:30
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201101
 LOCAL count=0
  LOCAL title="TC201101-Clear Callers List"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	REPEAT  
	RECINFO "Count : "+count  
	#'Press goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#'Ensure Hook ON
	expectMsgSend SUBC,Do.Hook,Hook.On,"3: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
    wait 2000	
	#'Press Callers
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"6: "  ' m1s57a  ' pseudo
  	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"10: "  ' m1s57b  ' pseudo
   	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8,"14: "  ' m1s57c  ' pseudo
    wait 2000
	#'Press Delete
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"18: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"19: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"24: "  ' m1s57c  ' pseudo
    #wait 2000
	
	
	#Press Delete List
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"25: "  ' m1s57a  ' pseudo
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"26: "  ' m1s57b  ' pseudo
	#expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"29: "  ' m1s57c  ' pseudo
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"25: "  ' m1s57a  ' pseudo
	'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"26: "  ' m1s57b  ' pseudo
	'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57c  ' pseudo
	
	#'Press OK
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"30: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"34: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57c  ' pseudo
	
	wait 2000
    #'Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"42: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"43: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57c  ' pseudo
    expectMsgWait	
	wait 1000	
	count=count+1
	UNTIL count=1
	
  WEND
ENDTC '201101






#############################################################################################
'Set Audio mode to Speaker
'
'pvaastra on bos-bgalasso the 02/08/2012 11:21:18
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201102
  LOCAL count=0
  LOCAL title="TC201102-Set Audio mode to Speaker"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	wait 1000
	#Press Settings
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Settings,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Settings,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Settings,"5: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Preferences
	#expectMsgSend SUBA,Do.Keys,"2","6: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Keys,"2","8: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Set Audio
	#expectMsgSend SUBA,Do.Keys,"5","9: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Keys,"5","11: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Audio Mode
	#expectMsgSend SUBA,Do.Keys,"1","12: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Keys,"1","14: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Speaker
	#expectMsgSend SUBA,Do.Keys,"1","15: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Keys,"1","17: "  ' m1s57c  ' pseudo
    wait 1000
	#Press GoodBye
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"18: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"19: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"20: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201102






#############################################################################################

'Phone A calls Phone B, Hear Ringback on A
'
'pvaastra on bos-bgalasso the 02/08/2012 11:41:04
'  SUBA(m1s57a)  SUBB(m1s57b)  
TESTCASE 201103
  LOCAL count=0
  LOCAL title="TC201103-Outgoing Call-Phone A calls Phone B, Hear Ringback on A_Handset"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY())
	REPEAT  
	RECINFO "Count : "+count  
	#Hook ON
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    wait 1000
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57b  ' pseudo
    wait 1000
	#Hook OFF Phone A 
	expectMsgSend SUBA,Do.Hook,Hook.Off,"4: "  ' m1s57a  ' pseudo
    #Check for Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Check if Phone A is Hooked OFF
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #Type Phone B Number
	#expectMsgSend SUBA,Do.Keys,SUBB.number,"12: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12
	expectMsgWait "22: "
    #Check on Phone A if the number typed is of Phone B
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing on from phone A's Handset
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #User of Phone B is hearing a ringing tone
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b 
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgWait "27: "
	#Check if line 4 in display of Phone B is showing Phone A's number
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "28: "
	#Check if line 4 in display of Phone B is showing Phone A's Callerd ID name
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 6000
	expectMsgSend SUBA,Do.Hook,Hook.On,"31: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgWait "37: "
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"43: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"45: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1

	#'Press Callers	
  	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"50: "  ' m1s57b  ' pseudo   
    #wait 2000
	#'Press Delete
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"52: "  ' m1s57b  ' pseudo
	#wait 2000
    #New Feature Press DeleteList to erase all items
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"55: "  ' m1s57b  ' pseudo
	#wait 2000
	#'Press OK	
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"60: "  ' m1s57b  ' pseudo
  	#wait 2000
   #'Press Goodbye
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"65: "  ' m1s57b  ' pseudo  
    #expectMsgWait	
	#wait 1000	
	
	WEND
ENDTC '201103






#############################################################################################
'Phone A calls Phone B, B Picks, 2-way audio
'pvaastra on bos-bgalasso the 02/08/2012 12:03:19
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201104
  LOCAL count=0
  LOCAL title="TC201104-Outgoing Call-Phone A calls Phone B, B Picks, 2-way audio_handset"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
    #Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	wait 1000
    #Hook ON all the phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
	#Hook OFF Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"8: "  ' m1s57a  ' pseudo
    #Check for Dial Tone on PHone A
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Check if Phone A is Hooked Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #Dial Phone B's Number
    expectMsgSend SUBA,Do.Keys,SUBB.number,"16: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait "26: "
    #Check if Phone B's number on Phone A' Display
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing from Phone A Handset
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #Check if Phone B is ringing from the Phone B user's side 
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "31: "
	#Check if line 4 in display of Phone B is showing Phone A's number
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "32: "
	#Check if line 4 in display of Phone B is showing Phone A's Callerd ID name
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
	wait 2000
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"35: "  ' m1s57b  ' pseudo
    #Check if Phone B is Hooked OFF
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #Check if Phone B is Connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #Check if Phone B is not ringing anymore
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    #Check if Phone A is connected
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #Check if Phone A doesn't have a Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    expectMsgWait "44: "
	#Check if Phone A displays Phone B's number while the call is ON
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#Hook ON Phone B to finish the call
	expectMsgSend SUBB,Do.Hook,Hook.On,"81: "  ' m1s57b  ' pseudo
    #Check if Phone B is hooked ON 
	expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    #Check if both Phone A and Phone B are disconnected
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    wait 1000
	expectMsgWait
	'expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201104






#############################################################################################

'Phone A calls B, B Picks, L1 LED on A is Solid
'
'pvaastra on bos-bgalasso the 02/08/2012 12:03:19
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201105
  LOCAL count=0
  LOCAL title="TC201105-Phone A calls B, B Picks, L1 LED on A is Solid_Handset"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
    #Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	wait 1000
    #Hook ON all the phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
	#Hook OFF Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"8: "  ' m1s57a  ' pseudo
	#Check if L1 Led on Phone A is Solid
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #Check for Dial Tone on PHone A
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Check if Phone A is Hooked Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #Dial Phone B's Number
    expectMsgSend SUBA,Do.Keys,SUBB.number,"16: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait "26: "
    #Check if Phone B's number on Phone A' Display
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing from Phone A Handset
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #Check if Phone B is ringing from the Phone B user's side 
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgWait "31: "
	#Check if line 4 in display of Phone B is showing Phone A's number
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "32: "
	#Check if line 4 in display of Phone B is showing Phone A's Callerd ID name
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
	wait 2000
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"35: "  ' m1s57b  ' pseudo
	#Check if LED on L1 of Phone B is solid
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #Check if Phone B is Hooked OFF
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #Check if Phone B is Connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #Check if Phone B is not ringing anymore
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    #Check if Phone A is connected
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #Check if Phone A doesn't have a Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    expectMsgWait "44: "
	#Check if Phone A displays Phone B's number while the call is ON
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#Hook ON Phone B to finish the call
	expectMsgSend SUBB,Do.Hook,Hook.On,"81: "  ' m1s57b  ' pseudo
    #Check if Phone B is hooked ON 
	expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    #Check if both Phone A and Phone B are disconnected
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b 'abscccccccc
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	#Check if LED's are OFF
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    wait 1000
	expectMsgWait
	'expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201105






#############################################################################################

'Incoming Call-Phone B calls Phone A, Hear Ringing on A
'
'pvaastra on bos-bgalasso the 02/08/2012 15:36:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201106
  LOCAL count=0
  LOCAL title="TC201106-Incoming Call-Phone B calls Phone A, Hear Ringing on A_Handset"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Phone B Hook OFF
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    #Check for Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #Check if Phone B is Hooked OFF
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	#Dial Phone A Number
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
    #Check if the number on Phone B's display is Phone A number
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing from Phone B's Handset
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #Check if Phone A is ringing from Phone A' side
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check if the display is correct on Phone A
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 5000
	expectMsgSend SUBB,Do.Hook,Hook.On,"20: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgWait "26: "
    expectMsgWait
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201106






#############################################################################################

'Incoming Call-Phone B calls Phone A, Hear Ringing on A
'
'pvaastra on bos-bgalasso the 02/08/2012 15:36:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201107
  LOCAL count=0
  LOCAL title="TC201107-Incoming Call-Phone B calls Phone A, LED Flashing on A_Handset"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Phone B Hook OFF
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    #Check for Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	#Check if L1 LED is Solid on Phone B
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  
    #Check if Phone B is Hooked OFF
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	#Dial Phone A Number
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
    #Check if the number on Phone B's display is Phone A number
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing from Phone B's Handset
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #Check if Phone A is ringing from Phone A' side
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check if the L1 LED is blinking on Phone A
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink
	#Check if the display is correct on Phone A
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 6000
	expectMsgSend SUBB,Do.Hook,Hook.On,"20: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgWait "26: "
    expectMsgWait
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201107






#############################################################################################

'Incoming Call-Phone B calls A, A Picks, L1 LED on A is Solid
'
'pvaastra on bos-bgalasso the 02/08/2012 16:08:09
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201108
  LOCAL count=0
  LOCAL title="TC201108-Incoming Call-Phone B calls A, A Picks, L1 LED on A is Solid_Handset"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    #Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"6: "  ' m1s57b  ' pseudo
    #Check Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #Check if L1 LED is Solid on Phone B
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive 
	#Check Hook Off on Phone B
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b    
	#Dial phone A number
    expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
    #Check if Phone B' displays shows Phone A's number 
    expectMsgWait "13: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing from Phone B's Handset
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
	#Check if Phone A is ringing from Phone A' side
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check if the L1 LED is blinking on Phone A
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink
	#Check if the display is correct on Phone A
    expectMsgWait "16: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "17: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 5000
	#Hook Off Phone A
    expectMsgSend SUBA,Do.Hook,Hook.Off,"18: "  ' m1s57a  ' pseudo
    #Check if Phone A is hooked off
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #Check if LED on L1 of Phone A is solid
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57b
	#Check if Phone A is connected
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#Check if Phone A stops ringing
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    #Check if Phone B is Connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #Check if there is no Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
	#Check the display of Phone B
    expectMsgWait "25: "
    wait 5000
	#Hook on Phone A to end the call
	expectMsgSend SUBA,Do.Hook,Hook.On,"26: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    #Check if Phones are not connected anymore
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
 
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    #Press Goodbye
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"37: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"38: "  ' m1s57a  ' pseudo
    wait 1000
	#Hook On both the phones
	expectMsgSend SUBB,Do.Hook,Hook.On,"39: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201108






#############################################################################################
'Outgoing Call-Phone A calls Phone B, Hear Ringback on A_Speaker
'
'pvaastra on bos-bgalasso the 02/08/2012 16:53:46
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201109
  LOCAL count=0
  LOCAL title="TC201109-Outgoing Call-Phone A calls Phone B, Hear Ringback on A_Speaker"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Hook ON 
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Speaker on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Loudspeaker,"6: "  ' m1s57a  ' pseudo
    #Check for Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Dial Phone B's number
    expectMsgSend SUBA,Do.Keys,SUBB.number,"10: "  ' m1s57a  ' pseudo
    #Check Phone A' display
    expectMsgWait "11: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing from Phone A Speaker
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgWait "13: "
	#Check display of Phone B
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "14: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    #Ckeck if Phone B is ringing from Phone B user's side
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	wait 5000
	#press GoodBye from Phone A
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"16: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	 expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgWait "20: "    
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201109






#############################################################################################

'Outgoing Call-Phone A calls Phone B, B Picks, 2-way audio_Speak
'
'pvaastra on bos-bgalasso the 02/09/2012 09:18:45
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201110
  LOCAL count=0
  LOCAL title="TC201110-Outgoing Call-Phone A calls Phone B, B Picks, 2-way audio_Speaker"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
   RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Speaker on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Loudspeaker,"6: "  ' m1s57a  ' pseudo
    #Check for Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Dial Phone B's number
    expectMsgSend SUBA,Do.Keys,SUBB.number,"10: "  ' m1s57a  ' pseudo
    #Check display on Phone A
    expectMsgWait "11: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing from Phone A's Speaker
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #Check if Phone b is Ringing from Phone B user's side
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	#Check display on Phone B
    expectMsgWait "14: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "15: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    #Press L1 on Phone B
	expectMsgSend SUBB,Do.KeyL1,Key.Click,"16: "  ' m1s57b  ' pseudo
    #Check if Phones are connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    
    expectMsgWait "21: "
    #Check Display of Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#press goodbye on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"22: "  ' m1s57b  ' pseudo
    #Check if Phones are disconnected
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "28: "
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"31: "  ' m1s57a  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201110






#############################################################################################

'Phone A calls B, B Picks, L1 LED on A is Solid
'
'pvaastra on bos-bgalasso the 02/08/2012 12:03:19
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201111
  LOCAL count=0
  LOCAL title="TC201111-Outgoing Call-Phone A calls B, B Picks, L1 LED on A is Solid_Speaker"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
    #Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	wait 1000
    #Hook ON all the phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
	#Press Speaker on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Loudspeaker,"6: "  ' m1s57a  ' pseudo
	#Check if L1 Led on Phone A is Solid
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #Check for Dial Tone on PHone A
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Dial Phone B's Number
    expectMsgSend SUBA,Do.Keys,SUBB.number,"16: "  ' m1s57a  ' pseudo
	expectMsgWait "26: "
    #Check if Phone B's number on Phone A' Display
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing from Phone A Handset
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #Check if Phone B is ringing from the Phone B user's side 
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "31: "
	#Check if line 4 in display of Phone B is showing Phone A's number
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "32: "
	#Check if line 4 in display of Phone B is showing Phone A's Callerd ID name
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
	wait 2000
	#Press L1 on Phone B
	expectMsgSend SUBB,Do.KeyL1,Key.Click,"35: "  ' m1s57b  ' pseudo
	#Check if LED on L1 of Phone B is solid
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #Check if Phone B is Connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #Check if Phone B is not ringing anymore
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    #Check if Phone A is connected
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #Check if Phone A doesn't have a Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    expectMsgWait "44: "
	#Check if Phone A displays Phone B's number while the call is ON
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#press goodbye on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"48: "  ' m1s57b  ' pseudo
    #Check if both Phone A and Phone B are disconnected
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	#Check if LED's are OFF
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
   
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    wait 1000
	expectMsgWait
	'expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201111






#############################################################################################

'Incoming Call-Phone B calls Phone A, Hear Ringing on A
'
'pvaastra on bos-bgalasso the 02/08/2012 15:36:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201112
  LOCAL count=0
  LOCAL title="TC201112-Incoming Call-Phone B calls Phone A, Hear Ringing on A_Speaker"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Speaker on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Loudspeaker,"6: "  ' m1s57b  ' pseudo
    #Check for Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #Dial Phone A Number
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
    #Check if the number on Phone B's display is Phone A number
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing from Phone B's Speaker
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #Check if Phone A is ringing from Phone A' side
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check if the display is correct on Phone A
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 6000
	#press goodbye on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"22: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgWait "26: "
    expectMsgWait
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201112






#############################################################################################

'Incoming Call-Phone B calls Phone A, Hear Ringing on A
'
'pvaastra on bos-bgalasso the 02/08/2012 15:36:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201113
  LOCAL count=0
  LOCAL title="TC201113-Incoming Call-Phone B calls Phone A,LED Flashing on A_Speaker"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Press Speaker on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Loudspeaker,"10: "  ' m1s57b  ' pseudo
    #Check for Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	#Check if L1 LED is Solid on Phone B
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  
   	#Dial Phone A Number
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
    #Check if the number on Phone B's display is Phone A number
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing from Phone B's Speaker
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #Check if Phone A is ringing from Phone A' side
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check if the L1 LED is blinking on Phone A
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink
	#Check if the display is correct on Phone A
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 6000
	#press goodbye on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"22: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgWait "26: "
    expectMsgWait
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201113






#############################################################################################

'Incoming Call-Phone B calls A, A Picks, L1 LED on A is Solid
'
'pvaastra on bos-bgalasso the 02/08/2012 16:08:09
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201114 
  LOCAL count=0
  LOCAL title="TC201114-Incoming Call-Phone B calls A, A Picks, L1 LED on A is Solid_Speaker"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    #Press Speaker on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Loudspeaker,"6: "  ' m1s57b  ' pseudo
    #Check Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #Check if L1 LED is Solid on Phone B
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive 
	#Dial phone A number
    expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
    #Check if Phone B' displays shows Phone A's number 
    expectMsgWait "13: "
   # expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing from Phone B's Speaker
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
	#Check if Phone A is ringing from Phone A' side
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check if the L1 LED is blinking on Phone A
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink
	#Check if the display is correct on Phone A
    expectMsgWait "16: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "17: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 5000
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"20: "  ' m1s57b  ' pseudo
    #Check if LED on L1 of Phone A is solid
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57b
	#Check if Phone A is connected
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#Check if Phone A stops ringing
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    #Check if Phone B is Connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #Check if there is no Dial Tone on Phone B
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
	#Check the display of Phone B
    expectMsgWait "25: "
    wait 5000
	#press goodbye on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"28: "  ' m1s57b  ' pseudo
    #Check if Phones are not connected anymore
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    #Press Goodbye
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"37: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"38: "  ' m1s57a  ' pseudo
    wait 1000
	#Hook On both the phones
	expectMsgSend SUBB,Do.Hook,Hook.On,"39: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201114






#############################################################################################
'TC 201115-Phone A puts B on Hold
'
'pvaastra on bos-bgalasso the 02/09/2012 10:36:42
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201115
  LOCAL count=0
  LOCAL title="TC 201115-Phone A puts B on Hold"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Hook ON
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook OFF Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"3: "  ' m1s57a  ' pseudo
    #Check if Phone A is hooked Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #Check for Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Dial Phone B's number
    expectMsgSend SUBA,Do.Keys,SUBB.number,"9: "  ' m1s57a  ' pseudo
	#Check Display
    expectMsgWait "10: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing from Phone A's Handset 
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #Check Display on Phone B
	expectMsgWait "12: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "13: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    #Check if Phone B is ringing from Phone B's user side
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	wait 2000
	#Hook Off
    expectMsgSend SUBB,Do.Hook,Hook.Off,"15: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #Check if Phones are connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #Check Display on Phone A
	expectMsgWait "22: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#Press Hold on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold,"23: "  ' m1s57a  ' pseudo
    #Check if Phone A is on HOLD
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Hold  ' m1s57a
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
    #Check Phone A Display
	expectMsgWait "25: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#Press Hold on Phone A again to retrieve the call 
	#@#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold,"26: "  ' m1s57a  ' pseudo
    #Check if Phones are connected again
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #'number '^C9057604202' found in pco 'm1s57b' (9057604202) -> "^C"+SUBB.number
    #'number '9057604202^C9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number+"^C"+SUBB.number
    #Check Display on Phone A
	expectMsgWait "28: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#hook ON Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"29: "  ' m1s57b  ' pseudo
    #Check if the Phones are disconnected
	expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "37: "
    expectMsgSend SUBA,Do.Hook,Hook.On,"40: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201115






#############################################################################################

'TC 201116-Phone A is put on Hold by B
'
'pvaastra on bos-bgalasso the 02/09/2012 10:54:29
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201116
  LOCAL count=0
  LOCAL title="TC 201116-Phone A is put on Hold by B"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
  REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook Off Phone A 
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    #Chek for Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Check If Hooked OFF
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
    #Dial Phone B's number
	expectMsgSend SUBA,Do.Keys,SUBB.number,"12: "  ' m1s57a  ' pseudo
    'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
    #Check Display Of Phone A
	expectMsgWait "13: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing from Phone A handset 
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgWait "15: "
	#Check Display on Phone B
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "16: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    #Check if Phone B is ringing from Phone B user's side
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	wait 2000
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"18: "  ' m1s57b  ' pseudo
    #Cjheck if Phones are connected
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #'number '^C9057604202' found in pco 'm1s57b' (9057604202) -> "^C"+SUBB.number
    #'number '9057604202^C9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number+"^C"+SUBB.number
    expectMsgWait "25: "
    #Check Display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#Press Hold on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Hold,"26: "  ' m1s57b  ' pseudo
    #Check if Phone B is on Hold
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    wait 5000
	#Press Hold on Pjhone B Again to retrieve the call
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Hold,"28: "  ' m1s57b  ' pseudo
    #'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    #Check Display on Phone B
	expectMsgWait "30: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "31: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    #Check if Phones are Connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    wait 5000
	#Hook ON Phone B
	expectMsgSend SUBA,Do.Hook,Hook.On,"44: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"33: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201116






#############################################################################################

'TC 201117-Phone A is on DND, Phone B calls A, Directed to VM or gets BUSY tone
'
'pvaastra on bos-bgalasso the 02/09/2012 11:13:59
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201117
  LOCAL count=0
  LOCAL title="TC 201117-Phone A is on DND, Phone B calls A, Directed to VM or gets BUSY tone"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
  REPEAT  
	RECINFO "Count : "+count  
	#Hook ON
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57c  ' pseudo
    wait 1000
	#'Press Callers	
  	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"6: "  ' m1s57b  ' pseudo 
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8	
    wait 2000
	#'Press Delete
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"7: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2
    wait 2000
	
	#New Feature Press DeleteList again to erase all items
	 expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"8: "  ' m1s57b  ' pseudo
	 expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3
	
	#'Press OK	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"9: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57b
  	wait 2000
   #'Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"10: "  ' m1s57b  ' pseudo  
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
    expectMsgWait	
	wait 1000	
	#Press DND on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U10,"11: "  ' m1s57a  ' pseudo
    #Check display on Phone A  
	expectMsgWait "7: "
    checkGetStateText SUBA,Do.Name,"DND On" ' m1s57a
    #Hook Off Phone B and Phone B calls Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"12: "  ' m1s57b  ' pseudo
    #Check if Hooked Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #Check for Dial Tone
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
	expectMsgWait
	#wait 2500
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Busy  ' m1s57b
	#expectMsgWait "17: "  
	wait 500
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "18: "   
	wait 4000
	#Hook On Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"19: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b  
    expectMsgWait "23: " 
	wait 1000
	#Press DND to turn it OFF
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U10,"26: "  ' m1s57a  ' pseudo
	wait 1000  
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"28: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"29: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"30: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201117






####################################################################################################################
'TC 201118-Phone A is on MUTE,Phone A shows Mute Icon, Mute works, LED Blinks
'
'pvaastra on bos-bgalasso the 02/09/2012 11:55:27
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201118
  LOCAL count=0
  LOCAL title="TC 201118-Phone A is on MUTE,Phone A shows Mute Icon, Mute works, LED Blinks"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook OFF Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    #Check if Hooked Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #Check for Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Dial Phone B's number
    expectMsgSend SUBA,Do.Keys,SUBB.number,"12: "  ' m1s57a  ' pseudo
    #Check display on Phone A
    expectMsgWait "13: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
   
    #Check Display on Phone B
	expectMsgWait "16: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "17: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 2000
	#Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"18: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #Check if Phones are connected
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    expectMsgWait "25: "
    #Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	#Click Mute
	expectMsgSend SUBA,Do.KeyMute,Key.Click,"26: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyMute,Key.LightActiveRecall
	wait 5000
	expectMsgSend SUBA,Do.KeyMute,Key.Click,"27: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.KeyMute,Key.LightOff  ' m1s57a
    wait 5000
	#hook On Phone B to end the call
	expectMsgSend SUBB,Do.Hook,Hook.On,"28: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.On,"36: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"43: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57b  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201118






##############################################################################################

'TC201119-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C
'
'pvaastra on bos-bgalasso the 02/09/2012 14:25:03
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201119
  LOCAL count=0
  LOCAL title="TC201119-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook Off Phone B to Call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"6: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
    
    expectMsgWait "13: "
    #expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
	#Check the display of Phone A
    expectMsgWait "16: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "17: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"18: "  ' m1s57a  ' pseudo
    #Check if Phone A and Phone B are connected
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    #Check display on Phone B
	expectMsgWait "25: "
	
    wait 5000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"26: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    
    #Dial Phone C number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"29: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"30: "  ' m1s57a  ' pseudo
	#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    
    #Check Phone A's display  
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a  
    #expectMsgWait "32: "
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"4165142532"+JOCKER  ' m1s57a
    #wait 1000
	#expectMsgWait "31: "
	#Press Xfer to finish Blind Xfer
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"33: "  ' m1s57a  ' pseudo
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number    
	#Check display on Phone A
	#expectMsgWait "34: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "35: "
	wait 2000
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	#Check if Phone A is not connected anymore
	#PLATFORM==1,2,4
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	#ENDPLATFORM
	
	#PLATFORM==3
#	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#ENDPLATFORM
	
	#expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #Check If Phone C is ringing
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
	#Check display on Phone C
	expectMsgWait "39: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "40: " 
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    expectMsgWait "41: "
	#Check display on Phone A
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	#Hook Off Phone C
    expectMsgSend SUBC,Do.Hook,Hook.Off,"45: "  ' m1s57c  ' pseudo
    #Check if Phone C and Phone B is connected
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgSend SUBA,Do.Hook,Hook.On,"50: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait "57: "    	
    wait 5000
	#Finish the call between B and C
	expectMsgSend SUBB,Do.Hook,Hook.On,"53: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
  
    expectMsgSend SUBC,Do.Hook,Hook.On,"64: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201119







##############################################################################################################################
'TC201120-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C
'
'pvaastra on bos-bgalasso the 02/09/2012 15:31:17
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201120
  LOCAL count=0
  LOCAL title="TC201120-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
    #Press Good bye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
    
    expectMsgWait "14: "
    expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "17: "
	#Check display On Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "18: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	#Check if A and B are connected
	expectMsgSend SUBA,Do.Hook,Hook.Off,"19: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b    
    expectMsgWait "26: "   
    wait 5000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"27: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgWait 
	wait 1000
	expectMsgSend SUBA,Do.Keys,SUBC.number,"30: "  ' m1s57a  ' pseudo
    #expectMsgWait
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgWait "32: "
    #Check Phone A display
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    expectMsgWait "33: "
	wait 1000
	#Press Dial
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"34: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
	#Check Phone C's display
    # expectMsgWait "36: "
    # expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    # expectMsgWait "37: "
    # checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    # wait 2000
	#Press Xfer
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"38: "  ' m1s57a  ' pseudo
    #Check display on Phone C
	expectMsgWait "39: "
    #Check if Phone A is disconnected
	#PLATFORM==1,2,4
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	#ENDPLATFORM
	
	#PLATFORM==3
##	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#ENDPLATFORM
	
	#Check Phone A's display	
    expectMsgWait "46: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check display of Phone C again
	expectMsgWait "49: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "50: "
	

    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c

    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
	wait 2000
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"54: "  ' m1s57c  ' pseudo
    #Check if B and C Are connected
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgWait 
	wait 5000	
	expectMsgSend SUBB,Do.Hook,Hook.On,"59: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "69: "    
	expectMsgSend SUBC,Do.Hook,Hook.On,"72: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"75: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"76: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"77: "  ' m1s57a  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201120







##############################################################################################################################

'TC201121-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C
'
'pvaastra on bos-bgalasso the 02/09/2012 16:08:50
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201121
  LOCAL count=0
  LOCAL title="TC201121-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hoon On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
    
    expectMsgWait "15: "
    #Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check Phone A's display
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "27: "
    
    wait 5000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a
    #'number '9057604203' found in pco 'm1s57c' (9057604203) -> SUBC.number
    #Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
    expectMsgWait
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #Check display on Phone A
	#expectMsgWait "33: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    #'number '^C9057604203' found in pco 'm1s57c' (9057604203) -> "^C"+SUBC.number
    '##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "34: "
	wait 1000
	#Press dial
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"35: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    
    #Check Phone C's display
	expectMsgWait "37: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "38: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	expectMsgSend SUBC,Do.Hook,Hook.Off,"39: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait
	wait 5000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
    
    expectMsgWait "46: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 500
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a

    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "50: "
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
    wait 5000
    expectMsgSend SUBB,Do.Hook,Hook.On,"54: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    
    expectMsgWait "57: "    
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgSend SUBC,Do.Hook,Hook.On,"63: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"71: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"72: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"74: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201121






##############################################################################################################################

'TC201122-Conf-Phone A perform conf with B and C
'
'pvaastra on bos-bgalasso the 02/10/2012 13:34:50
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201122
  LOCAL count=0
  LOCAL title="TC201122-Conf-Phone A perform conf with B and C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook OFF Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    #Check if Hooked Off properly
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    
    #dIAL Phone B's number
	expectMsgSend SUBA,Do.Keys,SUBB.number,"12: "  ' m1s57a  ' pseudo
    
    expectMsgWait "13: "
    #Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    
	
	#Check Display on Phone B
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "16: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    #Check if Phone B is ringing
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgWait
	wait 2000
	
	#Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"18: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    expectMsgWait "25: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait
	wait 5000
	#Press Conf
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"26: "  ' m1s57a  ' pseudo
    
    wait 1000
	#Dial Phone C's Number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"27: "  ' m1s57a  ' pseudo
    wait 1000
	#Press Dial
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"28: "  ' m1s57a  ' pseudo
    #Check if Phone C is ringing
	expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    
   
   #Check Phone C's display
	expectMsgWait "30: "
    #@#expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "31: "
    #@#checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait
	wait 2000
	
	#Hook off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"32: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c	
    expectMsgWait
	wait 2000
	
	#Press Conf on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"37: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgWait
	wait 5000
	
	#Hook On Phone C
	expectMsgSend SUBC,Do.Hook,Hook.On,"38: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgWait "43: "
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBB,Do.Hook,Hook.On,"44: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.On,"55: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"58: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"59: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"60: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201122






#####################################################################################################

'TC201123-Blf
'
'pvaastra on bos-bgalasso the 02/10/2012 14:21:29
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201123
  LOCAL count=0
  LOCAL title="TC201123-Blf"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	REPEAT  
	RECINFO "Count : "+count  
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    wait 1000
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook Off Phone C
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
	expectMsgSend SUBC,Do.Hook,Hook.Off,"8: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    
    expectMsgSend SUBC,Do.Keys,SUBB.number,"14: "  ' m1s57c  ' pseudo
    
    expectMsgWait "15: "
    #@#expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
    
	#Check BLF LED on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"5: "  ' m1s57a  ' pseudo
	#PLATFORM==1,2,4
	expectMsgAdd SUBA,Do.KeyF12,Key.LightActiveBlink  ' m1s57a 
	#ENDPLATFORM
    #Check L1 LED on Phone C
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    #Check L1 LED on Phone B
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
        
	#Check Phone B' display
	expectMsgWait "27: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    expectMsgWait "28: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgWait
	wait 2000
	
    #Hook off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"31: "  ' m1s57b  ' pseudo
	#Check all the LED's and if phones are connected
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
  	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "54: "
    
	#Check Phone C's display
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait
	wait 5000
	
	#Press Hold on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Hold,"55: "  ' m1s57b  ' pseudo
    #Check all the LED's	
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
	#@#expectMsgAdd SUBB,Do.Connected,Connected.Hold  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgWait
	wait 5000
	
	#Press Hold agian	
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Hold,"72: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBA,Do.KeyF12,Key.LightActive  ' m1s57a  
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
	wait 5000
	
	#Hook ON Phone B
    expectMsgSend SUBB,Do.Hook,Hook.On,"85: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"85: "  ' m1s57b 
	expectMsgSend SUBA,Do.Hook,Hook.On,"85: "  ' m1s57b 
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 200
	
   #Check All the LED's
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF12,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c 
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c    
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"107: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"108: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"109: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201123







#####################################################################################################

'TC201124-Intercom-PhoneSide-Outgoing
'
'pvaastra on bos-bgalasso the 02/10/2012 15:53:09
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201124
  LOCAL count=0
  LOCAL title="TC201124-Intercom-PhoneSide-Outgoing"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#'Press goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#'Ensure Hook ON
	expectMsgSend SUBC,Do.Hook,Hook.On,"3: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
    wait 2000	
	#'Press Callers
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"6: "  ' m1s57a  ' pseudo
  	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"10: "  ' m1s57b  ' pseudo
   	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8,"14: "  ' m1s57c  ' pseudo
    wait 2000
	#'Press Delete
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"18: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"19: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"24: "  ' m1s57c  ' pseudo
    wait 2000
	
	#Press DeleteList to erase all items
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"25: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"26: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"29: "  ' m1s57c  ' pseudo
	wait 2000
	#'Press OK
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"30: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"34: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"38: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
	wait 2000
   #'Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"42: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"43: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57c  ' pseudo
    expectMsgWait	
	wait 1000	
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press Intercom on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive' m1s57a
    wait 1000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"10: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	
	#Dial Phone B Icom
	expectMsgSend SUBA,Do.Keys,SUBB.number,"13: "  ' m1s57a  ' pseudo
    #stone
	#expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "17: "
 
	#Check dispay on Phone B
    #@3expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "18: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"19: "  ' m1s57b  ' pseudo
    expectMsgWait
	wait 2000
	
	#Hook Off Phone B
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait
	wait 5000
	
	#hook on Phone B to finish Icom call	
	expectMsgSend SUBB,Do.Hook,Hook.On,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "35: "
    expectMsgSend SUBA,Do.Hook,Hook.On,"38: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"41: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"42: "  ' m1s57b  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201124






#####################################################################################################

'TC125-Intercom-PhoneSide-Incoming Icom
'
'pvaastra on bos-bgalasso the 02/10/2012 16:03:45
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 101125
  LOCAL count=0
  LOCAL title="TC101125-Intercom-PhoneSide-Incoming Icom"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
  REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff' m1s57b
    wait 1000
	
	#Press Icom on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U9,"6: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive' m1s57b
	expectMsgWait
	wait 1000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"10: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgSend SUBB,Do.Keys,"2530","13: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
    expectMsgWait "17: "
    
	#Check Display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "18: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait
	wait 2000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"19: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
	expectMsgWait
	wait 5000

	#Hook On Phone A 
	expectMsgSend SUBA,Do.Hook,Hook.On,"27: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "34: "
    expectMsgSend SUBB,Do.Hook,Hook.On,"38: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"41: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"42: "  ' m1s57b  ' pseudo
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '101125





#####################################################################################################
'TC201126-L1,L2,L3,L4 LED
'
'pvaastra on bos-bgalasso the 02/10/2012 16:14:25
'  SUBA(m1s57a)  
TESTCASE 201126
  LOCAL title="TC201126-L1,L2,L3,L4 LED"
  setFixSubNames BMode.temphard,"m1s57a"
  WHILE SETTERM(title,ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
	expectMsgWait
    wait 1000
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"1: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgWait"6:"
	wait 3000
	
	expectMsgSend SUBA,Do.KeyL2,Key.Click,"7: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff   ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff   ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive   ' m1s57a
    expectMsgWait"13:"
	wait 3000
	
	#expectMsgSend SUBA,Do.KeyL3,Key.Click,"14: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    #expectMsgAdd SUBA,Do.KeyL3,Key.LightOff  ' m1s57a
	#expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
	#expectMsgWait"20:"
	#wait 3000
	
	#expectMsgSend SUBA,Do.KeyL4,Key.Click,"21: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL3,Key.LightOff  ' m1s57a
    #expectMsgAdd SUBA,Do.KeyL4,Key.LightOff   ' m1s57a
    #expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    #expectMsgWait"27:"
	#wait 3000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"28: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "35: "

    expectMsgWait
  WEND
ENDTC '201126






#####################################################################################################
'TC201127-SPEEDDIAL
'
'pvaastra on bos-bgalasso the 02/13/2012 09:50:51
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)
TESTCASE 201127
  LOCAL count=0
  LOCAL title="TC201127-SPEEDDIAL"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press Speeddial key(U2) of Phone B on Phone A 
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"6: "  ' m1s57a  ' pseudo	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    
    expectMsgWait "12: "
    
	#Check Phone B's Display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "13: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 2000
	
	#Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"14: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a    
    expectMsgWait "21: "
    
	#Check Display of Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 5000
	
	#Hook On Phone B to finish the call
	expectMsgSend SUBB,Do.Hook,Hook.On,"22: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "30: "
    
	expectMsgSend SUBA,Do.Hook,Hook.On,"33: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"34: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"35: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"36: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201127






#####################################################################################################

'TC201128-SPEEDDIAL/XFER
'
'pvaastra on bos-bgalasso the 02/13/2012 10:01:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201128
  LOCAL count=0
  LOCAL title="TC201128-SPEEDDIAL/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    wait 1000
	#Press More
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"12: "  ' m1s57a  ' pseudo
	wait 1000	   
   #Press U3-Speeddial/xfer with Phone B's number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"13: "  ' m1s57a  ' pseudo
    
	#'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
    expectMsgWait "14: "
    #Check display on Phone A
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgWait "17: "
    
	#Check display on Phone B
	#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "18: "
    #checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 2000
	
	#Hook Off Phone B 
	expectMsgSend SUBB,Do.Hook,Hook.Off,"19: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgWait "26: "

    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 2000
	expectMsgSend SUBB,Do.Hook,Hook.On,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "35: "

    expectMsgSend SUBA,Do.Hook,Hook.On,"38: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"41: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    #'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgSend SUBC,Do.Keys,SUBA.number,"47: "  ' m1s57c  ' pseudo
    #'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgWait "48: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    #'number '9057604203' found in pco 'm1s57c' (9057604203) -> SUBC.number
    expectMsgWait "51: "
    
	#Check display on Phone A
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "52: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    wait 2000
	
	expectMsgSend SUBA,Do.Hook,Hook.Off,"53: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c   
    expectMsgWait "60: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"61: "  ' m1s57a  ' pseudo
    wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"62: "  ' m1s57a  ' pseudo
    #PLATFORM==1,2,4
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	#ENDPLATFORM
	
	#PLATFORM==3
#	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#ENDPLATFORM
    expectMsgWait "65: "
    
	#Check display on Phone A
	#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    #'number '9057604203' found in pco 'm1s57c' (9057604203) -> SUBC.number
    expectMsgWait "67: "
    #expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    expectMsgWait "68: "
    #checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	
    expectMsgSend SUBB,Do.Hook,Hook.Off,"72: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgSend SUBA,Do.Hook,Hook.On,"77: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	wait 5000
	expectMsgSend SUBB,Do.Hook,Hook.On,"80: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait "84: "
    #checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c   
    expectMsgWait "90: "
	#expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "92: "	
    expectMsgSend SUBC,Do.Hook,Hook.On,"93: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"96: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"98: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201128






#################################################################################

'TC201131-SPEEDDIAL/CONF
'
'pvaastra on bos-bgalasso the 02/13/2012 13:23:18
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 201131
  LOCAL count=0
  LOCAL title="TC201131-SPEEDDIAL/CONF"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
  	RECINFO "Count : "+count 
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    wait 1000
	
	#Hook OFF Phone A to call Phone B
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    wait 1000
	
	#Press More
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"13: "  ' m1s57a  ' pseudo
    expectMsgWait "15: "
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"13: "  ' m1s57a  ' pseudo
    expectMsgWait "15: "
	wait 1000
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"13: "  ' m1s57a  ' pseudo
    #expectMsgWait "15: "
	#wait 1000
	#Press U5- SPEEDDIAL/CONF. with Phone B's number
    expectMsgWait "15: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "23: "
  
	#Check Display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "24: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    wait 2000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b   
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a 
    expectMsgWait "46: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 2000
	
	#Hook ON Phone B	
	expectMsgSend SUBB,Do.Hook,Hook.On,"47: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgSend SUBA,Do.Hook,Hook.On,"54: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "62: "   
    expectMsgWait "64: " 
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	
	#Hook Off Phone C to call Phone A
    expectMsgSend SUBC,Do.Hook,Hook.Off,"67: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c    
    expectMsgSend SUBC,Do.Keys,SUBA.number,"74: "  ' m1s57c  ' pseudo    
    expectMsgWait "75: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "83: "
    
	#Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "84: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    wait 2000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"86: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a 
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a    
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c 
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c   
    expectMsgWait "106: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    wait 2000
	
	#Press More on Phone A	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"107: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 500
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"107: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 500
	#Press U5 to initiate Conf.
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"108: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "119: "
    
	#Check display on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "120: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    wait 2000
	
	#Hook Off PHone B	
	expectMsgSend SUBB,Do.Hook,Hook.Off,"122: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
	wait 2000
	
	#Hook on Phone B to finish the Conf.
	expectMsgSend SUBB,Do.Hook,Hook.On,"144: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a	
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgWait "152: "
	wait 4000
	
	#Hook Off Phone C
    expectMsgSend SUBC,Do.Hook,Hook.On,"153: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a   
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c   
    expectMsgWait "163: "    
    #expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "169: "
    expectMsgSend SUBA,Do.Hook,Hook.On,"172: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"175: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"176: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"177: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201131








#######################################################################################
'Phone A calls Phone B on Line 1, phone B dial phone c's number on line 2 phone C hook off, phone A drop it. 
'Edited by Weiling Chen
'pvaastra on bos-bgalasso the 25/09/2012 11:41:04
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)
TESTCASE 201135
  LOCAL count=0
  LOCAL title=" New Test Case-201135 : incoming and outgoing calls switches, Phone B call back from caller list. "
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	REPEAT  
	RECINFO "Count : "+count  
	#Hook ON
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57b  ' pseudo
    wait 1000
	#Hook OFF Phone A 
	expectMsgSend SUBA,Do.Hook,Hook.Off,"7: "  ' m1s57a  ' pseudo
    #Check for Dial Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Check if Phone A is Hooked OFF
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #Type Phone B Number
	expectMsgSend SUBA,Do.Keys,SUBB.number,"12: "  ' m1s57a  ' pseudo
    expectMsgWait "22: "
    #Check on Phone A if the number typed is of Phone B
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #Check if Phone B is ringing
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #User of Phone B is hearing a ringing tone
	#@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "27: "
	#Check if display of Phone B is showing Phone A's number
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "28: "
	#Check if display of Phone B is showing Phone A's Callerd ID name
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 3000
	
	#Phone B goes to line 2 and dial phone C
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgWait "30: "
	expectMsgSend SUBB,Do.KeyL2,Key.Click,"32: "  ' m1s57b  ' pseudo
	expectMsgWait "33: "
	wait 2000
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActive  ' m1s57b
	expectMsgSend SUBB,Do.Keys,SUBC.number,"34: "  ' m1s57b  ' pseudo
	#Check if display of Phone B is showing Phone C's number
	expectMsgWait "35: "
	wait 1000
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57b
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	expectMsgWait "36: "
	#Check phone C diaplay and light
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
	expectMsgWait "38: "
	expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
	expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
	wait 2000
	#Hook OFF Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"50: "  ' m1s57c  ' pseudo
    expectMsgWait "52: "
	wait 1000
	#expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #Check if Phone C is Hooked OFF
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgWait "54: "
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
	expectMsgWait "56: "
    wait 5000
	#phone A press goodbye
	expectMsgSend SUBA,Do.Hook,Hook.On,"55: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Hook,Hook.On,"56: "  ' m1s57a
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"55: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	expectMsgWait "59: "
	wait 3000
	#phone B hook on
	#expectMsgSend SUBB,Do.Hook,Hook.On,"61: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"61: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL2,Key.LightOff  ' m1s57b 
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b 
	expectMsgWait "63: "
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgSend SUBC,Do.Hook,Hook.On,"65: "  ' m1s57c  ' pseudo
	#phone B is calling back phone A from caller list
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"67: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"68: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"69: "  ' m1s57b  ' pseudo
	expectMsgWait "70: "
	wait 2000
	#Hook off phone A
	
	
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "73: "
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"74: "  ' m1s57a  ' pseudo
	expectMsgWait "75: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	
	expectMsgWait "77: "
	wait 2000
	#Hook on phone B 
	expectMsgSend SUBB,Do.Hook,Hook.On,"79: "  ' m1s57b  ' pseudo
	expectMsgWait "80: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"81: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"82: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"83: "  ' m1s57c  ' pseudo
	
	count=count+1 
	UNTIL count=1
	WEND
ENDTC '201135






#############################################################################################

'Verify ringing and MWI on second incoming call when first call is dropped by far end.
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/23/2012 14:27:23
' SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 201136
  LOCAL count=0
  LOCAL title="TC 201136 - Verify ringing and MWI on second incoming call when first call is dropped"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 	REPEAT  
	RECINFO "Count : "+count
	#Press GOODBYE
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgWait
	wait 500
	
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	
	#Press L1 on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 2000
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone A answers in handsfree mode
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b 
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 1000
	
	#Phone C calls Phone from L1, Verify LED flashing on L2
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"30: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	expectMsgWait
    expectMsgSend SUBC,Do.Keys,SUBA.number  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"35: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 2000
	'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
	
	#Phone A ends the 1st call from Phone B on L1, then verify LED lights again
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"42: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 200
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"44: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
	expectMsgWait
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 2000
	count=count+1
	UNTIL count=1
  WEND
ENDTC '201136





##############################################################################################################################################

'Verify ringing and MWI on second incoming call when first call is on hold and unhold status.
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/24/2012 14:27:23
' SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 201137
  LOCAL count=0
  LOCAL title="TC 201137- Verify ringing and MWI on incoming call when first call is on hold and unhold status. "
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 	REPEAT  
	RECINFO "Count : "+count  
	#Press GOODBYE
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 500
	
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
	wait 1000
	
	#Press L1 on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	'expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
	expectMsgWait
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    'expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone A answers in handsfree mode
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b 
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 1000
	
	#Phone A put the call on hold
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold,"26: "  ' m1s57a  ' pseudo
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
	'expectMsgAdd SUBA,Do.Connected,Connected.Hold  ' m1s57a
	
	#Phone C calls Phone from L1, Verify LED flashing on L2
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	expectMsgWait
    expectMsgSend SUBC,Do.Keys,SUBA.number  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57c  ' pseudo
	expectMsgWait
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
	wait 2000
	
	#Phone A unhold the 1st call from Phone B on L1, then verify LED lights again
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
	expectMsgWait
	wait 2000
	
	#Phone A press L2 to answer the call 
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"8: "  ' m1s57a  ' pseudo
	wait 1000
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	wait 2000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 2000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '201137






####################################################################################################################


################################################################################################
##202 DIRECTORY_BROADSOFT

################################################################################################


 #### Intial state of the phone :
 #### --Phine A is DUT
 #### --Phone C speeddial is set in U4  on DUT
 #### --DND is set on U5 on config xml p4 


 #### --Services is set on U11 on DUT
 #### --Directory is set on U7  on DUT
 #### --Callers List is set on U8  on DUT
 



 ## topsoftkey1 type : directory   ## 
 ## topsoftkey1 label : Directory   ## 

 ## topsoftkey2 type : callers   ## 
 ## topsoftkey2 label : Callers List    ## 

 ## topsoftkey4 type : xml   ## 
 ## topsoftkey4 label :    ## 
 ## topsoftkey4 value :     ## 


 ## topsoftkey5 type : services   ## 
 ## topsoftkey5 label : Services   ## 
 

#######################################################################

'TC 202100- Directory Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 202100
  LOCAL title="TC 202100-Directory Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait  2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait  3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=6

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait  1500
  WEND
ENDTC '202100








####################################################################################################

##################################################################

TESTCASE 202102 
  RECINFO "TC202102-Single call",RecFunc
  #Initializing variables
  LOCAL count=0

	'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c)      
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"  
		   
		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgWait
	wait 1000
			send SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgWait
	wait 1000
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send SUBD,Do.PredefKeys,PredefKeys.No
			
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		wait 1500
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
	expectMsgWait
	wait 1000
			send SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 1000
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 2000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgWait
	wait 1000
			send SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgWait
	wait 1000
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send SUBD,Do.PredefKeys,PredefKeys.No
			
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
	expectMsgWait
	wait 1000
			send SUBB,Do.Hook,Hook.On
	expectMsgWait
	wait 1000
			'send SUBC,Do.Hook,Hook.On
			
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2
	wait 1000
	ENDTC







####################################################################################################################

'TC 2021041 Delete All One-by-One
TESTCASE 2021041
LOCAL title="Testcase 2021041 Delete All One-by-One"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait "5: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"10: "
	expectMsgWait "15: "
	wait  1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"20: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"70: "
	expectMsgWait
	wait 1000
	#Delete all 200 numbers
	FOR repeated=1 TO 200
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"25: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"30: "
		expectMsgWait "35: "
	wait  1000
	NEXT

	
	#Try To Call-Should fail since Directory is empty
	expectMsgSend SUBA,Do.Hook,Hook.Off, "45: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"50: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet,"55: "
	expectMsgWait "60: "
	wait 2000
	
	#Try to delete non-existent entries - should do nothing
	FOR repeated=1 TO 3
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"65: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"70: "
		expectMsgWait "75: "
	wait  3000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Left,"80: "
	expectMsgWait
	wait 1000
	NEXT
	
	#Try To Call-Should fail since Directory is empty
	expectMsgSend SUBA,Do.Hook,Hook.Off, "85: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"90: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet,"95: "
	expectMsgWait "100: "
	wait 2000
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"105: "
	expectMsgWait "110: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"115: "
	expectMsgWait "120: "
	wait  1000

	WEND
ENDTC '2021041







####################################################################################################################

'TC 2021071 Directory Delete All
TESTCASE 2021071
LOCAL title="Testcase 2021071 Directory Delete All"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"5: "
	expectMsgWait
	wait 1000

	#Delete Directory
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"10: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"20: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"25: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"30: "
	expectMsgWait "32: "
	wait  2000
	
	#Try To Call-Should fail since Directory is empty
	#expectMsgSend SUBA,Do.Hook,Hook.Off, "35: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"40: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"45: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet,"50: "
	expectMsgWait "57: "
	wait 2000

	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"55: "
	expectMsgWait "60: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"65: "
	expectMsgWait "70: "
	wait  1000

	WEND
ENDTC '2021071







####################################################################################################################

'TC 2021131 Copy from Redial List
TESTCASE 2021131
LOCAL title="Testcase 2021131 Copy from Redial List"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"10: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"20: "
	expectMsgWait "25: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"40: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"45: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"50: "
	expectMsgWait "55: "
	wait  1000
	
	#Clear the redial list
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Redialing,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"65: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"70: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"75: "
	expectMsgWait "80: "
	wait  3000
	
	#Dial out A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"85: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,SUBA.number,"90: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"95: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"105: "
	expectMsgWait "110: "
	wait  4000
	
	#Dial out B
	expectMsgSend SUBA,Do.Hook,Hook.Off,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,SUBB.number,"120: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"125: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting,"130: "
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes,"135: "
	expectMsgSend SUBA,Do.Hook,Hook.On,"140: "
	expectMsgWait "145: "
	wait  4000
	
	#Dial out C
	expectMsgSend SUBA,Do.Hook,Hook.Off,"150: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,SUBC.number,"155: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"160: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting,"165: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes,"170: "
	expectMsgSend SUBA,Do.Hook,Hook.On,"175: "
	expectMsgWait "180: "
	wait  4000
	
	#Dial out D
	expectMsgSend SUBA,Do.Hook,Hook.Off,"185: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,SUBD.number,"190: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"195: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting,"200: "
	expectMsgAdd SUBD,Do.Ringing,Ringing.Yes,"205: "
	expectMsgSend SUBA,Do.Hook,Hook.On,"210: "
	expectMsgWait "215: "
	wait  4000
	
	#Dial out E
	expectMsgSend SUBA,Do.Hook,Hook.Off,"220: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,SUBE.number,"225: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"230: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting,"235: "
	expectMsgAdd SUBE,Do.Ringing,Ringing.Yes,"240: "
	expectMsgSend SUBA,Do.Hook,Hook.On,"245: "
	expectMsgWait "250: "
	wait  4000
	
	#Copy from Redial List twice
	FOR repeat=0 TO 1
		FOR phone=0 TO 4
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Redialing,"255: "
	expectMsgWait
	wait 1000
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"255: "
	expectMsgWait
	wait 1000
			FOR pressDown=0 TO phone-1

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
			NEXT
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"265: "
	expectMsgWait
	wait 1000
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"270: "
			expectMsgWait "272: "
	wait  3000
		NEXT
	NEXT
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"275: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"280: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"285: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"290: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"295: "
	expectMsgWait "300: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"305: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"310: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"315: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"320: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"325: "
	expectMsgWait "330: "
	wait  1000

	WEND
ENDTC '2021131







####################################################################################################################
####################################################################################################################
'TC 2021151 Semi-Attended Transfer with Directory
TESTCASE 2021151
LOCAL title="Testcase 2021151 Semi-Attended Transfer with Directory"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"10: "
	expectMsgWait "15: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"20: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"25: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"30: "
	expectMsgWait "35: "
	wait  1000
	
	#Add Cindy Christens
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222", "255: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"260: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"444663999","265: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222","280: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"285: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"447774447777833667777","290: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"295: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"300: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBC.number,"305: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"310: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"315: "  ' m1s57a  ' pseudo
	expectMsgWait "320: "
	wait  10000
	
	#B calls A and A answers
	expectMsgSend SUBB,Do.Keys,SUBA.number,"120: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"125: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive,"130: "
	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink,"135: "
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes,"140: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"145: "
	expectMsgWait "150: "
	wait  5000
	
	#A transfers to C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"155: "
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"160: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"165: "
	expectMsgWait
	wait 1000
	
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink,"170: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes,"175: "
	expectMsgWait "180: "
	wait 5000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"190: "
	expectMsgWait
	wait 1000
	
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes,"195: "
	expectMsgAdd SUBA,Do.Connected,Connected.No,"200: "
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"210: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"215: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"220: "
	expectMsgWait "225: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"230: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"235: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"240: "
	expectMsgWait "245: "
	wait  1000

	WEND
ENDTC '2021151







####################################################################################################################
'TC 2021161 Conference with Directory
TESTCASE 2021161 
LOCAL title="Testcase 2021161 Conference with Directory"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"10: "
	expectMsgWait "15: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"20: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"25: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"30: "
	expectMsgWait "35: "
	wait  1000
	
	#Add Cindy Christens
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222", "255: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"260: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"444663999","265: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222","280: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"285: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"447774447777833667777","290: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"295: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"300: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBC.number,"305: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"310: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"315: "  ' m1s57a  ' pseudo
	expectMsgWait "320: "
	wait  10000
	
	#B calls A and A answers
	expectMsgSend SUBB,Do.Keys,SUBA.number,"120: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"125: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive,"130: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink,"135: "
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes,"140: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"145: "
	expectMsgWait "150: "
	wait  3000
	
	#A Conf to C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"155: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"160: "
	expectMsgWait
	wait  1500
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink,"170: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes,"175: "
	expectMsgWait "180: "
	wait 3000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"185: "
	expectMsgWait
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"190: "
	expectMsgWait "195: "
	wait  5000
	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes,"200: "
	expectMsgAdd SUBB,Do.Connected,Connected.Yes,"205: "
	expectMsgAdd SUBC,Do.Connected,Connected.Yes,"210: "
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"215: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"220: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"225: "
	expectMsgWait "230: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"235: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"240: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"245: "
	expectMsgWait "250: "
	wait  1000

	WEND
ENDTC '2021161







######################################################################################################################################

'TC 2021171 Copy from Callers List
TESTCASE 2021171
LOCAL title="Testcase 2021171 Copy from Callers List"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"10: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"20: "
	expectMsgWait "25: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"40: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"45: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"50: "
	expectMsgWait "55: "
	wait  1000
	
	#Clear the callers list
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"65: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"70: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"75: "
	expectMsgWait "80: "
	wait  3000
	
	#Add Andy Anderson
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"35: "
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"40: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2", "45: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: " 
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"663999","55: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2","70: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"75: "
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.Keys,"6631","80: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"85: "
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.Keys,"337771","90: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.Keys,"77776661","100: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"105: "
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.Keys,"66","110: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"115: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"121: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBA.number,"125: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"130: "  ' m1s57a  ' pseudo	
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"135: "  ' m1s57b  ' pseudo
	expectMsgWait "140: "
	wait  10000
	
	#Call from B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"195: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,SUBA.number,"200: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"205: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting,"210: "
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes,"215: "
	expectMsgSend SUBB,Do.Hook,Hook.On,"220: "
	expectMsgWait "225: "
	wait  3000
	
	#Call from C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"230: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Keys,SUBA.number,"235: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"240: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting,"245: "
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes,"250: "
	expectMsgSend SUBC,Do.Hook,Hook.On,"255: "
	expectMsgWait "260: "
	wait  3000
	
	#Call from D
	expectMsgSend SUBD,Do.Hook,Hook.Off,"265: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Keys,SUBA.number,"270: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"275: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting,"280: "
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes,"285: "
	expectMsgSend SUBD,Do.Hook,Hook.On,"290: "
	expectMsgWait "295: "
	wait  3000
	
	#Call from E
	expectMsgSend SUBE,Do.Hook,Hook.Off,"300: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Keys,SUBA.number,"305: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"310: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBE,Do.InbandTone,InbandTone.Alerting,"315: "
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes,"320: "
	expectMsgSend SUBE,Do.Hook,Hook.On,"325: "
	expectMsgWait "330: "
	wait  3000
	
	#Copy from Callers List twice
	FOR repeat=0 TO 1
		FOR phone=0 TO 3
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"335: "
	expectMsgWait
	wait 1000
			FOR pressDown=0 TO phone-1

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
			NEXT
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"345: "
	expectMsgWait
	wait 1000
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"350: "
			expectMsgWait "355: "
	wait  3000
		NEXT
	NEXT
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"360: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"365: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"370: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"375: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"380: "
	expectMsgWait "385: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"390: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"395: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"400: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"405: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"410: "
	expectMsgWait "415: "
	wait  1000

	WEND
ENDTC '2021171







#####################################################################################################################
'TC 2021181 Attended Transfer with Directory
TESTCASE 2021181
LOCAL title="Testcase 2021181 Attended Transfer with Directory"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"	10: "
	expectMsgWait "15: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"20: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"25: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"30: "
	expectMsgWait "35: "
	wait  1000
	
	#Add Cindy Christens
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222", "255: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"260: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"444663999","265: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222","280: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"285: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"447774447777833667777","290: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"295: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"300: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBC.number,"305: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"310: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"315: "  ' m1s57a  ' pseudo
	expectMsgWait "320: "
	wait  10000
	
	#B calls A and A answers
	expectMsgSend SUBB,Do.Keys,SUBA.number,"120: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"125: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive,"130: "
	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink,"135: "
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes,"140: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"145: "
	expectMsgWait "150: "
	wait  5000
	
	#A transfers to C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"155: "
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"160: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"165: "
	expectMsgWait
	wait 1000
	
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink,"170: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes,"175: "
	expectMsgWait "180: "
	wait 5000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"185: "
	expectMsgWait "180-hello: "
	wait  3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"190: "
	expectMsgWait "180-hello2: "
	wait  3000
	expectMsgAdd SUBA,Do.Connected,Connected.No,"195: "
	expectMsgAdd SUBB,Do.Connected,Connected.Yes,"200: "
	expectMsgAdd SUBC,Do.Connected,Connected.Yes,"205: "
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"210: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"215: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"220: "
	expectMsgWait "225: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"230: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"235: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"240: "
	expectMsgWait "245: "
	wait  1000

	WEND
ENDTC '2021181







###########################################################

## 202 Directory_67i

###########################################################

####################################################################################################################

'TC 202121 Add 5 entries to Phone A's directory and Call C
TESTCASE 202121
LOCAL title="Testcase 202121 Add 5 entries to Phone A's directory and Call C"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	
	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"5: "
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"5: "
	expectMsgWait
	wait  1000

	#Delete Directory
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"10: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"10: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"20: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"20: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"25: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U5,"25: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"30: "
	expectMsgWait
	wait  1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait  1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"1: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"1: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait  1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"1: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"1: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait  1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"1: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"1: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait  1000
	
	
	############################# Adding directory to Phone A ########################

	#Add Andy Anderson
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"35: "
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"40: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2", "45: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: " 
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"663999","55: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2","70: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"75: "
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.Keys,"6631","80: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"85: "
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.Keys,"337771","90: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.Keys,"77776661","100: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"105: "
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.Keys,"66","110: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"115: "  ' m1s57a  ' pseudo
	expectMsgWait "116"
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"120: "  ' m1s57a  ' pseudo
	expectMsgWait "117"
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"121: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait  10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBA.number,"125: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"130: "  ' m1s57a  ' pseudo	
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"135: "  ' m1s57b  ' pseudo
	expectMsgWait "140: "
	wait  10000
	
	#Add Bruno Bartholom
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"22", "155: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"160: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"77788661","165: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"170: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"666","175: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"22","190: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"195: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"27778446665556661","200: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"205: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"6","210: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"215: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"220: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait  10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBB.number,"225: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"230: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"235: "  ' m1s57a  ' pseudo
	expectMsgWait "240: "
	wait  10000
	
	#Add Cindy Christens
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222", "255: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"260: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"444663999","265: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"222","280: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"285: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"447774447777833667777","290: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"295: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"300: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait  10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  2000
    expectMsgSend SUBA,Do.Keys,SUBC.number,"305: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"310: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"315: "  ' m1s57a  ' pseudo
	expectMsgWait "320: "
	wait  10000
	
	#Add Daniel Dacascos
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"3", "335: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"340: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.Keys,"26644433555","345: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"3","360: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"365: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"21","370: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"375: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"2221","380: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"385: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"277772226667777","390: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"395: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"400: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"400: "
	expectMsgWait
	wait  10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBD.number,"405: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"410: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"415: "  ' m1s57a  ' pseudo
	expectMsgWait "420: "
	wait  10000
	
	#Add Emile Eastwood
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"33", "435: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"440: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"644455533","445: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"33","460: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"465: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.Keys,"27777896661","470: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"475: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"6663","480: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"485: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"400: "
	expectMsgWait
	wait  10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBE.number,"490: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"495: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"500: "  ' m1s57a  ' pseudo
	expectMsgWait "505: "
	wait  10000


	#Call Cindy
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"510: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"515: "
	expectMsgWait
	wait 1000
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=2

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"525: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes,"530: "
	expectMsgWait "535: "
	wait 5000
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"540: "
	expectMsgWait "545: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"550: "
	expectMsgWait "555: "
	wait  1000

	WEND
ENDTC '202121






####################################################################################################################

'TC 202122 Directory 195 Entries Manual
TESTCASE 202122
LOCAL title="Testcase 202122 Directory 195 Entries Manual"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait "5: "
	wait 1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"10: "
	expectMsgWait "15: "
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"20: "
	wait 500
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"50: "
	wait 500

	LOCAL count=0;
	LOCAL number = "0";
	
	REPEAT
	
	
	
	number = STR(count);
	IF count < 10 THEN
		number = "0" + number
	ENDIF
	IF count < 100 THEN
		number = "0" + number
	ENDIF
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"25: "
	#Add Z to beginning so that these numbers come after phones A-E
	wait 500

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"9999","27: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"30: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"35: "
	expectMsgSend SUBA,Do.Keys,number,"40: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"45: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"50: "

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,number,"55: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "
	
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"65: "
	expectMsgWait "70: "
	wait 5000
	count++
	UNTIL count=195

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"75: "
	expectMsgWait "80: "
	wait 1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"85: "
	expectMsgWait "90: "
	wait 1000

	WEND
ENDTC '202122






####################################################################################################################

'TC 202123 Call Five From Directory
TESTCASE 202123
LOCAL title="Testcase 202123 Call Five From Directory"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"10: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"20: "
	expectMsgWait "25: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"40: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"45: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"50: "
	expectMsgWait "55: "
	wait  1000

	#The directory should have phones B,C,D,E at the top
	FOR entryNumber=1 TO 4
		expectMsgSend SUBA,Do.Hook,Hook.Off,"60: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"65: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"70: "
	expectMsgWait
	wait 1000
		
		FOR pressDown=0 TO entryNumber-1

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		NEXT

		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"75: "
	expectMsgWait
	wait 1000
		expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting,"85: "
		SELECT CASE entryNumber
			CASE 1
				expectMsgAdd SUBB,Do.Ringing,Ringing.Yes,"90: "
			CASE 2
				expectMsgAdd SUBC,Do.Ringing,Ringing.Yes,"95: "
			CASE 3
				expectMsgAdd SUBD,Do.Ringing,Ringing.Yes,"100: "
			CASE 4
				expectMsgAdd SUBE,Do.Ringing,Ringing.Yes,"105: "
		END SELECT
		expectMsgWait "110: "
		wait 2000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"115: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.Hook,Hook.On,"120: "
	expectMsgWait
	wait 1000
	NEXT
	
	expectMsgWait "125: "
	wait 1000
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"130: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"135: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"140: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"145: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"150: "
	expectMsgWait "155: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"160: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"165: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"170: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"175: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"180: "
	expectMsgWait "185: "
	wait  1000

	WEND
ENDTC '202123







####################################################################################################################

'TC 202124 Add/Delete Andy Anderson
TESTCASE 202124
LOCAL title="Testcase 202124 Add/Delete Andy Anderson"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait "25: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"30: "
	expectMsgWait "55: "
	wait  1000

	#Andy Anderson should be the first entry
	FOR repeated=1 TO 10
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"65: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"70: "
	expectMsgWait
	wait 1000
		#TODO: Try to add another entry - should fail
		
		#Delete Andy
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"65: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"65: "
		expectMsgWait "55: "
	wait  5000
		#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Left,"65: "

		#Add Andy Anderson
		#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"35: "
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"40: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		expectMsgSend SUBA,Do.Keys,"2", "45: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: " 
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.Keys,"663999","55: "
	expectMsgWait
	wait 1000
		

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		expectMsgSend SUBA,Do.Keys,"2","70: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"75: "
	expectMsgWait
	wait 1000
		
		expectMsgSend SUBA,Do.Keys,"6631","80: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"85: "
	expectMsgWait
	wait 1000

		expectMsgSend SUBA,Do.Keys,"337771","90: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "
	expectMsgWait
	wait 1000
		
		expectMsgSend SUBA,Do.Keys,"77776661","100: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"105: "
	expectMsgWait
	wait 1000
		
		expectMsgSend SUBA,Do.Keys,"66","110: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"115: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"70: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		expectMsgSend SUBA,Do.Keys,SUBA.number,"125: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"130: "  ' m1s57a  ' pseudo	
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"135: "  ' m1s57b  ' pseudo
		expectMsgWait "140: "
	wait  10000
	NEXT
	
	expectMsgWait "125: "
	wait 1000
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"130: "
	expectMsgWait "155: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"160: "
	expectMsgWait "185: "
	wait  1000

	WEND
ENDTC '202124







####################################################################################################################

'TC 202125 A has 5 entries and Call E
TESTCASE 202125
LOCAL title="Testcase 202125 A has 5 entries and Call E"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait "10: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"20: "
	expectMsgWait "25: "
	wait  1000

	#Call E five times
	FOR repeat=1 TO 5
		expectMsgSend SUBA,Do.Hook,Hook.Off,"30: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"35: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
		FOR pressDown=0 TO 5-1

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		NEXT
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"45: "
	expectMsgWait
	wait 1000
		expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting,"50: "
		expectMsgAdd SUBE,Do.Ringing,Ringing.Yes,"55: "
		expectMsgWait "60: "
		wait 3000
		expectMsgSend SUBA,Do.Hook,Hook.On,"65: "
	expectMsgWait
	wait 1000
	NEXT
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"70: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"75: "
	expectMsgWait "80: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"85: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"90: "
	expectMsgWait "95: "
	wait  1000

	WEND
ENDTC '202125







####################################################################################################################
'TC 202129 Edit Number
TESTCASE 202129
LOCAL title="Testcase 202129 Edit Number"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait "10: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"20: "
	expectMsgWait "25: "
	wait  1000
	
	#Add One Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"35: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2","40: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"45: "	
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"50: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,SUBA.number,"55: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"115: "
	expectMsgWait "65: "
	wait  4000
	
	#Change the Number to Phone B
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"75: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		
		FOR back=0 TO 9
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "
	expectMsgWait
	wait 1000
		NEXT
		
	expectMsgSend SUBA,Do.Keys,SUBB.number,"85: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"105: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 2000
	
	#Change the Number to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"75: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		
		FOR back=0 TO 9
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "
	expectMsgWait
	wait 1000
		NEXT
		
	expectMsgSend SUBA,Do.Keys,SUBC.number,"85: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"105: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 2000
	
	#Change the Number to Phone D
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"75: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		
		FOR back=0 TO 9
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "
	expectMsgWait
	wait 1000
		NEXT
		
	expectMsgSend SUBA,Do.Keys,SUBD.number,"85: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"105: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBD,Do.Ringing,Ringing.Yes
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 2000
	
	#Change the Number to Phone E
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"75: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
		
		FOR back=0 TO 9
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "
	expectMsgWait
	wait 1000
		NEXT
		
	expectMsgSend SUBA,Do.Keys,SUBE.number,"85: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"105: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"115: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBE,Do.Ringing,Ringing.Yes
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 2000
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"150: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"155: "
	expectMsgWait "160: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"165: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"170: "
	expectMsgWait "175: "
	wait  1000

	WEND
ENDTC '202129







############################################################################################################################
####################################################################################################################
'TC 2021301 Edit Line
TESTCASE 2021301
LOCAL title="Testcase 202130 Edit Line"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait "10: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"20: "
	expectMsgWait "25: "
	wait  1000
	
	#Add One Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"35: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2","40: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"45: "	
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,SUBB.number,"55: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5
	expectMsgWait "65: "
	wait  4000
	
	#Edit Line and call
	FOR repeat=0 TO 3
		IF repeat!= 0 THEN
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"70: "
	expectMsgWait
	wait 1000
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
		ENDIF
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"70: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"75: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
		
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=2

		IF repeat!= 0 THEN
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"85: "
	expectMsgWait
	wait 1000
		ENDIF
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"90: "
	expectMsgWait
	wait 1000
		#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Left,"95: "
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"100: "
	expectMsgWait
	wait 1000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
		expectMsgAdd SUBB,Do.Ringing,Ringing.Yes,"105: "
		IF repeat==0 THEN
			expectMsgAdd SUBA,Do.KeyL1,Key.LightActive,"110: "
		ENDIF
		IF repeat==1 THEN
			expectMsgAdd SUBA,Do.KeyL2,Key.LightActive,"115: "
		ENDIF
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"120: "
		expectMsgWait "125: "
	wait  5000
	NEXT
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"130: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"135: "
	expectMsgWait "140: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"145: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"150: "
	expectMsgWait "155: "
	wait  1000

	WEND
ENDTC '2021301







#############################################################################################################
'TC 202132 Merge Entries
TESTCASE 202132
LOCAL title="Testcase 202132 Merge Entries"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"10: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"20: "
	expectMsgWait "25: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"40: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"45: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"50: "
	expectMsgWait "55: "
	wait  1000
	
	#Add First Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"35: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2","40: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"45: "	
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,SUBB.number,"55: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5
	expectMsgWait "65: "
	wait 1000
	
	#Add Second Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=3

	expectMsgSend SUBA,Do.Keys,SUBC.number,"55: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait "65: "
	wait 1000
	
	#Add Third Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=5

	expectMsgSend SUBA,Do.Keys,SUBD.number,"55: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait "65: "
	wait 1000
	
	#Add Fourth Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"30: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"35: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=7

	expectMsgSend SUBA,Do.Keys,SUBE.number,"55: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait "65: "
	wait 1000
	
	#Dial First Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Dial Second Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Dial Third Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=2

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBD,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Dial Fourth Entry
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=3

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgAdd SUBE,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"335: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"340: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"345: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"350: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"355: "
	expectMsgWait "360: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"365: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"370: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Hook,Hook.On,"375: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBD,Do.Hook,Hook.On,"380: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBE,Do.Hook,Hook.On,"385: "
	expectMsgWait "390: "
	wait  1000
	WEND
ENDTC '202132







####################################################################################################################
'TC 2021331 Call and Edit Directory
TESTCASE 2021331
LOCAL title="Testcase 2021331 Call and Edit Directory"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
	
	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "
	expectMsgWait "10: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"15: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"20: "
	expectMsgWait "25: "
	wait  1000
	
	#Add Bruno Bartholom
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"22", "155: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"160: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"77788661","165: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"170: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"666","175: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"22","190: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"195: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"27778446665556661","200: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"205: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,"6","210: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"215: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"220: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
    expectMsgSend SUBA,Do.Keys,SUBB.number,"225: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"230: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"235: "  ' m1s57a  ' pseudo
	expectMsgWait "240: "
	wait  10000
	
	#A Calls B through Directory and Edit Name
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"130: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"135: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes,"140: "
	expectMsgWait "145: "
	wait 3000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"180: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.Connected,Connected.Yes,"185: "
	expectMsgAdd SUBB,Do.Connected,Connected.Yes,"190: "
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"150: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"155: "
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2"
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"170: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait "175: "
	wait  3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"225: "
	expectMsgWait "230: "
	wait  3000
	
	
	#A Calls B through Directory and Edit Name
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"130: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"135: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes,"140: "
	expectMsgWait "145: "
	wait 3000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"180: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.Connected,Connected.Yes,"185: "
	expectMsgAdd SUBB,Do.Connected,Connected.Yes,"190: "
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"150: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"155: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.Keys,"2"
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"170: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait "175: "
	wait  3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"225: "
	expectMsgWait "230: "
	wait  3000
	
	#Change the Number again
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"150: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"155: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#A Calls B through Directory and Edit Name
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"130: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"135: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes,"140: "
	expectMsgWait "145: "
	wait 3000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"180: "
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.Connected,Connected.Yes,"185: "
	expectMsgAdd SUBB,Do.Connected,Connected.Yes,"190: "
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"150: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"155: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait  1000
	count =count+1
	UNTIL count=2

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"170: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait "175: "
	wait  3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"225: "
	expectMsgWait "230: "
	wait  3000

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"460: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"465: "
	expectMsgWait "470: "
	wait  1000

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"475: "
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Hook,Hook.On,"480: "
	expectMsgWait "485: "
	wait  1000

	WEND
ENDTC '2021331






###########################################################

###########################################################

## 203 Redial_Broadsoft

###########################################################

 #### Intial state of the phone :
 #### --Phine A is DUT
 #### --Phone C speeddial is set in U4  on DUT
 #### --DND is set on U5 on config xml p2 


 #### --Services is set on U11 on DUT
 #### --Directory is set on U7  on DUT
 #### --Callers List is set on U8  on DUT
 



 ## topsoftkey1 type : directory   ## 
 ## topsoftkey1 label : Directory   ## 

 ## topsoftkey2 type : callers   ## 
 ## topsoftkey2 label : Callers List    ## 

 ## topsoftkey4 type : xml   ## 
 ## topsoftkey4 label :    ## 
 ## topsoftkey4 value :     ## 


 ## topsoftkey5 type : services   ## 
 ## topsoftkey5 label : Services   ## 

#######################################################################

'TC 203100- Redial Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 203100
  LOCAL title="TC203100-Redial Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 500
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=7

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 1000
  WEND
ENDTC '203100







####################################################################################################

TESTCASE 203102 
  RECINFO "Testcase 203102 Single call",RecFunc
  #Initializing variables
  LOCAL count=0
	  

		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		#Configuring Phones from XML file
		'	send SUBA,Do.PredefKeys,PredefKeys.U11
		'	send SUBB,Do.PredefKeys,PredefKeys.U11
		'	send SUBC,Do.PredefKeys,PredefKeys.U11

			wait 400			
		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On			
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		wait 500
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			wait 5000
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 500
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 500
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2
	wait 500
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
	
ENDTC






###########################################################

TESTCASE 203103  
  RECINFO "Testcase 203103 Redial list 2",RecFunc
	#Initializing variables
	LOCAL count=0
  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On					
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			send SUBC,Do.PredefKeys,PredefKeys.U5	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
			send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No

	#################################################
	#Phone A call 6 times 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		#Change phone to each increment
		IF (count=0) OR (count=2) OR (count=4 ) THEN
	
		wait 500
			#Phone A call the phone X
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone X ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 500
			#Phone X answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a 
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No

			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				  
		ENDIF

		IF (count=1) OR (count=3) OR (count=5)THEN

		 
		wait 500
			#Phone A call the phone X
			send SUBA,Do.Keys,SUBC.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone X ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 500
			#Phone X answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
	
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
		  
		ENDIF
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
	wait 500
	
	#################################################
	#Redial the last call
		wait 1000
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBA,Do.PredefKeys,PredefKeys.Right
		wait 500
			#Phone A call the last phone 
			send SUBA,Do.Hook,Hook.Off
			#Check the phone D ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 500
			#Phone C answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################
	#Verify the redial number
	#Initializing variables
	count=0
		wait 1000
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBA,Do.PredefKeys,PredefKeys.Right
	#Call directly from directory
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
		wait 500
			send SUBA,Do.PredefKeys,PredefKeys.Right
	wait 1000
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
	
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################

TESTCASE 203104 
  RECINFO "Testcase 203104  Redial list 3",RecFunc
	#Initializing variables
	LOCAL count=0
	 	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

		
			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On	
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End 
			#send SUBC,Do.PredefKeys,PredefKeys.No

	#################################################
	#Put 1 number in the redial list 
		wait 500
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 500
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
	#################################################
	#Redial the last call
		wait 1000
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBA,Do.PredefKeys,PredefKeys.Right
		wait 500
			#Phone A call the last phone with dial key 
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 500
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
	
		wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
			
ENDTC






###########################################################


TESTCASE 203105  
  RECINFO "Testcase 203105  Redial list 5",RecFunc
	#Initializing variables
	LOCAL count=0

		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No

	#################################################
	#Dial phone B 
		wait 500
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 500
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On
	#################################################
	#Redial the last call
		wait 500
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBA,Do.PredefKeys,PredefKeys.Right
		wait 500
			#Phone A call the last phone with dial key 
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On
	#################################################
	#Verify the redial number
	#Initializing variables
	count=0
		wait 1000
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBA,Do.PredefKeys,PredefKeys.Right
	#Call directly from directory
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
		wait 1000
			send SUBA,Do.PredefKeys,PredefKeys.Right
	wait 1000
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=1
			
			
		wait 1000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 203106  
  RECINFO "Testcase 203106  Redial list 7",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	
	#################################################
	#A Dial phone B 
		wait 500
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			wait 1000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
	#################################################
	#Redial the last call
		wait 1000
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
		wait 1000
			#Phone A call the last phone with dial key 
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 203107  
  RECINFO "Testcase 203107  Redial list 10",RecFunc
	#Initializing variables
	LOCAL count=0
	LOCAL time12="2611"
	LOCAL time24="2612"
	  

		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		
			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No

	#################################################
	#Phone A call 6 times 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		#Change phone to each increment
		IF (count=0) OR (count=2) OR (count=4 ) THEN
		  
		  		wait 500
			#Phone A call the phone X
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone X ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone X answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		  
		ENDIF

		IF (count=1) OR (count=3) OR (count=5)THEN
	
		  
		  		wait 500
			#Phone A call the phone X
			send SUBA,Do.Keys,SUBC.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone X ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone X answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57C
	expectMsgWait
	
	
		ENDIF



		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
	wait 500
	
	#################################################
	#Verify the time format for 12 and 24 Hour
	#################################################
	#Config Time format 12 Hour
		wait 500
			#Open the phone Settings
			send SUBA,Do.PredefKeys,PredefKeys.Settings
		wait 500
			##send SUBA,Do.Keys,time12
		send SUBA,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.Up
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
	#################################################
	#Verify time format	
		wait 1000
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
	#Initializing variables
	count=0
	#Call directly from directory
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
		wait 1000
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
	#################################################
	#Config Time format 24 Hour
		wait 1000
			#Open the phone Settings
			send SUBA,Do.PredefKeys,PredefKeys.Settings
		wait 500
			##send SUBA,Do.Keys,time12
		send SUBA,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
		wait 500
		send SUBA,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
	#################################################
	#Verify time format
		wait 1000
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
	#Initializing variables
	count=0
	#Call directly from directory
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
		wait 1000
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
	
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################


TESTCASE 203108  
  RECINFO "Testcase 203108  Redial list 14",RecFunc
	#Initializing variables
	LOCAL count=0


		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

		
			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################
	#Phone A call 6 times 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		#Change phone to each increment
		IF (count=0) OR (count=2) OR (count=4 ) THEN
		  
		  		wait 500
			#Phone A call the phone X
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone X ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone X answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		  
		ENDIF

		IF (count=1) OR (count=3) OR (count=5)THEN
	
		  
		  		wait 500
			#Phone A call the phone X
			send SUBA,Do.Keys,SUBC.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone X ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone X answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57C
	expectMsgWait
	
	
		ENDIF



		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
	wait 500
	
	#################################################			
	#Delete redial list 1 by 1
	#Initializing variables
	count=0
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			#send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 1000
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#send SUBB,Do.PredefKeys,PredefKeys.U1
			#send SUBC,Do.PredefKeys,PredefKeys.U1
	
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
	wait 500
	
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC







###########################################################
TESTCASE 203109 
  RECINFO "Testcase 203109  Redial list 17",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On			
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No

	#################################################			
	#Delete all Callers list
		wait 500
			#Callers list
			send SUBA,Do.PredefKeys,PredefKeys.U8
			send SUBB,Do.PredefKeys,PredefKeys.U8
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
		#wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
	#################################################
	#Phone B call Phone A 
	  	
		wait 500
			#Phone B call the phone A
			send SUBB,Do.Keys,SUBA.number
			send SUBB,Do.Hook,Hook.Off
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Dial from Callers list
		wait 500
			#Callers list
			send SUBA,Do.PredefKeys,PredefKeys.U8
		wait 500
			send SUBA,Do.PredefKeys,PredefKeys.Right
		wait 500
			#Phone A call the phone B
			send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBA,Do.Hook,Hook.Off
		wait 500			
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 500
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No	
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Redial the last call
		wait 500
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBA,Do.PredefKeys,PredefKeys.Right
		wait 500
			#Phone A call the last phone with dial key 
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
		wait 500	
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
	
		wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################


TESTCASE 203112 
  RECINFO "Testcase 203112  Redial list 20",RecFunc
	#Initializing variables
	LOCAL count=0
	LOCAL number="0"
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

		
			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			#send SUBC,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4	
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################			
	#Dial phone X
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count
		RECINFO "number : "+number+count	
		wait 500
			#Phone A call the phone X
			send SUBA,Do.Keys,number+count
			send SUBA,Do.Hook,Hook.Off	
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=102
	wait 1000
			
	#################################################			
	#Redial the last call
		wait 500
			#Redial Settings
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Phone A call the last phone with dial key 
			send SUBA,Do.PredefKeys,PredefKeys.Up
		
		wait 1000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 203113 
  RECINFO "Testcase 203113  Redial list 21",RecFunc
	#Initializing variables
	LOCAL count=0
	  

		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
	#################################################			
	#Phone B call phone C for put one number in the redial list
		wait 500
			#Phone B call the phone C
			expectMsgSend SUBB,Do.Keys,SUBC.number
			expectMsgSend SUBB,Do.Hook,Hook.Off
			expectMsgWait
			#Check the phone C ringing
			expectMsgAdd SUBC,Do.Ringing,Ringing.Yes
		expectMsgWait
		wait 500
			#Phone C answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Blind tranfer
		#Dial phone B from A
		wait 500
		#Dial
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Xfer
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3
		expectMsgWait
		wait 2000
			#Redial list
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Redialing
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right
		expectMsgWait
		wait 2000
			#Dial
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 1000
			#Check the phone B ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 1000
			#Xfer
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3
		wait 1000
			#Phone C answers
			waitTill SUBC,Do.Ringing,Ringing.Yes
			expectMsgSend SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		
		wait 1000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 203114  
  RECINFO "Testcase 203114  Redial list 22",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

		
			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
	#################################################			
	#Phone B call phone C for put one number in the redial list
		wait 500
			#Phone B call the phone C
			send SUBB,Do.Keys,SUBC.number
			send SUBB,Do.Hook,Hook.Off
			#Check the phone C ringing
			expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
			expectMsgWait
		wait 2000
			#Phone C answers
			expectMsgSend SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Conference
		wait 500
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
		#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgWait
		wait 1000
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3
		expectMsgWait
		wait 2000
			#Redial list
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Redialing
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right
		expectMsgWait
		wait 1000
			#Dial
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 1000
			#Check the phone C ringing
			expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
			expectMsgWait
			wait 1000
				#Phone C answers
				expectMsgSend SUBC,Do.Hook,Hook.Off
				#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		wait 1000
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3 
			#Check phones are connected
    expectMsgWait
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 1000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 203115  
  RECINFO "Testcase 203115  Redial list 23",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
			
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
	#################################################			
	#Phone B call phone A and C
		#Phone B call phone A
		wait 500
			#Phone B call the phone A
			send SUBB,Do.Keys,SUBA.number
			send SUBB,Do.Hook,Hook.Off
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 1000
			#Phone B hold the phone A
			send SUBB,Do.PredefKeys,PredefKeys.Hold
		wait 1000
			#Phone B call phone C on line 2
			send SUBB,Do.KeyL2,Key.Click	
		wait 1000
			#Phone B call the phone C
			send SUBB,Do.Keys,SUBC.number
			send SUBB,Do.Hook,Hook.Off
			#Check the phone C ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 1000
			#Phone C answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################
	#Verify the redial number
	#Initializing variables
	count=0
		wait 500
			#Redial Settings
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
		wait 500
			send SUBB,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
			wait 500
			send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
			wait 500
	wait 1000
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2	

		wait 1000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 500
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################

TESTCASE 203116  
  RECINFO "Testcase 203116  Redial list 24",RecFunc
	#Initializing variables
	LOCAL count=0
	  

		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
	#################################################			
	#Phone B call phone A and C
		#Phone B call phone A
		wait 2000
			#Phone B call the phone A
			send SUBB,Do.Keys,SUBA.number
			send SUBB,Do.Hook,Hook.Off
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No	
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		wait 2000
			#Phone B call the phone C
			send SUBB,Do.Keys,SUBC.number
			send SUBB,Do.Hook,Hook.Off
			#Check the phone C ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone C answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		wait 3000
			#Phone B hold the phone A
			send SUBB,Do.PredefKeys,PredefKeys.Hold
		wait 3000
			#Redial Settings
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Right
		wait 2000
			#Dial
			send SUBB,Do.PredefKeys,PredefKeys.U1
		#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
			
		wait 5000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
				wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On			
	#################################################
	#Verify the redial number
	#Initializing variables
	count=0
		wait 3000
			#Redial Settings
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Right
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
	wait 500
			send SUBB,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
			wait 500
			send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
			wait 500
	wait 2000
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2	

		wait 7000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC







####################################################

TESTCASE 203121 
  RECINFO "203121 Redail list after conference by lines 7242",RecFunc
	#Initializing variables
	LOCAL count=0
	  

		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End

	#################################################			
#Conference
	#Dial phone A from B
		wait 3000
		#Dial
			send SUBB,Do.Keys,SUBA.number
			send SUBB,Do.PredefKeys,PredefKeys.U1
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 5000

		wait 3000
			#B calls C
			send SUBB,Do.KeyL2,Key.Click
		wait 2000
			send SUBB,Do.Keys,SUBC.number
	wait 3000
			#Check the phone C ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes

		wait 5000
			#Phone C answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait

		wait 2000
			#conf
			send SUBB,Do.PredefKeys,PredefKeys.U2
			
		wait 2000 
			send SUBB,Do.KeyL1,Key.Click
			
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgWait
		
		wait 7000	
			#Initial state of phones
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
			expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			expectMsgSend SUBA,Do.Hook,Hook.On
			expectMsgSend SUBB,Do.Hook,Hook.On
			expectMsgSend SUBC,Do.Hook,Hook.On				
			
	#################################################			
	#Phone B call phone A and C from the redial list
		wait 2000
			#Phone B call the phone C
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Redialing
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
			wait 3000
			expectMsgSend SUBB,Do.Hook,Hook.Off 
			expectMsgWait
			wait 1000
			#Check the phone C ringing
			expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
			expectMsgWait
		wait 2000
			#Phone C answers
			expectMsgSend SUBC,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgWait
		wait 3000
			#Initial state of phones
			expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No	
			wait 2000
			#### Hooking on ####
			expectMsgSend SUBA,Do.Hook,Hook.On
			expectMsgSend SUBB,Do.Hook,Hook.On
			expectMsgSend SUBC,Do.Hook,Hook.On	
			
			wait 7000
			#Phone B call the phone A
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Redialing
			expectMsgWait
			'wait 4000
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right 'Added Sep29 - Hong Dao
			expectMsgWait
			wait 3000
	count=0
	REPEAT
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=2

			expectMsgSend SUBB,Do.Hook,Hook.Off
			expectMsgWait 
			wait 1000
			#Check the phone A ringing
			expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
		wait 2000
			#Phone A answers
			expectMsgSend SUBA,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgWait

		wait 7000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.No
			wait 2000
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
			
ENDTC






####################################################

TESTCASE 203123 
  RECINFO "203123 Redail outgoing call canceled 7414 B",RecFunc
	#Initializing variables
	LOCAL count=0
 
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBBC(m1s57c) 
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all redial list
		wait 500
			#Redial list
			send SUBA,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U5
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End

	#################################################			

	#Dial phone A from B
		wait 3000
		#Dial
			send SUBB,Do.Keys,SUBA.number
			send SUBB,Do.PredefKeys,PredefKeys.U1
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.KeyL1,Key.Click
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	expectMsgWait

		wait 7000	
			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBA,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
				wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On			
			
	#################################################			
	#Phone B call phone A and C from the redial list

			wait 5000
			#Phone B call the phone A
			send SUBB,Do.PredefKeys,PredefKeys.Redialing
			send SUBB,Do.PredefKeys,PredefKeys.Right
			wait 3000
			send SUBB,Do.Hook,Hook.Off
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	expectMsgWait
			

		wait 7000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
			
ENDTC






#######################################################################

TESTCASE 204
  LOCAL title="204- Phone Default Coniguration "
  LOCAL count=0
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)  

     expectMsgWait
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo		
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgWait
	wait 2000	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    #expectMsgSend SUBF,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo	
	expectMsgWait
	wait 3000	
    
	# REPEAT
	

	# expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	# expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	# expectMsgWait
	# wait 1000
	# count = count+1	
	
	# UNTIL count = 29
	
	# expectMsgWait
	# wait 1000

	#stone
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"7: "  ' m1s57c  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Up,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Up,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Up,"9: "  ' m1s57e  ' pseudo	
    expectMsgWait    
    	wait 1000		
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
	### Clear Missed Calls ###
	#'Press Callers
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"6: "  ' m1s57a  ' pseudo
  	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"10: "  ' m1s57b  ' pseudo
   	#expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8,"14: "  ' m1s57c  ' pseudo
	#expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U8,"14: "  ' m1s57c  ' pseudo
	#expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U8,"14: "  ' m1s57c  ' pseudo
    #expectMsgWait
	#wait 2000

    #'Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"42: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"43: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57c  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"44: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 2000
  WEND
ENDTC '204







###########################################################

## 204 Callers_Broadsoft 

###########################################################

 #### Intial state of the phone :
 #### --Phine A is DUT
 #### --BLF is set on U11 on DUT
 #### --Services is set on U7 and U1 on DUT
 #### --Directory is set on U8 and U2 on DUT
 #### --Callers List is set on U9 and U3 on DUT
 #### --Phone C speeddial is set in U4  on DUT
 #### --Pnone C speeddial/conference is set as U5 on DUT
 

 ## topsoftkey1 type : services   ## 
 ## topsoftkey1 label : Services   ## 

 ## topsoftkey2 type : directory   ## 
 ## topsoftkey2 label : Directory   ## 

 ## topsoftkey3 type : callers   ## 
 ## topsoftkey3 label : Callers List    ## 

 ## topsoftkey4 type : xml   ## 
 ## topsoftkey4 label : 2   ## 
 ## topsoftkey4 value : http://10.30.104.80:80/xml/p2.xml   ## 

 ## topsoftkey5 type : list   ## 
 ## topsoftkey5 label : BLF C   ## 


 ## softkey1 type : services   ## 
 ## softkey1 label : Services   ## 

 ## softkey2 type : directory   ## 
 ## softkey2 label : Directory   ## 

 ## softkey3 type : callers   ## 
 ## softkey3 label : Callers List    ## 

 ## softkey4 type : speeddial   ## 
 ## softkey4 label : SPD C   ## 
 ## softkey4 value : 4165551037 (SUBC.Number)   ## 

 ## softkey5 type : speeddialconf   ## 
 ## softkey5 label : SPD/CONF C   ## 
 ## softkey5 value : 4165551037  (SUBC.Number)  ## 
#######################################################################

'TC 204100- Callers Configuration 
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 204100
  LOCAL title="TC204100-Callers Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=8

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
  WEND
ENDTC '204100







####################################################################################################


###########################################################

TESTCASE 204102 
  RECINFO "Testcase 204102 Single call",RecFunc
  #Initializing variables
  LOCAL count=0
    
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		  
		#Configuring Phones from XML file , p1.XML
			'send SUBA,Do.PredefKeys,PredefKeys.U10
			'send SUBB,Do.PredefKeys,PredefKeys.U10
			'send SUBC,Do.PredefKeys,PredefKeys.U10
			
		wait 2000
		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 2000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=1

	wait 2000
			#Phone B call the phone C
			send SUBB,Do.Keys,SUBC.number
			send SUBB,Do.Hook,Hook.Off
			#Check the phone C ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone C answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBC,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 2000
			#Initial state of phones
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
			
		wait 2000
			#Phone C call the phone A
			send SUBC,Do.Keys,SUBA.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone C ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBC,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 2000
			#Initial state of phones
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBA,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
			
ENDTC





###########################################################
TESTCASE 204103   
  RECINFO "Testcase 204103 Callers list 2",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
	#################################################			
#Delete all Callers list
		wait 500
			#Callers list
			send SUBA,Do.PredefKeys,PredefKeys.U9
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
		#wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End

	#################################################			
	#Dial 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count	  	
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		wait 3000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBC,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=3
	wait 2000

	#################################################
	#Verify the redial number
	#Initializing variables
	count=0
		wait 3000
			#Callers Settings
			send SUBB,Do.PredefKeys,PredefKeys.U9
	REPEAT
		#Shows the Counter 
		RECINFO "Verify number : "+count	
		wait 500
			#Details
			send SUBB,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
			wait 500
			send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
			wait 500
			expectMsgWait
			wait 500
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
	
		wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
ENDTC






###########################################################
TESTCASE 204104  
  RECINFO "Testcase 204104  Callers list 3",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		  

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Delete all Callers list
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Delete
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 3000
			#Delete all
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Ok
			#send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U5
		wait 2000	
			#Initial state of phones
			#send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.End

	#################################################
	#Put 1 number in the redial list 
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
	#################################################
	#Redial from callers list Hook on
		wait 3000
			#Callers Settings
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Phone B call the last phone with dial key
			send SUBB,Do.PredefKeys,PredefKeys.Right	
			send SUBB,Do.PredefKeys,PredefKeys.F1
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 3000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 5000	
			#Initial state of phones
			
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################
	#Redial from callers list Hook off
		wait 3000
			send SUBB,Do.Hook,Hook.Off
		wait 3000	
			#Callers Settings
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Phone B call the last phone with dial key 
			send SUBB,Do.PredefKeys,PredefKeys.Right
			send SUBB,Do.PredefKeys,PredefKeys.Yes
			#Check the phone A ringing
			waitTill SUBA,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone A answers
			send SUBA,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
			
		wait 5000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC







###########################################################

TESTCASE 204105  
  RECINFO "Testcase 204105  Callers list 12",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
#Delete all Callers list
		wait 500
			#Callers list
			send SUBA,Do.PredefKeys,PredefKeys.U9
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
		#wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
	#################################################			
	#phones A and C call B 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count	  	
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		wait 3000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=1
	wait 2000

	#################################################
	#Verify the redial number
	#Initializing variables
	count=0
		wait 3000
			#Callers Settings
			send SUBB,Do.PredefKeys,PredefKeys.U9
	REPEAT
		#Shows the Counter 
		RECINFO "Verify number : "+count	
		wait 500
			#Details
			send SUBB,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
			wait 500
			send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
			wait 500
			expectMsgWait
			wait 500
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2
	
		wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################

TESTCASE 204107  
  RECINFO "Testcase 204107  Callers list 8",RecFunc
	#Initializing variables
	LOCAL count=0
	
	# time12/time24 are for 57i ,for 55i use time12=2611/time24=2612
	LOCAL time12="2711"
	LOCAL time24="2712"
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		  

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
	#Delete all Callers list
		wait 500
			#Callers list
			send SUBA,Do.PredefKeys,PredefKeys.U9
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 500
			#Delete
			send SUBA,Do.PredefKeys,PredefKeys.U2
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 500
			#Delete all
			send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
		wait 500
			#Ok
			send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U4
		#wait 500	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.End
			send SUBB,Do.PredefKeys,PredefKeys.End
	#################################################
	#Phones A and C call B 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count	  	
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 3000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=1
	wait 2000
	
	#################################################
	#Verify the time format for 12 and 24 Hour
	#################################################
	#Config Time format 12 Hour
		wait 500
			#Open the phone Settings
			send SUBB,Do.PredefKeys,PredefKeys.Settings
		wait 500
			##send SUBB,Do.Keys,time12
		send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.Up
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No
	#################################################
	#Verify time format	
		wait 3000
			#Callers Settings
			send SUBB,Do.PredefKeys,PredefKeys.U9
	#Initializing variables
	count=0
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
		wait 2000
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2
		wait 3000
			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No
	#################################################
	#Config Time format 24 Hour
		wait 1000
			#Open the phone Settings
			send SUBB,Do.PredefKeys,PredefKeys.Settings
		wait 500
			##send SUBB,Do.Keys,time12
		send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.Right
			expectMsgWait
		wait 500
		send SUBB,Do.PredefKeys,PredefKeys.U1
			expectMsgWait
		wait 1000
			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No
	#################################################
	#Verify time format
		wait 5000
			#Callers Settings
			send SUBB,Do.PredefKeys,PredefKeys.U9
	#Initializing variables
	count=0
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
		wait 2000
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2
	
		wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 204108  
  RECINFO "Testcase 204108  Callers list 14  Delete Callers list 1 by 1",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Delete all Callers list
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
			#send SUBC,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Delete
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4
		wait 3000
			#Delete all
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Ok
			#send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			#Initial state of phones
			#send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################
	#Phones A and C call B 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count	  	
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		wait 3000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=1
	wait 2000
			
	#################################################			
	#Delete Callers list 1 by 1
	#Initializing variables
	count=0
		wait 2000
			#Callers list
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 1000
			#send SUBB,Do.PredefKeys,PredefKeys.Down
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		wait 2000
			#Delete
			expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2
		expectMsgWait
		wait 3000
			#Delete
			#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=4
	wait 2000
			wait 2000
			#OK
			#send SUBB,Do.PredefKeys,PredefKeys.U1
		#wait 2000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 204111
  RECINFO "Testcase 204111  Callers list 19",RecFunc
	#Initializing variables
	LOCAL count=0
	LOCAL time12="2711"
	LOCAL time24="2712"
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		  

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		#################################################			
		#Delete all Callers list
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
			#send SUBC,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Delete
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4
		wait 3000
			#Delete all
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Ok
			#send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			#Initial state of phones
			#send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################			
	#Dial to phone B
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count	  	
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		wait 3000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 3000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBC,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=1
	wait 2000
			
	#################################################			
	#Check Callers list
		wait 2000
			#Callers list
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 1000	
			#Phone B check the last phone callers
			send SUBB,Do.PredefKeys,PredefKeys.Up

		wait 2000
			#Details
			send SUBB,Do.PredefKeys,PredefKeys.Right
		wait 5000

			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No	

		wait 7000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			#send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################


TESTCASE 204112  
  RECINFO "Testcase 204112  Callers list 21",RecFunc
	#Initializing variables
	LOCAL count=0
	LOCAL number="0"

	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			
	#################################################			
	#Delete all Callers list
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
			#send SUBC,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Delete
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4
		wait 3000
			#Delete all
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Ok
			#send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			#Initial state of phones
			#send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################			
	#Dial phone B
	wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		wait 2000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.PredefKeys,PredefKeys.U1
			#Check phones are connected
			waitTill SUBC,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On			
	#################################################			
	#Check Callers list
		wait 2000
			#Callers list
			send SUBB,Do.PredefKeys,PredefKeys.U9
		expectMsgWait
		wait 1000
			send SUBB,Do.PredefKeys,PredefKeys.Right
		expectMsgWait
		wait 5000
			send SUBB,Do.PredefKeys,PredefKeys.Left
		expectMsgWait
		wait 5000
			#Phone B check the second phone callers
			send SUBB,Do.PredefKeys,PredefKeys.Right
		expectMsgWait
		wait 3000
			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No	
		expectMsgWait
		wait 5000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 204113  
  RECINFO "Testcase 204113  xfer from Callers",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Delete all Callers list
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
			#send SUBC,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Delete
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4
		wait 3000
			#Delete all
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			#send SUBB,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Ok
			#send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			#Initial state of phones
			#send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################			
	#Phone C call phone B for put one number in the Callers list
		wait 2000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBC,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Blind tranfer
		wait 3000
			#Phone A call B
			send SUBA,Do.Keys,SUBB.number
			#Dial
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 5000
			#Xfer
			send SUBB,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Redial list
			send SUBB,Do.PredefKeys,PredefKeys.U9
			send SUBB,Do.PredefKeys,PredefKeys.Right
		wait 1000
			#send SUBB,Do.PredefKeys,PredefKeys.Down
		wait 2000
			#Dial
			send SUBB,Do.PredefKeys,PredefKeys.Yes
			#Check the phone C ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 2000
			#Xfer
			send SUBB,Do.PredefKeys,PredefKeys.U3
		wait 5000
			#Phone C answers
			waitTill SUBC,Do.Ringing,Ringing.Yes
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBC,Do.Connected,Connected.Yes
		
		wait 5000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC






###########################################################
TESTCASE 204114  
  RECINFO "Testcase 204114  conf from Callers",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		  

			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Delete all Callers list
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
			#send SUBC,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Delete
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4
		wait 3000
			#Delete all
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Ok
			#send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			#Initial state of phones
			#send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################			
	#Phone C call phone B for put one number in the Callers list
		wait 2000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBC,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Conference
		wait 1000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
		#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 5000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
		wait 2000
			#Conf
			send SUBB,Do.PredefKeys,PredefKeys.U2
		wait 3000
			#Callers list
			send SUBB,Do.PredefKeys,PredefKeys.U9
		wait 3000
			send SUBB,Do.PredefKeys,PredefKeys.Right
		#wait 3000
			#Dial
			send SUBB,Do.PredefKeys,PredefKeys.Yes    ' DEFECT -> had to re-use this command
			wait 1000
			#send SUBB,Do.PredefKeys,PredefKeys.U1
			#wait 1000
			#Check the phone C ringing
			waitTill SUBC,Do.Ringing,Ringing.Yes
		wait 5000
			#Phone C answers
			send SUBC,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBC,Do.Connected,Connected.Yes
		wait 5000
			#Conf
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#Check phones are connected
			waitTill SUBA,Do.Connected,Connected.Yes
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBC,Do.Connected,Connected.Yes
		
		wait 7000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On	
ENDTC





###########################################################
TESTCASE 204115  
  RECINFO "TESTCASE 204115  Callers list 22 Sort",RecFunc
	#Initializing variables
	LOCAL count=0
	  
		'  SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
		  
			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#################################################			
	#Delete all Callers list
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
			#send SUBC,Do.PredefKeys,PredefKeys.U9
		wait 2000
			#Delete
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			send SUBB,Do.PredefKeys,PredefKeys.U2
			#send SUBC,Do.PredefKeys,PredefKeys.U4
		wait 3000
			#Delete all
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U3
			#send SUBC,Do.PredefKeys,PredefKeys.U3
		wait 3000
			#Ok
			#send SUBA,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U4
			#send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			#Initial state of phones
			#send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.End
			#send SUBC,Do.PredefKeys,PredefKeys.No
	#################################################
	#Phones A and C call B 
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count	  	
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
			waitTill SUBB,Do.Connected,Connected.Yes
			waitTill SUBA,Do.Connected,Connected.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
		wait 3000
			#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
			send SUBC,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=3
	wait 7000

	#################################################			
	#Sort
		wait 2000
			#Callers list
			#send SUBA,Do.PredefKeys,PredefKeys.U3
			send SUBB,Do.PredefKeys,PredefKeys.U9
			#send SUBC,Do.PredefKeys,PredefKeys.U9
		wait 3000
			#Sort
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			##send SUBB,Do.PredefKeys,PredefKeys.U4  
			#send SUBC,Do.PredefKeys,PredefKeys.U4
	'	wait 3000
			#send SUBA,Do.PredefKeys,PredefKeys.U4
			##'send SUBB,Do.PredefKeys,PredefKeys.U3      ' DEFECT -> had to re-use this command
			#send SUBC,Do.PredefKeys,PredefKeys.U4

	#################################################
	#Verify Sort
		wait 1000

	#Initializing variables
	count=0
	REPEAT
		#Shows the Counter
		RECINFO "Count : "+count	
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=6
		
		wait 3000	
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send suD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				

ENDTC






###############################################################################################
#206 Xfer_Broadsoft

################################################################################################
#######################################################################

'TC 206100- Xfer Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 206100
  LOCAL title="TC206100-Xfer Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=10

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 1000
  WEND
ENDTC '206100







####################################################################################################

'B CALLS A, A XFERS B TO C
'
'pvaastra on bos-bgalasso the 02/14/2012 14:27:23
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206101 
  LOCAL count=0
  LOCAL title="TC206101-B CALLS A, A XFERS B TO C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 	REPEAT  
	RECINFO "Count : "+count  
	#Press GOODBYE
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No  ' m1s57d  ' pseudo
    expectMsgWait
	wait 500
	
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On  ' m1s57d  ' pseudo
	expectMsgWait
	wait 500
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off  ' m1s57b  ' pseudo
	expectMsgWait
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo  
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1 	
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#waitTill SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a	
	RECINFO "1:" 
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off  ' m1s57a  ' pseudo
	expectMsgWait
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #waitTill SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b 
	RECINFO	"2:"
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    wait 1000
	
	#Press XFER
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000	
	#@#waitTill SUBA,Do.Connected,Connected.Yes    ' m1s57a
	'waitTill SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	
	#Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number  ' m1s57a  ' pseudo
    expectMsgWait
	wait 2000
	#@#waitTill SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a	
	RECINFO"3:"
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a    
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"4165142532"+JOCKER  ' m1s57a
    expectMsgWait
	wait 1000
	
	#Press xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	RECINFO "4:"' pseudo 
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    waitTill SUBA,Do.Connected,Connected.No  ' m1s57a
    #waitTill SUBA,Do.InbandTone,InbandTone.Disconnect 
	RECINFO "5:" ' m1s57a    
    #expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    waitTill SUBC,Do.Ringing,Ringing.Yes  ' m1s57c 
    #waitTill SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
   
	#hook off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off  ' m1s57c  ' pseudo
	expectMsgWait
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	wait 1000
	
	#HOOK ON PHONE C
    expectMsgSend SUBC,Do.Hook,Hook.On  ' m1s57c  ' pseudo
	expectMsgWait
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #waitTill SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #waitTill SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b    
    expectMsgSend SUBA,Do.Hook,Hook.On  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
	expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206101







##############################################################################################

'TC206102-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C
'
'pvaastra on bos-bgalasso the 02/09/2012 14:25:03
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206102
  LOCAL count=0
  LOCAL title="TC206102-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 500
	#Hook Off Phone B to Call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"6: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "13: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	
	#Check the display of Phone A
    expectMsgWait "16: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "17: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 500
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"18: "  ' m1s57a  ' pseudo
    #Check if Phone A and Phone B are connected
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    #Check display on Phone B
	expectMsgWait "25: "
	#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"26: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive' m1s57b
	expectMsgWait
    
    #Dial Phone C number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"29: "  ' m1s57a  ' pseudo
    expectMsgWait
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgWait "31: "
    #Check Phone A's display  
    #@#heckGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    #'number '^C9057604203' found in pco 'm1s57c' (9057604203) -> "^C"+SUBC.number
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
	
	expectMsgWait "32: "
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgWait
	wait 1000
	#Press Xfer to finish Blind Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"33: "  ' m1s57a  ' pseudo
    
	#Check display on Phone A
	expectMsgWait "34: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "35: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	#Check if Phone A is not connected anymore
	wait 500
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #Check If Phone C is ringing
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
	#Check display on Phone C
	expectMsgWait "39: "
   #expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
    expectMsgWait "40: "
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #expectMsgWait "41: "
	#Check display on Phone A
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	#Hook Off Phone C
    expectMsgSend SUBC,Do.Hook,Hook.Off,"45: "  ' m1s57c  ' pseudo
    #Check if Phone C and Phone B is connected
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgSend SUBA,Do.Hook,Hook.On,"50: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait "57: "    	
    wait 2000
	#Finish the call between B and C
	expectMsgSend SUBB,Do.Hook,Hook.On,"53: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	#expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
  
    expectMsgSend SUBC,Do.Hook,Hook.On,"64: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #expectMsgWait
	count=count+1 
	UNTIL count=1
   WEND
	
ENDTC '206102






##############################################################################################################################
'TC2061031-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C
'
'pvaastra on bos-bgalasso the 02/09/2012 15:31:17
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 2061031
  LOCAL count=0
  LOCAL title="TC206103-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
    #Press Good bye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "14: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
    expectMsgWait "17: "
	#Check display On Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "18: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	#Check if A and B are connected
	expectMsgSend SUBA,Do.Hook,Hook.Off,"19: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "26: "
    #expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"27: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 1000
	expectMsgSend SUBA,Do.Keys,SUBC.number,"30: "  ' m1s57a  ' pseudo
    expectMsgWait
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#expectMsgWait "32: "
    #Check Phone A display
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "33: "
	wait 1000
	#Press Dial
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"34: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
	#Check Phone C's display
    expectMsgWait "36: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"38: "  ' m1s57a  ' pseudo
    
    #Check display on Phone C
	expectMsgWait "39: "
	wait 500
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    # ##expectTextCheck SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "40: "
    #checkGetStateText SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    #Check if Phone A is disconnected
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
	#Check Phone A's display	
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check display of Phone C again
	expectMsgWait "49: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "50: "
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
	wait 2000
   #Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"54: "  ' m1s57c  ' pseudo
    #Check if B and C Are connected
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgWait 
	wait 2000	
	expectMsgSend SUBB,Do.Hook,Hook.On,"59: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "69: "    
	expectMsgSend SUBC,Do.Hook,Hook.On,"72: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"75: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"76: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"77: "  ' m1s57a  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '2061031






##############################################################################################################################

'TC206104-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C
'
'pvaastra on bos-bgalasso the 02/09/2012 16:08:50
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206104
  LOCAL count=0
  LOCAL title="TC206104-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hoon On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "15: "
    #Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
	#Check Phone A's display
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "27: "
    # expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    
    #Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
    expectMsgWait "34: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    #Check display on Phone A
	#expectMsgWait "33: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
	expectMsgWait
	wait 1000
	
	#Press dial
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"35: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check Phone C's display
	expectMsgWait "37: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "38: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	expectMsgSend SUBC,Do.Hook,Hook.Off,"39: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "40: "
    wait 4000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
    
    expectMsgWait "46: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "47: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    ##expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "50: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
    wait 2000
    expectMsgSend SUBB,Do.Hook,Hook.On,"54: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    
    expectMsgWait "57: "    
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ##expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgSend SUBC,Do.Hook,Hook.On,"63: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"71: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"72: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"74: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206104






#####################################################################################################

'TC2061051-SPEEDDIAL/XFER
'
'pvaastra on bos-bgalasso the 02/13/2012 10:01:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 2061051
  LOCAL count=0
  LOCAL title="TC2061051-SPEEDDIAL/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    wait 1000
	#Press More
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"12: "  ' m1s57a  ' pseudo
	wait 1000	   
	#Press U3-Speeddial/xfer with Phone B's number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"13: "  ' m1s57a  ' pseudo
    
	
    expectMsgWait "14: "
    #Check display on Phone A
	#@3##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgWait "17: "
    
	#Check display on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "18: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 2000
	
	#Hook Off Phone B 
	expectMsgSend SUBB,Do.Hook,Hook.Off,"19: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
   
    expectMsgWait "26: "

    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 2000
	expectMsgSend SUBB,Do.Hook,Hook.On,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "35: "

    expectMsgSend SUBA,Do.Hook,Hook.On,"38: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"41: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    
    expectMsgSend SUBC,Do.Keys,SUBA.number,"47: "  ' m1s57c  ' pseudo
    
    expectMsgWait "48: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
    expectMsgWait "51: "
    
	#Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "52: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    wait 2000
	
	expectMsgSend SUBA,Do.Hook,Hook.Off,"53: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "60: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"61: "  ' m1s57a  ' pseudo
    wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "65: "
    
	#Check display on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "67: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    expectMsgWait "68: "
    #checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	
    expectMsgSend SUBB,Do.Hook,Hook.Off,"72: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgSend SUBA,Do.Hook,Hook.On,"77: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	wait 2000
	expectMsgSend SUBB,Do.Hook,Hook.On,"80: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait "84: "
    #@3checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ##expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgWait "90: "
	
    expectMsgWait "92: "
	
    expectMsgSend SUBC,Do.Hook,Hook.On,"93: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"96: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"98: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '2061051






###############################################################################################

'TC206106-BLF/XFER
'
'pvaastra on bos-bgalasso the 02/13/2012 11:41:11
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206106
  LOCAL count=0
  LOCAL title="TC206106-BLF/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#HOOK ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57c  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    wait 1000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	wait 1000
	
	#Press U9- BLF/XFER with Phone B's number
	#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"14: "  ' m1s57a  ' pseudo
    #ENDPLATFORM

	#PLATFORM==2
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"14: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    expectMsgWait "15: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
   
    expectMsgWait "23: "
    
	#Check Display of Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "24: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "46: "
    ##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 2000
	
	#Hook On Phone B to end the Call
	expectMsgSend SUBB,Do.Hook,Hook.On,"47: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgSend SUBA,Do.Hook,Hook.On,"53: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    ##expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "62: "
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    
	#Hook Off Phone C to call Phone A
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgSend SUBC,Do.Hook,Hook.Off,"67: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
   
    expectMsgSend SUBC,Do.Keys,SUBA.number,"74: "  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
   
    expectMsgWait "75: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
   
    expectMsgWait "83: "
    
	#Check display of Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "84: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    wait 2000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"86: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a  
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a    
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
        
    expectMsgWait "106: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000

	#Press U9 - BLF/XFER with Phone B's number  
	#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"14: "  ' m1s57a  ' pseudo
    #ENDPLATFORM

	#PLATFORM==2
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"14: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "128: "
    
	#Check display obn Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #Check F1 key LED
	#@#expectMsgAdd SUBA,Do.KeyF1,Key.LightActiveBlink  ' m1s57a
  
	#Check display on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    expectMsgWait "136: "
    #checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	wait 2000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"171: "  ' m1s57b  ' pseudo
    #@#expectMsgAdd SUBA,Do.KeyF4,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "207: "
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    wait 2000

	#Hook On Phone B
    expectMsgSend SUBB,Do.Hook,Hook.On,"228: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF4,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   # #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "244: "
   
    expectMsgWait "246: "
  
    expectMsgSend SUBC,Do.Hook,Hook.On,"247: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.Hook,Hook.On,"250: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"253: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"254: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"255: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND

ENDTC '206106






#########################################################################################

'TC206107-Xfer with 2 outbound active calls
'
'pvaastra on bos-bgalasso the 02/15/2012 09:54:46
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206107
  LOCAL count=0
  LOCAL title="TC206107-Xfer with 2 outbound active calls"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"7: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"8: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"9: "  ' m1s57d  ' pseudo
    
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"10: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
   
    #Dial Phone B's number
	expectMsgSend SUBA,Do.Keys,SUBB.number,"17: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "26: "
    
	#Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "27: "
   #@# checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Hook off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"29: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b     
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b  
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a   
    expectMsgWait "49: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
	wait 2000
	
	#Press L2 on Phone A
    expectMsgSend SUBA,Do.KeyL2,Key.Click,"50: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57b     
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a  
	wait 1000
	
	#Type Phone C's number
    expectMsgSend SUBA,Do.Keys,SUBC.number,"159: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1    
    expectMsgWait "160: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c  
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c    
    expectMsgWait "168: "
	
	#Check Phone C's display
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "169: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "171: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	wait 2000
	
	#Hook Off Phone C
    expectMsgSend SUBC,Do.Hook,Hook.Off,"173: "  ' m1s57c  ' pseudo       
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a 
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    wait 2000
	
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"192: "  ' m1s57a  ' pseudo
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a  
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a   
    expectMsgWait "217: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer on L1 of Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"218: "  ' m1s57a  ' pseudo
    expectMsgWait "219: "
	#@###expectTextCheck SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a	
    expectMsgWait "246: "    
	wait 3000
	
	#Press L2
	expectMsgSend SUBA,Do.KeyL2,Key.Click,"50: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    expectMsgWait "320: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a   
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "387: "
	wait 1000   
    expectMsgSend SUBA,Do.Hook,Hook.On,"388: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    wait 2000
	
	#Hook On Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"391: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "408: "
    
    expectMsgWait "410: "
   
    expectMsgSend SUBC,Do.Hook,Hook.On,"411: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206107





##########################################################################################################

'TC206109-Cancel Xfer while connected
'
'pvaastra on bos-bgalasso the 02/15/2012 13:22:19
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206109 
  LOCAL count=0
  LOCAL title="TC206109-Cancel Xfer while connected"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo   
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a        
    expectMsgWait "18: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 2000
	
	#Hook Off Phone A
    expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgWait "27: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	wait 2000
    
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a    
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a    
	expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"28: "  ' m1s57a  ' pseudo
    expectMsgWait "33: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a	
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a   
    #expectMsgWait "34: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "36: "
   
	#Check display on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "39: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"40: "  ' m1s57c  ' pseudo
	expectMsgWait "51: "
	wait 1000
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"46: "  ' m1s57a  ' pseudo    
    expectMsgWait "47: "

	#Check display on Phone A
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #expectMsgWait "48: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgWait "51: "
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "54: "
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	wait 2000
	
	#Hook On Phone C
    expectMsgSend SUBC,Do.Hook,Hook.On,"55: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b   
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "63: "   
    expectMsgWait "65: "   
    expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBA,Do.Hook,Hook.On,"69: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206109






###############################################################################################

'TC206112- Xfer call after dialing a wrong number
'
'pvaastra on bos-bgalasso the 02/15/2012 16:31:18
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206112
 LOCAL count=0
  LOCAL title="TC206112- Xfer call after dialing a wrong number"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    
	#Hook Off Phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo    
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "19: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "20: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 1000
	
	#Hook Off Phone A
    expectMsgSend SUBA,Do.Hook,Hook.Off,"21: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "28: "
    expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
	#Press Xfer to dial the wrong number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "33: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Keys,"1231431","34: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "36: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57a  ' pseudo
    expectMsgWait "41: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom"+JOCKER  ' m1s57a
    
	#Wait until the Phone A comes back to hold
	#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	wait 4000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "43: "
	#expectMsgAdd SUBA,Do.Connected,Connected.Hold  ' m1s57a   
    #expectMsgWait
	'##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"1231431"+JOCKER  ' m1s57a  3.3.1.80 BUG - Wrong Number Is Cleared From Screen. Uncomment When Fixed
    expectMsgWait "44: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
	wait 1000
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a   
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a   
    expectMsgSend SUBA,Do.Keys,SUBC.number,"48: "  ' m1s57a  ' pseudo
    expectMsgWait "50: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a    
    '##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "51: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"52: "  ' m1s57a  ' pseudo
    expectMsgWait "55: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a  
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a  
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "56: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c  
    expectMsgWait "58: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "59: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "61: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"62: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	
	#Press xfer to finish the xfer between A and C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"68: "  ' m1s57a  ' pseudo
    #'number '9057604212' found in pco 'm1s57b' (9057604212) -> SUBB.number
    #expectMsgWait "69: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "70: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "70: "
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    expectMsgWait "73: "   
    expectMsgWait "76: "  
    expectMsgSend SUBB,Do.Hook,Hook.On,"77: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "81: " 
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c      
    expectMsgWait "87: "    
    expectMsgWait "89: " 
    expectMsgSend SUBC,Do.Hook,Hook.On,"90: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.Hook,Hook.On,"93: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206112





###############################################################################################
'TC206113-Consultative xfer on L2 when L1 is on HOLD
's
'aastra on A155-0389 the 03/13/2012 10:17:02
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 206113
  LOCAL count=0
  #Count for the number of xfer's on L2
  LOCAL count2=0  
  LOCAL title="TC206113-Consultative xfer on L2 when L1 is on HOLD"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
  REPEAT  
	RECINFO "Count : "+count	
	#'Press goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	#Hook On 
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 1000
	
	#Hook Off Phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"10: "  ' m1s57b  ' pseudo
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgSend SUBB,Do.Keys,SUBA.number,"17: "  ' m1s57b  ' pseudo
    expectMsgWait "18: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"19: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF4,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@3expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "35: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "36: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgWait
	wait 2000
	
	#Hook Off Phone A to recieve a call from Phone B on L1
	expectMsgSend SUBA,Do.Hook,Hook.Off,"39: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "58: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	
	REPEAT  
	RECINFO "Count2 : "+count2
    expectMsgWait
	wait 2000
		
	#Hook Off Phone C to call Phone A on L2
	expectMsgSend SUBC,Do.Hook,Hook.Off,"59: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.Keys,SUBA.number,"66: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"68: "  ' m1s57c  ' pseudo
	expectMsgWait "67: "
	wait 2000
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    #expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "86: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgWait
	wait 2000
	
	#Press L2 on Phone A to pick up the call from Phone C
	expectMsgSend SUBA,Do.KeyL2,Key.Click,"88: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	#expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "112: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait
	wait 2000
	
	#Press Xfer on Phone A to Xfer Phone C to Phone D
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"113: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgWait
	wait 2000
	
	expectMsgSend SUBA,Do.Keys,SUBD.number,"125: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "126: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DCindy Christens^CDaniel Dacascos"+JOCKER  ' m1s57a
    expectMsgWait "127: "
    expectMsgWait
	wait 1000
	
	
    ##expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBD,Do.KeyL1,Key.LightActiveBlink  ' m1s57d
    #expectMsgAdd SUBD,Do.Ringing,Ringing.Yes  ' m1s57d
    expectMsgWait "135: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57d
    checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57d
    expectMsgAdd SUBD,Do.KeyMessage,Key.LightActiveBlink  ' m1s57d
    expectMsgWait
	wait 2000
	
	#Hook Off Phone D 
	expectMsgSend SUBD,Do.Hook,Hook.Off,"139: "  ' m1s57d  ' pseudo
	wait 1000
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBD,Do.Ringing,Ringing.Quiet  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgWait
	wait 2000
	
	#Press Xfer to finish the consultative Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"156: "  ' m1s57a  ' pseudo
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DCindy Christens^CDaniel Dacascos"+JOCKER  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	expectMsgWait
	wait 3000
	
	#Hook ON Phone C to finish the call with Phone D
	expectMsgSend SUBC,Do.Hook,Hook.On,"315: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    expectMsgSend SUBD,Do.Hook,Hook.On
	expectMsgAdd SUBD,Do.Hook,Hook.On 
	count2=count2+1 
	UNTIL count2=3
	
	#Press L1 to Pickup  the call with Phone A
    expectMsgSend SUBA,Do.KeyL1,Key.Click,"322: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait
	wait 3000
	
	#Hook ON Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"333: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait "336: "
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBD,Do.Hook,Hook.On,"352: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgSend SUBA,Do.Hook,Hook.On,"355: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206113






##################################################################################################
'TC206115- Consecutive Xfer 
'Edited by Weiling Chen 
'pvaastra on bos-bgalasso the 26/09/2012 16:31:18
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206115
 LOCAL count=0
  LOCAL title="TC206115 - Consecutive Xfer calls"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    
	#Hook Off Phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
	expectMsgWait "9: "
	wait 1000
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo    
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"17: "  ' m1s57b  ' pseudo
	expectMsgWait "18: "
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgWait "21: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 1000
	
	#Hook Off Phone A
    expectMsgSend SUBA,Do.Hook,Hook.Off,"24: "  ' m1s57a  ' pseudo
	expectMsgWait "25: "
	wait 1000
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "28: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    wait 1000
	
	#Press Xfer to dial the phone C number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgWait "33: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"FN2531 LN2531"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Keys,SUBC.number,"34: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBC,Do.Connected,Connected.Yes    ' m1s57c
    expectMsgWait "36: "
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57a  ' pseudo
    expectMsgWait "41: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DFN2531 LN2531"+JOCKER  ' m1s57a
	wait 3000

	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c   
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
	
	#Hook off phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"53: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	
	
	#Check the display on phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "55: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c 
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgWait "58: "
	wait 2000
	
	
	#phone A press Xfer to phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"59: "  ' m1s57a  ' pseudo
	expectMsgWait "62: "
	wait 500
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgWait "65: "
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57a  ' pseudo
	expectMsgWait "70: "
	wait 1000
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	
	
	#Phone D is calling phone A, phone A picks up 
	expectMsgSend SUBD,Do.Hook,Hook.Off,"72: "  ' m1s57d  ' pseudo
	wait 500
	expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
	expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
	expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    expectMsgSend SUBD,Do.Keys,SUBA.number,"78: "  ' m1s57d  ' pseudo    
    expectMsgWait "80: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57d
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"85: "  ' m1s57d  ' pseudo
	expectMsgWait "86: "
	wait 1000
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgWait "88: "
	wait 3000
	#Phone A answer the call after ringing for 3s
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"90: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.Off,"91: "  ' m1s57a  ' pseudo
	wait 1000
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
	expectMsgWait "92: "
	expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d

	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57a
	expectMsgWait "93: "
	wait 2000

	#A Xfer phone D to phone B
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"95: "  ' m1s57a  ' pseudo
	expectMsgWait "98: "
	wait 2000
	
	expectMsgSend SUBA,Do.Keys,SUBB.number,"102: "  ' m1s57a  ' pseudo
	expectMsgWait "105: "
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"100: "  ' m1s57a  ' pseudo
	expectMsgWait "105: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	'expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	
	#Phone B picks up the call on Line 2
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F2,"108: "  ' m1s57b  ' pseudo
	expectMsgWait "110: "
	wait 2000
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
		expectMsgWait "110: "
	wait 5000
	#Phone A Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"115: "  ' m1s57a  ' pseudo
	expectMsgWait "120: "
	wait 2000
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	expectMsgWait "125: "
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	'expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	'expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	expectMsgWait "130: "
    wait 2000
	
	#Hook on the phone A,B,C and D
	expectMsgSend SUBC,Do.Hook,Hook.On,"135: "  ' m1s57c  ' pseudo
	wait 1000
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBB,Do.Hook,Hook.On,"137: "  ' m1s57b  ' pseudo
    wait 1000
	expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgWait "140: "
	expectMsgSend SUBD,Do.Hook,Hook.On,"142: "  ' m1s57d  ' pseudo
	expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
	expectMsgSend SUBA,Do.Hook,Hook.On,"145: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206115







###################################################################################################
'Verify ringing and MWI on second incoming call during Xfer process
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/26/2012 14:27:23
' SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)
TESTCASE 206116
  LOCAL count=0
  LOCAL title="TC 206116- Verify ringing and MWI on second incoming call during Xfer process"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
     REPEAT
    RECINFO "Count : "+count
    #Press GOODBYE
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 500
  
    #Hook ON
    expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
  
    #Press L1 on Phone B
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
    expectMsgWait
    wait 500
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
    expectMsgWait
    wait 2000
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a  
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
  
    #Phone A answers in handsfree mode
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
    expectMsgWait
    wait 1000
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait
    wait 1000
 
    #Phone A starts make a Xfer
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"32: "  ' m1s57a  ' pseudo
    expectMsgWait
    wait 1000
 
    #Hook off Phone D to call phone A
    expectMsgSend SUBD,Do.Keys,SUBA.number,"35: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.Off ' m1s57d
    wait 1000
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive ' m1s57d
    expectMsgAdd SUBD,Do.Hook,Hook.Off ' m1s57d
    expectMsgWait
    wait 3000
   
    # Veirfy status of incoming call on Phone A
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial
    #expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait
    wait 1000
   
   #Phone A dial Phone C's number and make a blind Xfer
    expectMsgSend SUBA,Do.Keys,SUBC.number,"42: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"44: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    expectMsgWait "46: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "48: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    wait 2000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"56: "  ' m1s57a  ' pseudo
    expectMsgWait "57: "
    wait 2000

   # Veirfy status of incoming call on Phone A again
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a  
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57a
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57a
    wait 3000
  
    #Phone A press L2 to answer the call
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"65: "  ' m1s57a  ' pseudo
    wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    #expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
  
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"70: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"74: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"75: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"78: "  ' m1s57d  ' pseudo
    expectMsgWait
    count=count+1
    UNTIL count=1
  WEND
ENDTC '206116






##############################################################################################################################################
'TC206118- Consultative xfer on L1 when incming call on L2 
'Editted By Weiling Chen
'aastra on A155-0389 the 11/06/2012 10:17:02
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)
TESTCASE 206118
  LOCAL count=0
  LOCAL title="TC206118- Consultative xfer on L1 when incming call on L2"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
  REPEAT  
	RECINFO "Count : "+count
	#'Press goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	#Hook On 
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 1000
	
	#Press L1 on Phone B to call Phone A
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo    
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "19: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "20: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 1000
	
	#Phone A Press L1 to pick up the call
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"21: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "28: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    wait 2000
		
	#Phone A press Xfer, meanwhile, Phone D call Phone On L2
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
	wait 1000  
	expectMsgSend SUBD,Do.Hook,Hook.Off,"59: "  ' m1s57d  ' pseudo
	wait 1000
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgSend SUBD,Do.Keys,SUBA.number,"66: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"68: "  ' m1s57c  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgWait "86: "
	wait 2000
    expectMsgSend SUBA,Do.Keys,SUBC.number,"48: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"52: "  ' m1s57a  ' pseudo
    expectMsgWait "50: "
	'expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	'expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a  
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "56: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "59: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "61: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone C answer the call from Phone A
	expectMsgSend SUBC,Do.Hook,Hook.Off,"59: "  ' m1s57c  ' pseudo
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgWait
	wait 3000
	
	#Press Xfer on Phone A to Xfer Phone B to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"113: "  ' m1s57a  ' pseudo
	wait 1000	
	#Phone A pick up the call from Phone D on L2 
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"111: "  ' m1s57a  ' pseudo
	expectMsgWait "155: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57a
	wait 2000
	#Hook ON Phone D to finish the call with Phone A
	expectMsgSend SUBD,Do.Hook,Hook.On,"200: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgAdd SUBB,Do.Hook,Hook.On 
	
	#Hook ON Phone C
	expectMsgSend SUBC,Do.Hook,Hook.On,"333: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
 
    expectMsgWait
	wait 1000
	count=count+1
	UNTIL count=1
  WEND
ENDTC '206118






##############################################################################################################################################
#
# 2061 Xfer_Broadsoft(Speaker On)
#
###################################################################################################
'B CALLS A, A XFERS B TO C 
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 09/26/2012 14:27:23
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206201
  LOCAL count=0
  LOCAL title="TC206201(Speaker On) B CALLS A, A XFERS B TO C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 	REPEAT  
	RECINFO "Count : "+count  
	#Press GOODBYE
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 500
	
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
	wait 500
	
	#Press L1 on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 2000
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a  
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a  
	#RECINFO "1:" 
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone A Picks up call by pressing Line 1
	#send SUBA,Do.Hook,Hook.Off  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b 
	#RECINFO	"2:"
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait
	wait 1000
	
	#Press XFER
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: "  ' m1s57a  ' pseudo  
	#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgWait
	wait 1000
	'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	#Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#RECINFO"3:"
    #@##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a    
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"4165142532"+JOCKER  ' m1s57a
    wait 1000
	
	#Press xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: "  ' m1s57a  ' pseudo
	#RECINFO "4:"
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait
	wait 1000
    #waitTill SUBA,Do.InbandTone,InbandTone.Disconnect 
	#RECINFO "5:" ' m1s57a    
    #expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #@##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   
	#Phone C picks up the call
	#send SUBC,Do.Hook,Hook.Off  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"55: "  ' m1s57c  ' pseudo
    #waitTill SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c 
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	wait 1000
	#Press Goodbye PHONE C
    #send SUBC,Do.Hook,Hook.On  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"60: "  ' m1s57c  ' pseudo
    #waitTill SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgWait
	wait 2000
    #expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	#expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightOff ' m1s57c 
	#expectMsgAdd SUBC,Do.KeyL1,Key.LightOff ' m1s57c
    #waitTill SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    #expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"65: "  ' m1s57a  ' pseudo
	#expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	#expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightOff ' m1s57a
	#expectMsgAdd SUBA,Do.KeyL1,Key.LightOff ' m1s57a
	#expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	#expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightOff ' m1s57b 
	#expectMsgAdd SUBB,Do.KeyL1,Key.LightOff ' m1s57b
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206201






###################################################################################################

'TC206202-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 09/27/2012 14:25:03
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206202
  LOCAL count=0
  LOCAL title="TC206202(Speaker On)-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 500
	# Phone B to Call Phone A On Line 1
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    #'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgWait "13: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a  
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
	#Check the display of Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	#Phone A press Line 1 to Picks up call
    #Check if Phone A and Phone B are connected
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    #'number '^C9057604201' found in pco 'm1s57a' (9057604201) -> "^C"+SUBA.number
    #'number '9057604201^C9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number+"^C"+SUBA.number
    #Check display on Phone B
	expectMsgWait "25: "
	##@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"26: "  ' m1s57a  ' pseudo
    #@3expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive' m1s57b
	expectMsgWait
    
    #Dial Phone C number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"29: "  ' m1s57a  ' pseudo
	expectMsgWait 
	wait 1000
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgWait "31: "
    #Check Phone A's display  
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    #'number '^C9057604203' found in pco 'm1s57c' (9057604203) -> "^C"+SUBC.number
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgWait 
	wait 1000
	#Press Xfer to finish Blind Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"33: "  ' m1s57a  ' pseudo
    
	#Check display on Phone A
	expectMsgWait "34: "
    wait 2000
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "35: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	#Check if Phone A is not connected anymore
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #Check If Phone C is ringing
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
	#Check display on Phone C
	expectMsgWait "39: "
    #expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	#Phone C picks up the call
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"43: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c 
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    #Check if Phone C and Phone B is connected
	#expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #expectMsgSend SUBA,Do.Hook,Hook.On,"50: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait "57: "    	
    wait 2000
	#Finish the call between B and C
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"60: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	#expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	# expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	# expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	# expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	# expectMsgSend SUBD,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	# expectMsgSend SUBE,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
   WEND
	
ENDTC '206202






###################################################################################################

'TC206203-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C
'
'pvaastra on bos-bgalasso the 09/27/2012 15:31:17
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206203
  LOCAL count=0
  LOCAL title="TC206203(Speaker On)-Blind Transfer-When Ringing, Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
    #Press Good bye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    #Prees Line 1 on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
  
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "14: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
    expectMsgWait "17: "
	#Check display On Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "18: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	#Check if A and B are connected
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"19: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "26: "
    #expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"27: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    
    wait 1000
	expectMsgSend SUBA,Do.Keys,SUBC.number,"30: "  ' m1s57a  ' pseudo
    expectMsgWait
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgWait "32: "
    #Check Phone A display
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    '##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "33: "
	wait 1000
	#Press Dial
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"34: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
	#Check Phone C's display
    expectMsgWait "36: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"38: "  ' m1s57a  ' pseudo
    
    #Check display on Phone C
	expectMsgWait "39: "
	wait 500
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    ###expectTextCheck SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #expectMsgWait "40: "
    #checkGetStateText SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    #Check if Phone A is disconnected
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
	#Check Phone A's display	
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check display of Phone C again
	expectMsgWait "49: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "50: "
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
	wait 2000
   #Phone C press Line 1 to answer the call
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"55: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	#Check if B and C Are connected
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgWait 
	wait 2000	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"59: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "69: "    
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"75: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"77: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206203






###################################################################################################

'TC206204-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 09/27/2012 16:08:50
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206204
  LOCAL count=0
  LOCAL title="TC206204(Speaker On)-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hoon On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Press L1 on the Phone B to dial Phone A's number
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "15: "
    #Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check Phone A's display
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	# Phone A press Line 1 to pick up call
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "27: "
    # expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    
    #Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
    expectMsgWait "34: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #Check display on Phone A
	#expectMsgWait "33: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    
	expectMsgWait
	wait 1000
	#Press dial
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"35: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check Phone C's display
	expectMsgWait "37: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "38: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	#Phone C press L1 to answer the call
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"39: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"40: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
    
    expectMsgWait "46: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "47: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    ##expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "50: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
    wait 2000
    #expectMsgSend SUBB,Do.Hook,Hook.On,"54: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"55: "  ' m1s57b  ' pseudo
    
    expectMsgWait "57: "    
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ##expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c

	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"71: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"72: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206204






#####################################################################################################
'TC206205-SPEEDDIAL/XFER
'
'pvaastra on bos-bgalasso the 09/27/2012 10:01:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206205
  LOCAL count=0
  LOCAL title="TC206205(Speaker On)-SPEEDDIAL/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press L1 on Phone A 
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    wait 1000
	#Press More
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"12: "  ' m1s57a  ' pseudo
	wait 1000	   
	#Press U3-Speeddial/xfer with Phone B's number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"13: "  ' m1s57a  ' pseudo
    
	
    expectMsgWait "14: "
    #Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    
    expectMsgWait "17: "
    
	#Check display on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "18: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 2000
	
	#Phone B Press L1 to pick up the call 
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"19: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "26: "

    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 2000
	#expectMsgSend SUBB,Do.Hook,Hook.On,"27: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"55: "  ' m1s57b  ' pseudo
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "35: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"36: "  ' m1s57a  ' pseudo
	#Press L1 on Phone C
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"37: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    
    expectMsgSend SUBC,Do.Keys,SUBA.number,"47: "  ' m1s57c  ' pseudo
    
    expectMsgWait "48: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "51: "
    
	#Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "52: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    wait 2000
	#Phone press L1
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"53: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"55: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "60: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"61: "  ' m1s57a  ' pseudo
    wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "65: "
    
	#Check display on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "67: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    expectMsgWait "68: "
    #checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"72: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"70: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    #expectMsgSend SUBA,Do.Hook,Hook.On,"77: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"85: "  ' m1s57a  ' pseudo
	wait 2000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"86: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait "87: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ##expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgWait "90: "
	
    expectMsgWait "92: "
	
    #expectMsgSend SUBC,Do.Hook,Hook.On,"93: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"96: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206105







###############################################################################################

'TC206206-BLF/XFER
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 09/27/2012 11:41:11
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 206206
  LOCAL count=0
  LOCAL title="TC206206(Speaker On)-BLF/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#HOOK ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57c  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    wait 1000
	
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	wait 1000
	
	#Press More on Phone A
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"13: "  ' m1s57a  ' pseudo
    #wait 1000
	
	#Press U3- BLF/+XFER with Phone B's number
	#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
	#PLATFORM==2,4
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    
    expectMsgWait "15: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "23: "
    
	#Check Display of Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "24: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Phone B Press L1 to pick up call
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"27: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "32: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 2000
	
	#Press GoodBye on Phone B to end the Call
	#expectMsgSend SUBB,Do.Hook,Hook.On,"47: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"33: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
	#expectMsgSend SUBA,Do.Hook,Hook.On,"53: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"36: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    ##expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "40: "
    
	#Press L1 on Phone C to call Phone A
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"67: "  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"42: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    
    expectMsgSend SUBC,Do.Keys,SUBA.number,"45: "  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "48: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "51: "
    
	#Check display of Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "52: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    wait 2000
	
	#Phone A Press L1 to answer the call
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"86: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a  
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"57: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a 
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    
    expectMsgWait "106: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000

	#Press More on Phone A
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"107: "  ' m1s57a  ' pseudo
    #wait 1000
	
	#Press U12 - BLF/XFER with Phone B's number  

	#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
	#PLATFORM==2,4
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "128: "
    
	#Check display obn Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #Check F1 key LED
	#@#expectMsgAdd SUBA,Do.KeyF1,Key.LightActiveBlink  ' m1s57a
         
    expectMsgWait "135: "
    
	#Check display on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    expectMsgWait "136: "
    ##@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	wait 2000
	
	#Hook Off Phone B
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"171: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"145: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyF4,Key.LightOff ' m1s57b
    expectMsgAdd SUBB,Do.KeyF1,Key.LightOff  ' m1s57b
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "207: "
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
	#expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    wait 2000

	#Press GoodBye on Phone B
    #expectMsgSend SUBB,Do.Hook,Hook.On,"228: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"210: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF4,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "244: "
    #expectMsgSend SUBC,Do.Hook,Hook.On,"247: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #expectMsgSend SUBA,Do.Hook,Hook.On,"250: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"246: "  ' m1s57c  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"247: "  ' m1s57a  ' pseudo
	
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"253: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"254: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"255: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo

	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND

ENDTC '206206






#########################################################################################

'TC206207-Xfer with 2 outbound active calls
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 09/27/2012 09:54:46
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206207 
  LOCAL count=0
  LOCAL title="TC206207(Speaker On)-Xfer with 2 outbound active calls"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"7: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"8: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"9: "  ' m1s57d  ' pseudo
    
	#Press L1 on Phone A
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"10: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
   
    #Dial Phone B's number
	expectMsgSend SUBA,Do.Keys,SUBB.number,"17: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "26: "
    
	#Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "27: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Phone B Press L1 to pick up the call
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"29: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b     
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b  
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a   
    expectMsgWait "49: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
	wait 2000
	
	#Press L2 on Phone A
    expectMsgSend SUBA,Do.KeyL2,Key.Click,"50: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a     
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a  
	wait 1000
	
	#Type Phone C's number
    expectMsgSend SUBA,Do.Keys,SUBC.number,"159: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1    
    expectMsgWait "160: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c  
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c    
    expectMsgWait "168: "
	
	#Check Phone C's display
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "169: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "171: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	wait 2000
	
	#Phone C Press L1 to pick up the call
    #expectMsgSend SUBC,Do.Hook,Hook.Off,"173: "  ' m1s57c  ' pseudo       
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a 
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    wait 2000
	
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"192: "  ' m1s57a  ' pseudo 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a  
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a   
    expectMsgWait "217: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer on L1 of Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"218: "  ' m1s57a  ' pseudo
    expectMsgWait "219: "
	#@###expectTextCheck SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a	
    expectMsgWait "246: "    
	wait 3000
	
	#Press L2
	expectMsgSend SUBA,Do.KeyL2,Key.Click,"50: "  ' m1s57a  ' pseudo
	wait 1000
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    expectMsgWait "320: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a   
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "387: "
	wait 1000   
    #expectMsgSend SUBA,Do.Hook,Hook.On,"388: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"390: "  ' m1s57a  ' pseudo
	
	wait 2000
	
	#Hook On Phone B
	#expectMsgSend SUBB,Do.Hook,Hook.On,"391: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"395: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "410: "
    #expectMsgSend SUBC,Do.Hook,Hook.On,"411: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"450: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206207





##########################################################################################################

'TC206209-Cancel Xfer while connected
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 02/15/2012 13:22:19
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206209
  LOCAL count=0
  LOCAL title="TC206209(Speaker On)-Cancel Xfer while connected"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press L1 on phone B to call Phone A
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo   
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a    
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a    
    expectMsgWait "18: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 2000
	
	#Phone A Press L1 to pick up call
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "27: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	wait 2000
    
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a    
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"32: "  ' m1s57a  ' pseudo
    expectMsgWait "33: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a	
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a   
    #expectMsgWait "34: "
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "36: "
   
	#Check display on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "39: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone C Press L1 to pick up the call
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"40: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"42: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"46: "  ' m1s57a  ' pseudo    
    expectMsgWait "47: "

	#Check display on Phone A
	##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #expectMsgWait "48: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgWait "51: "
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "54: "
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	wait 2000
	
	#Phone C Press GoodBye
    #expectMsgSend SUBC,Do.Hook,Hook.On,"55: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"59: "  ' m1s57c  ' pseudo
	expectMsgWait
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b   
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "63: "   
    #expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    #expectMsgSend SUBA,Do.Hook,Hook.On,"69: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"65: "  ' m1s57b  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"66: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206209






###############################################################################################
'TC206212- Xfer call after dialing a wrong number
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 09/28/2012 16:31:18
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 206212
 LOCAL count=0
  LOCAL title="TC206212- Xfer call after dialing a wrong number"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    
	#Press L1 on Phone B to call Phone A
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo    
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "19: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "20: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 1000
	
	#Phone A Press L1 to pick up the call
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"21: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "28: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
	#Press Xfer to dial the wrong number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "33: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Keys,"1231431","34: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "36: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57a  ' pseudo
    expectMsgWait "41: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom"+JOCKER  ' m1s57a
    
	#Wait until the Phone A comes back to hold
	#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	wait 4000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "43: "
	#expectMsgAdd SUBA,Do.Connected,Connected.Hold  ' m1s57a   
    #expectMsgWait
	'#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"1231431"+JOCKER  ' m1s57a  3.3.1.80 BUG - Wrong Number Is Cleared From Screen. Uncomment When Fixed
    expectMsgWait "44: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
	wait 1000
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a   
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a   
    expectMsgSend SUBA,Do.Keys,SUBC.number,"48: "  ' m1s57a  ' pseudo
    expectMsgWait "50: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a    
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "51: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"52: "  ' m1s57a  ' pseudo
    expectMsgWait "55: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "56: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c  
    expectMsgWait "58: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "59: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "61: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone C Press L1 to answer the call
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"62: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"63: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	
	#Press xfer to finish the xfer between A and C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"68: "  ' m1s57a  ' pseudo
    
    #expectMsgWait "69: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "70: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "70: "
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    expectMsgWait "73: "   
    expectMsgWait "76: "  
    #expectMsgSend SUBB,Do.Hook,Hook.On,"77: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"78: "  ' m1s57b  ' pseudo
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "81: " 
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c      
    expectMsgWait "87: "    
    expectMsgWait "89: " 
    #expectMsgSend SUBC,Do.Hook,Hook.On,"90: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #expectMsgSend SUBA,Do.Hook,Hook.On,"93: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"91: "  ' m1s57c  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"92: "  ' m1s57a  ' pseudo
	expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '206212






###################################################################################################

## 207_CONFERENCE_BROADSOFT 

###################################################################################################

 #### Intial state of the phone :
 #### --Phine A is DUT
 #### --BLF is set on U10 on DUT
 #### --Phone C speeddial is set in U4  on DUT
 #### --Pnone C speeddial/conference is set as U5 on DUT
 #### --Services is set on U7 on DUT
 #### --Directory is set on U8 on DUT
 #### --Callers List is set on U9 on DUT

###################################################################################################

#######################################################################

'TC 207100- Conference Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 207100
  LOCAL title="TC207100-Conference Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=11

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 1000
  WEND
ENDTC '207100







####################################################################################################
'Clearing the Directory and the Callers List
'
'aastra on a155-0138 the 03/01/2012 16:09:57
'  SUBA(m1s57a)  SUBB(m1s57b)  
TESTCASE 2071001
  LOCAL title="TC2071001-Clearing the Directory and the Callers List"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
          #### Initial State of the Phones ####
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
		wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57e  ' pseudo
		wait 1000
		#### Clearing Directory ####

    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57e  ' pseudo
		wait 1000

    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57e  ' pseudo
		wait 1000

    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57e  ' pseudo
		wait 3000

    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57e  ' pseudo
    'expectMsgWait "10: "

	wait 3000	
	expectMsgWait "11: "
	#### Clearing Callers list /Initial staate of the Phones ####

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57e  ' pseudo
    expectMsgWait "14: "
		wait 1000

    expectMsgWait "15: "
	#Press Delete
    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"16: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"16: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57e  ' pseudo
	'	wait 1000

	#Press DeleteList to erase all items

	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57e  ' pseudo
	#wait 1000
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57e  ' pseudo
	'wait 1000
			
    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"23: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"23: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57e  ' pseudo
    'expectMsgWait "26: "
	'wait 3000
    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57e  ' pseudo	
	#wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57e  ' pseudo
    expectMsgWait
  WEND
ENDTC '2071001








#############################################################################################################
'Basic Test 1 - Verify that conference host can initiate, execute and complete local conference when first call is incoming call.
'
'aastra on a155-0138 the 02/23/2012 10:36:56
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207101
  LOCAL title="Basic Test 1 "
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    
	#### Initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
    ### Phone B is calling PhoneA ###
	expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    expectMsgWait "12: "
	wait 1000
	#stone
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"63: "  ' m1s57a  ' pseudo
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgWait "13"
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    
	#stone
	#expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
	expectMsgWait "15: "
	wait 500
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    #expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
     ### Ringing for 5s then phone A answer phone B ###
	expectMsgWait "23: "
	wait 5000
    expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgWait "26: "
	wait 1000
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530" + JOCKER  ' m1s57b
	     expectMsgWait
		wait 5000
  ### Starting a conference on phone A with phone C and phoneB ###
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
	    expectMsgWait
		wait 1000
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"63: "  ' m1s57a  ' pseudo

    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "73: "
	wait 5000
 #### phone C answers ####	
    expectMsgSend SUBC,Do.Hook,Hook.Off,"74: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgWait "75: "
	wait 5000  
 #### making the conference ####	
  expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "  ' m1s57a  ' pseudo
  	expectMsgWait "81: "
	wait 1000
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgWait "81: "
	wait 7000
	
 #### hold the conference for 7s the phones hang up ####	
    expectMsgSend SUBB,Do.Hook,Hook.On,"91: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgWait "81: "
	wait 1000
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgWait "81: "
	wait 1000

    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    #expectMsgSend SUBA,Do.Hook,Hook.On,"110: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a	
    expectMsgWait "116: "
    
    expectMsgWait "117: "
    expectMsgSend SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait "121: "
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgSend SUBC,Do.Hook,Hook.On,"124: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "133: "
    expectMsgWait "135: "
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
	
	 #### initial state of the phones####
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"138: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
  WEND
ENDTC '207101







#############################################################################################################
'Basic Test 2 - Verify that conference host can initiate, execute and complete local conference when first call is outgoing call.
'
'aastra on a155-0138 the 02/23/2012 11:50:22
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207102
  LOCAL title="Basic Test 2"
   #### configuring phones ####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
     #### initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	 #### Phone A is calling pone B ####
    expectMsgWait 
	wait 1000
	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.Off,"9: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
	expectMsgWait 
	wait 2000 
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    #### phone B rings for 5s then answers   ####   
    expectMsgWait "25: "
	wait 3000  
   
    expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    expectMsgWait "46: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
    #### start making a conference ####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgWait
	wait 1000	

    #### Dialing phone C #### 
    expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    #@#expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
 
    #### phone C rings for 5s and then answer #### 
	 expectMsgWait "75: "
	wait 5000
	expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgWait "80: "
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
     expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "83: "
	wait 4000  
    #### establishing the conference ####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait
	wait 5000
	#### finishing the conference/phones are hooking  on  ####
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57c  ' pseudo

    expectMsgWait "126: "
	wait 2000
		expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57c  ' pseudo
    expectMsgWait "126: "
	wait 2000
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	expectMsgSend SUBA,Do.Hook,Hook.On,"108: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.Hook,Hook.On,"108: "  ' m1s57a  ' pseudo
	expectMsgSend SUBC,Do.Hook,Hook.On,"108: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "129: "
    
	#### initial state of the phones ####
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	
  WEND
ENDTC '207102





#############################################################################################################
'Basic Test 3 - Verify that conference host can initiate, execute and complete local conference when 2 outbound active calls are already running.
'
'aastra on a155-0138 the 02/23/2012 14:17:44
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207103
  LOCAL title="Basic Test 3"
   ##### Configuring the phones #####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
       ##### phone A is calling phone B #####

	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
	
    expectMsgSend SUBA,Do.Hook,Hook.Off,"9: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    ##### phone B rings for 5s then answers #####
	  expectMsgWait "24: "  
	  wait 5000
	expectMsgSend SUBB,Do.Hook,Hook.Off,"25: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    #expectMsgWait "44: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
     expectMsgWait "44.5: "  
	  wait 5000    
	    ##### phone A is calling phone C from L2 #####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"45: "  ' m1s57a  ' pseudo
	expectMsgWait "48.5: "  
	wait 500   
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"58: "  ' m1s57a  ' pseudo
    
    expectMsgWait "59: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
 	    expectMsgWait
		wait 1000
 expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "68: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "69: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    ##### phone C rings for 5s then answers  #####      
	  expectMsgWait "70: "  
	  wait 5000   
	expectMsgSend SUBC,Do.Hook,Hook.Off,"73: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "93: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
	  expectMsgWait  
	  wait 2000        
	 ##### starting to make a conference form DUT(phone A) #####   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"94: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
  '  expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
	    expectMsgWait
		wait 3000	
        #####  conference on phone A with phone B on L1 and phone C on L2#####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"111: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
         expectMsgWait "124: "  
	  wait 7000
    ##### finishing the conference/phones hook on/initial state of the phones  #####	  
      # #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a   
   expectMsgSend SUBA,Do.Hook,Hook.On,"136: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
   ' expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "149: "
   ' expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"151: "  ' m1s57a  ' pseudo
    expectMsgWait "152: "
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "164: "
	  '  'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgWait "166: "
    expectMsgSend SUBB,Do.Hook,Hook.On,"167: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"170: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"171: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"174: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
  WEND
ENDTC '207103






#############################################################################################################

'Advanced Test 1 - 2nd leg dropped by remote phone
'
'aastra on a155-0138 the 02/27/2012 10:44:39
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207105
  LOCAL title="Advanced Test 1"
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
     ##### Initial state of the phones #####	    
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	
	     ##### Phone B is Calling Phone A  #####	  

	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    
     ##### Phone A Rings for 5s Then Answers  #####		
	expectMsgWait "25: "
   wait 5000
   expectMsgSend SUBA,Do.Hook,Hook.Off,"26: "  ' m1s57a  ' pseudo
   expectMsgWait
	wait 1000
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
      expectMsgWait "46.5: "
   wait 5000 
   
 	##### Start Making a Conference Form Phone A  #####	  
	
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
  '  expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	    expectMsgWait
		wait 1000	
      ##### Phone A is Calling Phone C  #####	  
	  
	expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "75: "
   wait 5000    
   
   	      ##### Phone C Rings for 5s Then Answers  #####	

	expectMsgSend SUBC,Do.Hook,Hook.Off,"77: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
	expectMsgWait "75: "
   wait 1000   
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgWait
	wait 500
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
     expectMsgWait "94: "
   wait 7000  
   	 ##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
  	      ##### Phone C Hangs Up #####	
 
	expectMsgSend SUBC,Do.Hook,Hook.On,"95: "  ' m1s57c  ' pseudo
	expectMsgWait "75: "
    wait 1000   
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c

    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgWait "112: "
	
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"116: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	
  ##### Phone A Hangs Up #####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"118: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
      expectMsgWait "128: "
   wait 5000     
  ##### Phone B Hangs Up #####	
	expectMsgSend SUBB,Do.Hook,Hook.On,"129: "  ' m1s57b  ' pseudo
    expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "143: "
  WEND
ENDTC '207105






#############################################################################################################

'Advanced Test 2 - Drop & add participants
'
'aastra on a155-0138 the 02/29/2012 13:32:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 207106
  LOCAL title="Advanced Test 2 "
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
      ##### Initial state of the phones #####	         
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
     ##### Phone B is Calling Phone A  #####	  
	
	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"10: "  ' m1s57b  ' pseudo
    
    expectMsgWait "12: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
   
   expectMsgSend SUBB,Do.Hook,Hook.Off,"13: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "25: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "26: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
     expectMsgWait
		wait 5000
     ##### Phone A Rings for 5s Then Answers  #####		
	expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "48: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number'SUBA.number+JOCKER  ' m1s57b
    
	    expectMsgWait
		wait 1000
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	    expectMsgWait
		wait 1000	
 	       ##### Phone A is Calling Phone C  #####	    
   expectMsgSend SUBA,Do.Keys,SUBC.number,"68: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"69: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    
    expectMsgWait "76: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "77: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
	      ##### Phone C Rings for 5s Then Answers  #####	
	 expectMsgWait
		wait 5000   
	expectMsgSend SUBC,Do.Hook,Hook.Off,"81: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
	      ##### Establishing a Conference between Phone A ,Phone B and Phone C #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"99: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	expectMsgWait
		wait 5000
	      ##### Phone A drops Phone C from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"112: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    
    expectMsgWait "119: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "120: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "122: "
	      ##### Phone C Hook On /Initial state for the Phone C #####	
   
   expectMsgSend SUBC,Do.Hook,Hook.On,"123: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgWait
		wait 5000   
   expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"126: "  ' m1s57c  ' pseudo
	     expectMsgWait
		wait 3000
	##### Start Making Another Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"127: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	    expectMsgWait
		wait 1000
	##### Phone A is Calling Phone D  #####	  
   expectMsgSend SUBA,Do.Keys,SUBD.number,"145: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"146: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActiveBlink  ' m1s57d	
    expectMsgAdd SUBD,Do.Ringing,Ringing.Intern  ' m1s57d
    
    expectMsgWait "153: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57d
    expectMsgWait "154: "
    checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57d
    expectMsgAdd SUBD,Do.KeyMessage,Key.LightActiveBlink  ' m1s57d


     ##### Phone D Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
		expectMsgSend SUBD,Do.Hook,Hook.Off,"157: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
    expectMsgAdd SUBD,Do.Ringing,Ringing.Quiet  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		   ##### Establishing a Conference between Phone A ,Phone B and Phone D #####			
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"174: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"187: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"192: "  ' m1s57a  ' pseudo
   
   expectMsgWait
		wait 5000
	      ##### Phone A drops Phone D from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"198: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Disconnect  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
    expectMsgWait "205: "
    expectMsgWait "206: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
  	      ##### Phone D Hook On /Initial state for the Phone D #####	  
	expectMsgSend SUBD,Do.Hook,Hook.On,"207: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
 expectMsgWait
		wait 5000  
   expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"210: "  ' m1s57d  ' pseudo
	     expectMsgWait
		wait 1000
		
	##### Start Making Another Conference Form Phone A  #####	
 expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"211: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	     expectMsgWait
		wait 3000	
	       ##### Phone A is Calling Phone E  #####	  
   
    expectMsgSend SUBA,Do.Keys,SUBE.number,"230: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"231: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBE,Do.KeyL1,Key.LightActiveBlink  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Intern  ' m1s57e
   
    expectMsgWait "238: "
    expectTextCheck SUBE,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57e
    expectMsgWait "239: "
    checkGetStateText SUBE,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57e
    expectMsgAdd SUBE,Do.KeyMessage,Key.LightActiveBlink  ' m1s57e
    'expectMsgAdd SUBE,Do.KeyMessage,Key.LightOff  ' m1s57e
	
     ##### Phone E Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
	expectMsgSend SUBE,Do.Hook,Hook.Off,"242: "  ' m1s57e  ' pseudo
    expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
    expectMsgAdd SUBE,Do.Hook,Hook.Off  ' m1s57e
    expectMsgAdd SUBE,Do.Connected,Connected.Yes  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Quiet  ' m1s57e
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		
		      ##### Establishing a Conference between Phone A ,Phone B and Phone E #####			
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"259: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    
	expectMsgWait
		wait 5000
		
	      ##### Phone A drops Phone E from the conference  #####			

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"282: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBE,Do.KeyL1,Key.LightOff  ' m1s57e
    expectMsgAdd SUBE,Do.Connected,Connected.No  ' m1s57e
    'expectMsgAdd SUBE,Do.InbandTone,InbandTone.Disconnect  ' m1s57e
    expectMsgAdd SUBE,Do.InbandTone,InbandTone.Quiet  ' m1s57e
   
    expectMsgWait "289: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "290: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "292: "
	
	      ##### Phone E Hook On /Initial state for the Phone E #####	
    expectMsgSend SUBE,Do.Hook,Hook.On,"293: "  ' m1s57e  ' pseudo
    expectMsgAdd SUBE,Do.Hook,Hook.On  ' m1s57e
 expectMsgWait
		wait 5000   
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"296: "  ' m1s57e  ' pseudo
  
  #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number'SUBA.number+JOCKER  ' m1s57b
  
	      ##### Ending The Calls /Phones Hook On /Initial state of the Phones #####	
  
  expectMsgSend SUBB,Do.Hook,Hook.On,"297: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
   
    expectMsgWait "304: "
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"313: "  ' m1s57b  ' pseudo
    expectMsgWait "315: "
    expectMsgWait "317: "
    expectMsgSend SUBA,Do.Hook,Hook.On,"318: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"321: "  ' m1s57a  ' pseudo
    expectMsgWait
  WEND
ENDTC '207106






##################################################################################################
 
 
'Advanced Test 7 - Speeddial/conf softkey, w/ local conf.
'
'
'aastra on a155-0138 the 03/05/2012 10:59:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207110
	LOCAL title="Advanced Test 7"
  
 		##### configuring phones  #####	 
 
	setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
     ##### Initial state of the phones #####	 
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
     ##### Phone B is Calling Phone A  #####	  

	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo

       expectMsgSend SUBB,Do.Hook,Hook.Off,"12: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
   expectMsgWait "11: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	
	
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgWait
	wait 1000
   	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgWait "24: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgWait "27: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

 	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "28: "
	wait 5000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
 

    ##### Phone A is Dailing Phone C  Using  Speeddial/Conf Softkey #####
	expectMsgWait "47: "
	wait 5000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"48: "  ' m1s57a  ' pseudo
    expectMsgWait "48.5: "
	wait 1000  
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"49: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"49: "  ' m1s57a  ' pseudo
	#expectMsgWait
	#wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c

    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "78: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
  
	##### Phone C Rings for 5s Then Answers  #####	

	expectMsgWait "79: "
	wait 5000  
	expectMsgSend SUBC,Do.Hook,Hook.Off,"83: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "100: "
	wait 5000
  
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	
	##### Phone A Hook On /Initial state for the Phone A #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"118: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgWait "120: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a  
	expectMsgSend SUBA,Do.Hook,Hook.On,"122: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"134: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "28: "
	wait 1000
    expectMsgWait "145: "
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait "149: "
     expectMsgWait "149.5: "
	wait 5000  

	##### Phone B Hook On /Initial state for the Phone B #####	

	expectMsgSend SUBB,Do.Hook,Hook.On,"150: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"156: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c

	##### Phone C Hook On /Initial state for the Phone C #####	

    expectMsgSend SUBC,Do.Hook,Hook.On,"167: "  ' m1s57c  ' pseudo
    expectMsgWait "169: "
    expectMsgWait "171: "
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"173: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgWait
	wait 1500
  WEND
ENDTC '207110






################################################################################

'Advanced Test 9 - Using speeddial on 2nd leg
'
'aastra on a155-0138 the 03/01/2012 11:04:10
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207112
  LOCAL title="Advanced Test 9"
  
  		##### configuring phones  #####	 

  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	

    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
   
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
   expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	##### Phone A Rings for 5s Then Answers  #####		      
    
	expectMsgWait "25: "
	wait 5000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"27: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "46.5: "
	wait 5000   
	
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	
	##### Phone A is Calling Phone C Using SpeedDial#####
 	    expectMsgWait
		wait 2000    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"64: "  ' m1s57a  ' pseudo
	    expectMsgWait
		wait 2000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"65: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c

	##### Phone C Rings for 5s Then Answers  #####	
	expectMsgWait "75: "
	wait 5000   
	expectMsgSend SUBC,Do.Hook,Hook.Off,"76: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "85: "
	wait 5000   
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"93: "  ' m1s57a  ' pseudo
	expectMsgWait "94: "
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgWait "95: "
	wait 5000
    
    
    expectMsgWait "101: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b	
	

	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	##### Phone B Hook On /Initial state for the Phone B #####	

	expectMsgSend SUBB,Do.Hook,Hook.On,"106: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "117: "
    
    
    expectMsgWait "117.5: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "119: "
	wait 5000   
	
	##### Phone A Hook On /Initial state for the Phone A #####	
	
	expectMsgSend SUBA,Do.Hook,Hook.On,"120: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"129: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "135: "
    expectMsgWait "137: "
   
	##### Phone C Hook On /Initial state for the Phone C #####	
   
    expectMsgSend SUBC,Do.Hook,Hook.On,"138: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '207112







##################################################################################################

'Advanced Test 10 - Using BLF on 2nd leg
'
'aastra on a155-0138 the 03/01/2012 11:35:38
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207113
  LOCAL title="Advanced Test 10"

  ##### configuring phones  #####	 
  
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 
      ##### Initial state of the phones #####	 

    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
 
     ##### Phone B is Calling Phone A  #####	  
	
	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
   
	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "23: "
	wait 5000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "44.5: "
	wait 5000   

	##### Start Making a Conference Form Phone A  #####	
	
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	    expectMsgWait
		wait 1000	
 	##### Press the concerned BLF key on Phone A to call Phone C #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U10,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "80: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "81: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
   
	##### Phone C Rings for 5s Then Answers  #####	

   expectMsgWait "83: "
	wait 5000 
	expectMsgSend SUBC,Do.Hook,Hook.Off,"84: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "100: "
	wait 5000  
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"113: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	
	##### Phone A Is Leaving The Conference  #####	
	
    expectMsgWait "120: "
	wait 5000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"126: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "140: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "143: "
	wait 5000
    
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	##### Phone A Hook On /Initial state for the Phone A #####	
	
	expectMsgSend SUBA,Do.Hook,Hook.On,"144: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"147: "  ' m1s57a  ' pseudo
    expectMsgWait "147.5: "
	wait 5000   

	##### Phone B Hook On /Initial state for the Phone B #####	
	
	expectMsgSend SUBB,Do.Hook,Hook.On,"148: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    #@#expectMsgAdd SUBA,Do.KeyF10,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"162: "  ' m1s57b  ' pseudo
    expectMsgWait "164: "
    expectMsgWait "166: "
 
 	##### Phone C Hook On /Initial state for the Phone C #####	

	expectMsgSend SUBC,Do.Hook,Hook.On,"167: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"170: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '207113






#############################################################################################################

'Advanced Test 18 - Incoming call before a Conference and Incoming call after making a Conference 
'Edited by Weiling Chen
'aastra on a155-0138 the 10/17/2012 10:15:31
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 207118 
  LOCAL title="Advanced Test 18 "
      ##### configuring phones  #####	 
  
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	  
	   
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
   
     ##### Phone A is Calling Phone B  #####	  

   
    expectMsgSend SUBA,Do.Keys,SUBB.number,"10: "  ' m1s57a  ' pseudo
   
    expectMsgWait "12: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "25: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "26: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57b
    
     ##### Phone B Rings for 5s Then Answers  #####	

	expectMsgWait "27: "
	wait 5000
	expectMsgSend SUBB,Do.Hook,Hook.Off,"29: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "48: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBA.number+JOCKER  ' m1s57a
    expectMsgWait "48.5: "
	wait 5000    
		
	##### Start Making a Conference From Phone B  #####		
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveRecall  ' m1s57b
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
    
	expectMsgWait
	wait 1000
	
	##### Phone B is Calling Phone C  #####
	expectMsgSend SUBB,Do.Keys,SUBC.number,"67: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"68: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "75: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "76: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
    ##### Phone C Rings for 5s Then Answers  #####	
  
    expectMsgWait "77: "
	wait 5000    
	expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "87: "
	wait 5000   
		
		
	#### Phone D calls Phone B b4 phone B press "Conf" L2 LED should be blinking and Screen still on L1 
	
	expectMsgSend SUBD,Do.Keys,SUBB.number,"10: "  ' m1s57d  ' pseudo
    expectMsgWait "12: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57d
    expectMsgSend SUBD,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "35: "
	##@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	
	#Hook on  phone D
	expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
	expectMsgWait "25: "
	expectMsgAdd SUBB,Do.KeyL2,Key.LightOff  ' m1s57b
    
	
	##### Phone B press "Conf" to Establish a Conference between Phone A ,Phone B and Phone C #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57b  ' pseudo
	wait 1000
	##@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	expectMsgWait "25: "
	wait 5000
	
	# Phone D calls Phone B again, L2 LED should be blinking and Screen should display incoming call on L2  
	
	expectMsgSend SUBD,Do.Keys,SUBB.number,"10: "  ' m1s57d  ' pseudo
    expectMsgWait "12: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57d
    expectMsgSend SUBD,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgWait "26: "
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57b
    expectMsgWait "26: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57b
	expectMsgWait "77: "
	wait 2000    
      
    ##### Phone B answer the phone for 5s and drop the call  #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F2,"111: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgWait "87: "
	wait 5000  

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
	wait 1000
	expectMsgAdd SUBB,Do.KeyL2,Key.LightOff  ' m1s57b
	expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
	
	 ##### Phone B is going back to the line 1 #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"164: "  ' m1s57b  ' pseudo
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveRecall  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "177: "
	wait 2000
	
	##### Phone B Is Leaving The Recent Conference  #####	

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"187: "  ' m1s57b  ' pseudo
	expectMsgWait "177: "
	wait 1000
	##### Phone B Hook On /Initial state for the Phone  #####	

	expectMsgSend SUBB,Do.Hook,Hook.On,"268: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"282: "  ' m1s57b  ' pseudo
    expectMsgWait "285: "
   
	##### Phone C Hook On /Initial state for the Phone C #####	

	expectMsgSend SUBC,Do.Hook,Hook.On,"286: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"289: "  ' m1s57c  ' pseudo
	
	##### Phone A Hook On /Initial state for the Phone A #####	

    expectMsgSend SUBA,Do.Hook,Hook.On,"298: "  ' m1s57a  ' pseudo
    expectMsgWait "299: "
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"316: "  ' m1s57a  ' pseudo
    expectMsgWait "318: "
    expectMsgSend SUBD,Do.Hook,Hook.On,"319: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57d  ' pseudo
    expectMsgWait
	wait 1000
  WEND
ENDTC '207118





 
#############################################################################################################
'Verify ringing and MWI on second incoming call during Conf
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/26/2012 14:27:23
' SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)
TESTCASE 207120
  LOCAL count=0
  LOCAL title="TC 207120-Verify ringing and MWI on second incoming call during Conf"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
     REPEAT
    RECINFO "Count : "+count
    #Press GOODBYE
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 500
    #Hook ON
    expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
  
    #Press L1 on Phone B
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
    expectMsgWait
    wait 500
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
    expectMsgWait
    wait 2000
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a  
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
  
    #Phone A answers in handsfree mode
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
    expectMsgWait
    wait 1000
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait
    wait 1000

    #Phone A starts make a Conference
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"32: "  ' m1s57a  ' pseudo
    expectMsgWait
    wait 1000
 
    #Hook off Phone D to call phone A
    expectMsgSend SUBD,Do.Keys,SUBA.number,"35: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.Off ' m1s57d
    wait 1000
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive ' m1s57d
    expectMsgAdd SUBD,Do.Hook,Hook.Off ' m1s57d
    expectMsgWait
    wait 3000
   
    # Veirfy status of incoming call on Phone A
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial
    #expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait
    wait 1000
   
   #Phone A dial Phone C's number and make a Conference
    expectMsgSend SUBA,Do.Keys,SUBC.number,"42: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"44: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "46: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "48: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    wait 2000
    #Phone C answers
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"52: "  ' m1s57c  ' pseudo
    expectMsgWait
    wait 2000
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"56: "  ' m1s57a  ' pseudo
    expectMsgWait "57: "
    wait 3000
    #Phone A leaves from Conference
	#PLATFORM==1,2,3
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"60: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
		#PLATFORM==1,2,3
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"60: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    expectMsgWait "61: "
    wait 2000
    #Veirfy status of incoming call on Phone A again
  
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a  
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57a
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57a
    wait 3000
  
    #Phone A press L2 to answer the call
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"65: "  ' m1s57a  ' pseudo
    wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
  
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"70: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"74: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"75: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"76: "  ' m1s57d  ' pseudo
    expectMsgWait
    count=count+1
    UNTIL count=1
  WEND
ENDTC '207120





#############################################################################################################################################
'Verify ringing and MWI on second incoming call when a conference swtiches to unhold status.
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/24/2012 14:27:23
' SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d) 
TESTCASE 207121
  LOCAL count=0
  LOCAL title="TC 207121-Verify ringing and MWI on second incoming call when a conference swtiches to unhold status.  "
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
     REPEAT 
    RECINFO "Count : "+count 
    #Press GOODBYE
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 500
   
    #Hook ON
    expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
   
    #Press L1 on Phone B
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
    expectMsgWait
    wait 500
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
    expectMsgWait
    wait 1000   
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
    expectMsgWait
    wait 2000
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a   
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
   
    #Phone A answers in handsfree mode
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
    expectMsgWait
    wait 1000
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait
    wait 1000
   
   
    #Phone A press Conf and Dial Phone C's number
   
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
    expectMsgWait
    wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"66: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
    #Phone C answers the call after 3s
    expectMsgWait "74: "
    wait 3000
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"81: "  ' m1s57c  ' pseudo
    expectMsgWait
    wait 1000
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "92: "
    wait 3000
   
    ##### Establishing a Conference between Phone A ,Phone B and Phone C #####   
   
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"110: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "122: "
    wait 3000
   
    #Phone A put the conference on hold
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold,"26: "  ' m1s57a  ' pseudo
    wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
   
    #Phone D calls Phone A, Verify LED Lights flashing on L2
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57d  ' pseudo
    expectMsgWait
    wait 500
    expectMsgAdd SUBD,Do.KeyLoudspeaker,Key.LightActive ' m1s57d
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    expectMsgWait
    expectMsgSend SUBD,Do.Keys,SUBA.number  ' m1s57d  ' pseudo
    expectMsgWait
    wait 1000   
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57d  ' pseudo
    expectMsgWait
    wait 3000
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a   
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
    wait 3000
   
    #Phone A unhold the conference from Phone B on L1, then verify LED lights again
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
    expectMsgWait
    wait 1000
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
	expectMsgWait	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
    expectMsgWait
    wait 2000
    #Phone A leaves from the conference
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"8: "  ' m1s57a  ' pseudo
    wait 1000
	'checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a   
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
    wait 2000
   
    #Phone A press L2 to answer the call
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"8: "  ' m1s57a  ' pseudo
    wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff ' m1s57a
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	wait 3000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57d  ' pseudo
    expectMsgWait
    wait 2000
    count=count+1
    UNTIL count=1
  WEND
ENDTC '207121






##############################################################################################################################################

'Basic Test 1 - Verify that conference host can initiate, execute and complete local conference when first call is incoming call.
'Edited By Weiling Chen
'aastra on a155-0138 the 09/28/2012 10:36:56
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207201
  LOCAL title="Basic Test 1(Speaker On) "
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    
	#### Initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
    ### Phone B is calling PhoneA ###
	expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
	#PLATFORM==1,2,3
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	#ENDPLATFORM
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    'expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
     ### Ringing for 5s then phone A answer phone B ###
	expectMsgWait "23: "
	wait 5000
    #Phone A press L1 to answer the call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a

    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530" + JOCKER  ' m1s57b
	     expectMsgWait
		wait 5000
  ### Starting a conference on phone A with phone C and phoneB ###
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
	expectMsgWait
	wait 1000
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"63: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "73: "
	wait 5000
 #### phone C press L1 to answer ####	
    #expectMsgSend SUBC,Do.Hook,Hook.Off,"74: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgWait "75: "
	wait 5000  
 #### making the conference ####	
  expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "  ' m1s57a  ' pseudo
    expectMsgWait "81: "
	wait 500
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgWait "81: "
	wait 7000
	
 #### hold the conference for 7s the phones hang up ####	
    #expectMsgSend SUBB,Do.Hook,Hook.On,"91: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"23: "  ' m1s57b  ' pseudo
	expectMsgWait "81: "
	wait 1000
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b

    #expectMsgSend SUBA,Do.Hook,Hook.On,"110: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a	
    expectMsgWait "116: "
    
    
    expectMsgWait "117: "
	
    #expectMsgSend SUBA,Do.Hook,Hook.On  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"23: "  ' m1s57a  ' pseudo
	expectMsgWait "81: "
	wait 500
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    #expectMsgSend SUBC,Do.Hook,Hook.On,"124: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"23: "  ' m1s57c  ' pseudo
	expectMsgWait "81: "
	wait 500
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "133: "
    expectMsgWait "135: "
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
	 #### initial state of the phones####
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"138: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '207201







#############################################################################################################

'Basic Test 2 - Verify that conference host can initiate, execute and complete local conference when first call is outgoing call.
'Edited By Weiling Chen
'aastra on a155-0138 the 09/28/2012 11:50:22
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207202
  LOCAL title="Basic Test 2(Speaker On)"
   #### configuring phones ####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
     #### initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	 #### Phone A is calling pone B ####
   expectMsgWait 
	wait 1000  	 
	
	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"12: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"9: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a

    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
	
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    #### phone B rings for 5s then answers   ####   
   expectMsgWait "25: "
	wait 5000  
   #expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
   #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
   expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57b  ' pseudo
   expectMsgWait
   wait 500
   expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
   expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
   expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
   expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
   expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
   expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
   expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "46: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
    #### start making a conference ####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	    expectMsgWait
		wait 1000	
    
    
    #### Dialing phone C #### 
    expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
 
    #### phone C rings for 5s and then answer #### 
	 expectMsgWait "75: "
	wait 5000
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"76: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
     expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "83: "
	wait 5000  
    #### establishing the conference ####	
  expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "  ' m1s57a  ' pseudo
     expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    
    expectMsgWait ": "
	wait 7000
	#### finishing the conference/phones are hooking  on  ####
	#expectMsgSend SUBA,Do.Hook,Hook.On,"108: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"102: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"103: "  ' m1s57c  ' pseudo
		 #stone
		 expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
     expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgWait "104: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
	
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "129: "
    expectMsgWait "131: "
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    #expectMsgSend SUBC,Do.Hook,Hook.On,"136: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	#### initial state of the phones ####	
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57a  ' pseudo
    expectMsgWait
  '  expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
	
  WEND
ENDTC '207202






#############################################################################################################
'Basic Test 3 - Verify that conference host can initiate, execute and complete local conference when 2 outbound active calls are already running.
'Edited By Weiling Chen
'aastra on a155-0138 the 09/28/2012 14:17:44
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207203
  LOCAL title="Basic Test 3(Speaker On)"
   ##### Configuring the phones #####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
       ##### phone A is calling phone B #####

	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"12: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    ##### phone B rings for 5s then answers #####
	  expectMsgWait "24: "  
	  wait 5000
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"25: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "44: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
     expectMsgWait "44.5: "  
	  wait 5000    
	    ##### phone A is calling phone C from L2 #####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"46: "  ' m1s57a  ' pseudo
	expectMsgWait "50: "
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"58: "  ' m1s57a  ' pseudo
    expectMsgWait "59: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
 	    expectMsgWait
		wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "68: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "69: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    ##### phone C rings for 5s then answers  #####      
	  expectMsgWait "70: "  
	  wait 5000   
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"73: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
        
    expectMsgWait "93: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
	  expectMsgWait  
	  wait 2000        
	 ##### starting to make a conference form DUT(phone A) #####   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"94: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
  '  expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
	    expectMsgWait
		wait 3000	
        #####  conference on phone A with phone B on L1 and phone C on L2#####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"111: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "124: "  
	wait 7000
    ##### finishing the conference/phones hook on/initial state of the phones  #####	  
      # #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a   
    #expectMsgSend SUBA,Do.Hook,Hook.On,"136: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57a  ' pseudo
	expectMsgWait "98: "
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
   ' expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "149: "
   ' expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"151: "  ' m1s57a  ' pseudo
    
    
    expectMsgWait "152: "
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "164: "
	  '  'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgWait "166: "
    #expectMsgSend SUBB,Do.Hook,Hook.On,"167: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57b  ' pseudo
	expectMsgWait "98: "
	wait 1000
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"170: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.Hook,Hook.On,"171: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57c  ' pseudo
	expectMsgWait "98: "
	wait 1000
	#expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"174: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '207203






#############################################################################################################

'Advanced Test 1 - 2nd leg dropped by remote phone
'Edited By Weiling Chen
'aastra on a155-0138 the 10/01/2012 10:44:39
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207205
  LOCAL title="Advanced Test 1(Speaker On)"
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
     ##### Initial state of the phones #####	    
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	
	##### Phone B is Calling Phone A  #####	  

	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"12: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    
     ##### Phone A Rings for 5s Then Answers  #####		
	expectMsgWait "25: "
	wait 5000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"26: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
      expectMsgWait "46.5: "
   wait 5000 
   
 	##### Start Making a Conference Form Phone A  #####	  
	
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
  ' expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
   'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
   '
	    expectMsgWait
		wait 1000	
      ##### Phone A is Calling Phone C  #####	  
	  
	expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "75: "
   wait 5000    
   
   	      ##### Phone C Rings for 5s Then Answers  #####	

	#expectMsgSend SUBC,Do.Hook,Hook.Off,"77: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
     expectMsgWait "94: "
   wait 7000  
   	 ##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
  	      ##### Phone C Hangs Up #####	
 
	#expectMsgSend SUBC,Do.Hook,Hook.On,"95: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"131: "  ' m1s57c  ' pseudo
	expectMsgWait "132: "
	wait 1000
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c

    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgWait "112: "
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a (Issue: Hold but Speaker LED is still on)
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57a  ' pseudo 
	expectMsgWait "132: "
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"116: "  ' m1s57a  ' pseudo
	#expectMsgWait "133: "
	#wait 1000
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	
  ##### Phone A Hangs Up #####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"118: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
      expectMsgWait "128: "
   wait 5000     
  ##### Phone B Hangs Up #####	
	#expectMsgSend SUBB,Do.Hook,Hook.On,"129: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"131: "  ' m1s57b  ' pseudo
	expectMsgWait "132: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
	expectMsgWait "143: "
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"144: "  ' m1s57a  ' pseudo
	expectMsgWait "145: "
  WEND
ENDTC '207205






#############################################################################################################

'Advanced Test 2 - Drop & add participants
'Edited BY Weiling Chen
'aastra on a155-0138 the 10/01/2012 13:32:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 207206 
  LOCAL title="Advanced Test 2(Speaker On) "
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
      ##### Initial state of the phones #####	         
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
     ##### Phone B is Calling Phone A  #####	  
	
	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"10: "  ' m1s57b  ' pseudo
    
    expectMsgWait "12: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
   
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"13: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "25: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "26: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
     expectMsgWait
		wait 5000
     ##### Phone A Rings for 5s Then Answers  #####		
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"29: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "40: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number'SUBA.number+JOCKER  ' m1s57b
    
	     expectMsgWait
		wait 1000
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	    expectMsgWait
		wait 1000	
 	       ##### Phone A is Calling Phone C  #####	    
	expectMsgSend SUBA,Do.Keys,SUBC.number,"68: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"69: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 1000	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    
    expectMsgWait "76: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "77: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
	      ##### Phone C Rings for 5s Then Answers  #####	
	 expectMsgWait
		wait 5000   
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"81: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"80: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
	      ##### Establishing a Conference between Phone A ,Phone B and Phone C #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"85: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	expectMsgWait
		wait 5000
	      ##### Phone A drops Phone C from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"90: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    
    expectMsgWait "95: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "98: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "100: "
	      ##### Phone C Hook On /Initial state for the Phone C #####	
   
   #expectMsgSend SUBC,Do.Hook,Hook.On,"123: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"111: "  ' m1s57c  ' pseudo
	expectMsgWait "112: "
		wait 5000   

	##### Start Making Another Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"127: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    
	    expectMsgWait
		wait 1000
	##### Phone A is Calling Phone D  #####	  
	expectMsgSend SUBA,Do.Keys,SUBD.number,"145: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"146: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 1000	
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActiveBlink  ' m1s57d	
    expectMsgAdd SUBD,Do.Ringing,Ringing.Intern  ' m1s57d
    
    expectMsgWait "153: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57d
    expectMsgWait "154: "
    checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57d
    expectMsgAdd SUBD,Do.KeyMessage,Key.LightActiveBlink  ' m1s57d


     ##### Phone D Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
	#expectMsgSend SUBD,Do.Hook,Hook.Off,"157: "  ' m1s57d  ' pseudo
    #expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    #expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.F1,"156: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBD,Do.KeyLoudspeaker,Key.LightActive ' m1s57d
	expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
	expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
    expectMsgAdd SUBD,Do.Ringing,Ringing.Quiet  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		   ##### Establishing a Conference between Phone A ,Phone B and Phone D #####			
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"159: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"165: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"170: "  ' m1s57a  ' pseudo
   
   expectMsgWait
		wait 5000
	      ##### Phone A drops Phone D from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"198: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 500	
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Disconnect  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
    expectMsgWait "205: "
    expectMsgWait "206: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
  	      ##### Phone D Hook On /Initial state for the Phone D #####	  
	expectMsgSend SUBD,Do.Hook,Hook.On,"207: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
 expectMsgWait
		wait 5000  
   expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"210: "  ' m1s57d  ' pseudo
	     expectMsgWait
		wait 1000
		
	##### Start Making Another Conference Form Phone A  #####	
 expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"211: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	     expectMsgWait
		wait 3000	
	       ##### Phone A is Calling Phone E  #####	  
   
    expectMsgSend SUBA,Do.Keys,SUBE.number,"230: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"231: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 1000	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBE,Do.KeyL1,Key.LightActiveBlink  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Intern  ' m1s57e
   
    expectMsgWait "238: "
    expectTextCheck SUBE,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57e
    expectMsgWait "239: "
    checkGetStateText SUBE,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57e
    expectMsgAdd SUBE,Do.KeyMessage,Key.LightActiveBlink  ' m1s57e
    'expectMsgAdd SUBE,Do.KeyMessage,Key.LightOff  ' m1s57e
	
     ##### Phone E Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
	#expectMsgSend SUBE,Do.Hook,Hook.Off,"242: "  ' m1s57e  ' pseudo
    #expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
    #expectMsgAdd SUBE,Do.Hook,Hook.Off  ' m1s57e
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.F1,"245: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBE,Do.KeyLoudspeaker,Key.LightActive ' m1s57e
	expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
	expectMsgAdd SUBE,Do.Connected,Connected.Yes  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Quiet  ' m1s57e
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		
		      ##### Establishing a Conference between Phone A ,Phone B and Phone E #####			
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"259: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    
	expectMsgWait
	wait 5000
		
	      ##### Phone A drops Phone E from the conference  #####			

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"282: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBE,Do.KeyL1,Key.LightOff  ' m1s57e
    expectMsgAdd SUBE,Do.Connected,Connected.No  ' m1s57e
    'expectMsgAdd SUBE,Do.InbandTone,InbandTone.Disconnect  ' m1s57e
    expectMsgAdd SUBE,Do.InbandTone,InbandTone.Quiet  ' m1s57e
   
    expectMsgWait "289: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "290: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "292: "
	
	      ##### Phone E Hook On /Initial state for the Phone E #####	
    #expectMsgSend SUBE,Do.Hook,Hook.On,"293: "  ' m1s57e  ' pseudo
    #expectMsgAdd SUBE,Do.Hook,Hook.On  ' m1s57e
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"295: "  ' m1s57e  ' pseudo

 expectMsgWait
		wait 5000   
	#expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"296: "  ' m1s57e  ' pseudo
  
  #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number'SUBA.number+JOCKER  ' m1s57b
  
	      ##### Ending The Calls /Phones Hook On /Initial state of the Phones #####	
  
    #expectMsgSend SUBB,Do.Hook,Hook.On,"297: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"300: "  ' m1s57b  ' pseudo
	expectMsgWait "302: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "304: "
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"313: "  ' m1s57b  ' pseudo
    expectMsgWait "315: "
    expectMsgWait "317: "
    #expectMsgSend SUBA,Do.Hook,Hook.On,"318: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"321: "  ' m1s57a  ' pseudo
    expectMsgWait
  WEND
ENDTC '207206






##################################################################################################
'Advanced Test 7 - Speeddial/conf softkey, w/ local conf.
'Edited By Weiling Chen
'aastra on a155-0138 the 10/01/2012 10:59:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207210
	LOCAL title="Advanced Test 7(Speaker On)"
  
 		##### configuring phones  #####	 
 
	setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
     ##### Initial state of the phones #####	 
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
     ##### Phone B is Calling Phone A  #####  

	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
	
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"12: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgWait "11: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgWait "24: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgWait "27: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

 	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "28: "
	wait 5000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
 

    ##### Phone A is Dailing Phone C  Using  Speeddial/Conf Softkey #####
	expectMsgWait "47: "
	wait 5000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"48: "  ' m1s57a  ' pseudo
    expectMsgWait "48.5: "
	wait 1000  
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"48: "  ' m1s57a  ' pseudo
    expectMsgWait "48.5: "
	wait 1000  
	 expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
	expectMsgWait "55: "
	wait 1000  
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    expectMsgWait "78: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
  
	##### Phone C Rings for 5s Then Answers  #####	

	expectMsgWait "79: "
	wait 5000  
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"83: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"81: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c	
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "100: "
	wait 5000
  
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	
	##### Phone A Hook On /Initial state for the Phone A #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"118: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgWait "120: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a  
	#expectMsgSend SUBA,Do.Hook,Hook.On,"122: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"330: "  ' m1s57a ' pseudo
	expectMsgWait "122: "
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"134: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    #expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "125: "
	wait 1000
    expectMsgWait "145: "
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait "149: "
	wait 5000  

	##### Phone B Hook On /Initial state for the Phone B #####	

	#expectMsgSend SUBB,Do.Hook,Hook.On,"150: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"153: "  ' m1s57b ' pseudo
	expectMsgWait "155: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"156: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c

	##### Phone C Hook On /Initial state for the Phone C #####	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57c ' pseudo
	expectMsgWait "161: "
	wait 1000
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"163: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgWait
  WEND
ENDTC '207210






################################################################################

'Verify that you can swap calls before the conference is completed
'Edited By Weiling Chen
'aastra on a155-0138 the 10/01/2012 09:47:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207211
  LOCAL title="Advanced Test 8(Speaker On)"
  
 		##### configuring phones  #####	 
 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

     ##### Initial state of the phones #####	 
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
   
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    
	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "24: "
	wait 5000
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "44.5: "
	wait 5000

	##### Start Making a Conference Form Phone A  #####	
		
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	    expectMsgWait
		wait 1000	       
	##### Phone A is Dailing Phone C  #####

    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"66: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
	##### Phone C Rings for 5s Then Answers  #####	

	expectMsgWait "74: "
	wait 5000
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"75: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"81: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "92: "
	wait 3000
	
	##### Press line 1 to swap calls ##### 
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"93: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait "100: "
	wait 1000
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"110: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgWait "122: "
	wait 7000
	
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	

	##### Phone B Hook On /Initial state for the Phone B #####	
	
	#expectMsgSend SUBB,Do.Hook,Hook.On,"123: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"153: "  ' m1s57b ' pseudo
	expectMsgWait "155: "
	wait 1000
	
    
	##@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "126: " 
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "136: "
    
    
    expectMsgWait "137: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number'SUBC.number+JOCKER  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"138: "  ' m1s57b  ' pseudo
     expectMsgWait "139: "
	wait 5000
	
	##### Phone A Hook On /Initial state for the Phone A #####	

	#expectMsgSend SUBA,Do.Hook,Hook.On,"140: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"153: "  ' m1s57a ' pseudo
	expectMsgWait "155: "
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "154: "
    expectMsgWait "156: "
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"157: "  ' m1s57a  ' pseudo

	##### Phone C Hook On /Initial state for the Phone C #####	
    
	#expectMsgSend SUBC,Do.Hook,Hook.On,"158: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"153: "  ' m1s57c ' pseudo
	expectMsgWait "155: "
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"161: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '207211






################################################################################

'Advanced Test 9 - Using speeddial on 2nd leg
'Edited By Weiling Chen
'aastra on a155-0138 the 10/01/2012 11:04:10
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 207212
  LOCAL title="Advanced Test 9(Speaker On)"
  
  		##### configuring phones  #####	 

  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	

    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
   
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
   expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	##### Phone A Rings for 5s Then Answers  #####		      
    
	expectMsgWait "25: "
	wait 5000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"27: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
   
   
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "46.5: "
	wait 5000   
	
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	
	##### Phone A is Calling Phone C Using SpeedDial#####
 	expectMsgWait
	wait 2000    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"64: "  ' m1s57a  ' pseudo
	    expectMsgWait
		wait 2000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"65: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000  
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c

	##### Phone C Rings for 5s Then Answers  #####	
    
	expectMsgWait "75: "
	wait 5000   
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"76: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "85: "
	wait 5000   
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"93: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
       expectMsgWait "95: "
		wait 5000   
    
    
    expectMsgWait "101: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b	
	

	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	##### Phone B Hook On /Initial state for the Phone B #####	

	#expectMsgSend SUBB,Do.Hook,Hook.On,"106: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57b ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "117: "
    
    
    expectMsgWait "117.5: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "119: "
	wait 5000   
	
	##### Phone A Hook On /Initial state for the Phone A #####	
	
	#expectMsgSend SUBA,Do.Hook,Hook.On,"120: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57a ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"129: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ''expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "135: "
   
	##### Phone C Hook On /Initial state for the Phone C #####	
   
	#expectMsgSend SUBC,Do.Hook,Hook.On,"138: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57c ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '207212





###################################################################################

'Advanced Test 18 - Incoming call before a Conference and Incoming call after making a Conference 
'Edited by Weiling Chen
'aastra on a155-0138 the 10/1792012 10:15:31
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 207218
  LOCAL title="Advanced Test 18(Speaker On) "
      ##### configuring phones  #####	 
  
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	  
	   
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
   
     ##### Phone A is Calling Phone B  #####	  

   
    expectMsgSend SUBA,Do.Keys,SUBB.number,"10: "  ' m1s57a  ' pseudo
   
    expectMsgWait "12: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "25: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "26: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57b
    
     ##### Phone B Rings for 5s Then Answers  #####	

	expectMsgWait "27: "
	wait 5000
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"29: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "48: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBA.number+JOCKER  ' m1s57a
    expectMsgWait "48.5: "
	wait 5000    
		
	##### Start Making a Conference From Phone B  #####		
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveRecall  ' m1s57b
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
    
	expectMsgWait
	wait 1000
	
	##### Phone B is Calling Phone C  #####
	expectMsgSend SUBB,Do.Keys,SUBC.number,"67: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"68: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "75: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "76: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
    ##### Phone C Rings for 5s Then Answers  #####	
  
    expectMsgWait "77: "
	wait 5000    
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "87: "
	wait 5000   
		
		
	#### Phone D calls Phone B b4 phone B press "Conf" L2 LED should be blinking and Screen still on L1 
	
	expectMsgSend SUBD,Do.Keys,SUBB.number,"10: "  ' m1s57d  ' pseudo
    expectMsgWait "12: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57d
    #expectMsgSend SUBD,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    #expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.KeyLoudspeaker,Key.LightActive ' m1s57d
	expectMsgAdd SUBD,Do.KeyL1,Key.LightActive ' m1s57d
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "35: "
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	
	#phone D Press "GoodBye" 
	#expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57d  ' pseudo
	expectMsgWait "25: "
	expectMsgAdd SUBB,Do.KeyL2,Key.LightOff  ' m1s57b
    
	
	##### Phone B press "Conf" to Establish a Conference between Phone A ,Phone B and Phone C #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57b  ' pseudo
	wait 1000
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	expectMsgWait "25: "
	wait 5000
	
	# Phone D calls Phone B again, L2 LED should be blinking and Screen should display incoming call on L2  
	
	expectMsgSend SUBD,Do.Keys,SUBB.number,"10: "  ' m1s57d  ' pseudo
    expectMsgWait "12: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57d
    #expectMsgSend SUBD,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    #expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.KeyLoudspeaker,Key.LightActive ' m1s57d
	expectMsgAdd SUBD,Do.KeyL1,Key.LightActive ' m1s57d
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgWait "26: "
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57b
    expectMsgWait "26: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57b
	expectMsgWait "77: "
	wait 2000    
      
    ##### Phone B answer the phone for 5s and drop the call  #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F2,"111: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgWait "87: "
	wait 5000  

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
	wait 1000
	expectMsgAdd SUBB,Do.KeyL2,Key.LightOff  ' m1s57b
	expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
	
	 ##### Phone B is going back to the line 1 #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"164: "  ' m1s57b  ' pseudo
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveRecall  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "177: "
	wait 2000
	
	##### Phone B Is Leaving The Recent Conference  #####	

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"187: "  ' m1s57b  ' pseudo
	expectMsgWait "177: "
	wait 1000
	##### Phone B Hook On /Initial state for the Phone  #####	

	#expectMsgSend SUBB,Do.Hook,Hook.On,"268: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57b  ' pseudo
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"282: "  ' m1s57b  ' pseudo
    expectMsgWait "285: "
   
	##### Phone C Hook On /Initial state for the Phone C #####	

	#expectMsgSend SUBC,Do.Hook,Hook.On,"286: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57c  ' pseudo
	
	##### Phone A Hook On /Initial state for the Phone A #####	

    #expectMsgSend SUBA,Do.Hook,Hook.On,"298: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57a  ' pseudo
	expectMsgWait "299: "
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"316: "  ' m1s57a  ' pseudo
    expectMsgWait "318: "
    # expectMsgSend SUBD,Do.Hook,Hook.On,"319: "  ' m1s57d  ' pseudo
    #expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57d  ' pseudo
    expectMsgWait
  WEND
ENDTC '207218





 
#############################################################################################################



###########################################################
#208 Call forward and DND
#Please start with the TESTCASE 100
###########################################################


 ##############                DND is set on U5 on config xml p2                   ######################## 

 #### Intial state of the phone :
 #### --Phine A is DUT
 #### --Phone C speeddial is set in U4  on DUT
 #### --DND is set on U5 on config xml p2 


 #### --Services is set on U7 and U1 on DUT
 #### --Directory is set on U8 and U2 on DUT
 #### --Callers List is set on U9 and U3 on DUT
 #### --Phone C speeddial is set in U4  on DUT
 

 ## topsoftkey1 type : services   ## 
 ## topsoftkey1 label : Services   ## 

 ## topsoftkey2 type : directory   ## 
 ## topsoftkey2 label : Directory   ## 

 ## topsoftkey3 type : callers   ## 
 ## topsoftkey3 label : Callers List    ## 

 ## topsoftkey4 type : xml   ## 
 ## topsoftkey4 label : 3   ## 
 ## topsoftkey4 value : http://10.30.104.80:80/xml/p3.xml   ## 

 ## topsoftkey5 type : dnd   ## 
 ## topsoftkey5 label : DND   ## 


 ## softkey1 type : services   ## 
 ## softkey1 label : Services   ## 

 ## softkey2 type : directory   ## 
 ## softkey2 label : Directory   ## 

 ## softkey3 type : callers   ## 
 ## softkey3 label : Callers List    ## 

 ## softkey4 type : speeddial   ## 
 ## softkey4 label : SPD C   ## 
 ## softkey4 value : 4165551037 (SUBC.Number)   ## 

 ## softkey5 type : dnd   ## 
 ## softkey5 label : DND  ## 


###########################################################

'TC 208100- Call Forward Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 208100
  LOCAL title="TC208100-Call Fwd. Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=12

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
  WEND
ENDTC '208100






################################################################################################

TESTCASE 208102 
  RECINFO "Testcase 208102 Single call",RecFunc
  #Initializing variables
  LOCAL count=0
  #SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c) SUBD(m1s57d) SUBE(m1s57e)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"

		#Activating xml for configuring phones for CF and DND , p2.XML
		'	send SUBA,Do.PredefKeys,PredefKeys.U10
		'	send SUBB,Do.PredefKeys,PredefKeys.U10
		'	send SUBC,Do.PredefKeys,PredefKeys.U10
		'	send SUBD,Do.PredefKeys,PredefKeys.U10		
		'	send SUBE,Do.PredefKeys,PredefKeys.U10		
		wait 4000 

		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send SUBD,Do.PredefKeys,PredefKeys.No
			
			
			
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	REPEAT
	#Shows the Counter
	RECINFO "Count : "+count
		wait 2000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
			send SUBA,Do.Hook,Hook.Off
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
		wait 2000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send SUBD,Do.PredefKeys,PredefKeys.No
			
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On				
	#Increment the counter by 1
	count=count+1
	#Check the status of the counter to the desired value
	UNTIL count=2
	wait 2000
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
	
ENDTC







###########################################################

TESTCASE 208103 
  RECINFO "TESTCASE 208103 Call Forward 7 ",RecFunc
  #Initializing variables
 
  #SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c) SUBD(m1s57d) SUBE(m1s57e)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"

	## call waiting should be turned off 
		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On
			send SUBD,Do.Hook,Hook.On
		wait 3000
		#setting call forward busy on phone B 
			#Press Settings
			send SUBB,Do.PredefKeys,PredefKeys.Settings
		wait 3000
			#Call Forward Settings
			send SUBB,Do.PredefKeys,PredefKeys.Left
			expectMsgWait
			wait 800
			send SUBB,Do.PredefKeys,PredefKeys.Left
		expectMsgWait	
		wait 2000	
		
			#Select Call Forward
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 2000	
	
	
			#Call Forwards Busy
			send SUBB,Do.PredefKeys,PredefKeys.Down
			send SUBB,Do.PredefKeys,PredefKeys.Down
		
			#Clearing if there was any number before
			LOCAL count=0
			REPEAT
			RECINFO "Count"+count
			send SUBB,Do.PredefKeys,PredefKeys.U2
			wait 500
			count=count+1
			UNTIL count=10
			
			#Entering Phone D's number as CF Busy on Phone B
			send SUBB,Do.Keys,SUBD.number
		wait 4000
			
			#Call Forwards Busy
	
			send SUBB,Do.PredefKeys,PredefKeys.U6
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.U6
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 2000
			
			#Quit
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.No
		
		#Making all the lines busy on phone B
			#choosing the line
			count=0
			REPEAT
			RECINFO "Count"+count
	
		wait 2000
			IF count=0 THEN  
			send SUBA,Do.PredefKeys,PredefKeys.F1
			ENDIF
			IF count=1 THEN  
			send SUBA,Do.PredefKeys,PredefKeys.F2
			ENDIF
			
			wait 3000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
		wait 2000
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.PredefKeys,PredefKeys.U1
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
			count=count+1
			UNTIL count =2
			
			
		#Making all the lines busy on phone B
			#choosing the line
			count=0
			REPEAT
			RECINFO "Count"+count
	
		wait 2000
			#PLATFORM==1,2
			IF count=0 THEN  
			send SUBC,Do.PredefKeys,PredefKeys.F1
			ENDIF
			IF count=1 THEN  
			send SUBC,Do.PredefKeys,PredefKeys.F2
			ENDIF
			#ENDPLATFORM
			
			#PLATFORM==3
#			IF count=0 THEN  
#			send SUBC,Do.PredefKeys,PredefKeys.F1
#			ENDIF
#			IF count=1 THEN  
#			send SUBC,Do.PredefKeys,PredefKeys.F2
#			ENDIF
#			IF count=2 THEN  
#			send SUBC,Do.PredefKeys,PredefKeys.F3
#			ENDIF
			#ENDPLATFORM
			
			#PLATFORM==4
#			IF count <> 0 THEN
#				send SUBC,Do.PredefKeys,PredefKeys.Right
#			ENDIF
			#ENDPLATFORM
				
			
		wait 3000
			#Phone A call the phone B
			send SUBC,Do.Keys,SUBB.number
		wait 2000
			send SUBC,Do.PredefKeys,PredefKeys.U1
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 2000
			#Phone B answers
			send SUBB,Do.PredefKeys,PredefKeys.U1
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	expectMsgWait
	wait 2000

			count=count+1
	#PLATFORM==1,2
			UNTIL count =2
	#ENDPLATFORM 
			
	#PLATFORM==3
#			UNTIL count =3
	#ENDPLATFORM 
	
	#PLATFORM==4
#			UNTIL count =7
	#ENDPLATFORM 
    expectMsgWait "20: "	
	wait 2000
	
	
	#Call Forwarding
#PLATFORM==1,2,3	
	send SUBC,Do.PredefKeys,PredefKeys.F4
	#ENDPLATFORM 
	
	#PLATFORM==4
#	send SUBC,Do.PredefKeys,PredefKeys.Right
	#ENDPLATFORM
	wait 1000
	send SUBC,Do.Keys,SUBB.number
	wait 2000
	send SUBC,Do.PredefKeys,PredefKeys.U1	
	
	#Check the phone D ringing
	expectMsgAdd SUBD,Do.Ringing,Ringing.Yes
	expectMsgWait
	wait 2000
	# Phone D answers 
	expectMsgSend SUBD,Do.Hook,Hook.Off
	#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	expectMsgWait
	wait 7000
	#Initial state of phones
	send SUBC,Do.PredefKeys,PredefKeys.No
	send SUBD,Do.PredefKeys,PredefKeys.No	
	wait 2000
	#### Hooking on ####
	send SUBA,Do.Hook,Hook.On
	send SUBB,Do.Hook,Hook.On
	send SUBC,Do.Hook,Hook.On	
	wait 2000			
	
	#Canceling active calls on Phone B and Phone A

	#PLATFORM==1,2
	FOR j=0 TO 7  
	expectMsgSend  SUBB,Do.PredefKeys,PredefKeys.U1
	wait 1000
	NEXT 
	#ENDPLATFORM
	
	#PLATFORM==3
#	FOR j=0 TO 9  
#	expectMsgSend  SUBB,Do.PredefKeys,PredefKeys.U1
#	wait 1000
#	NEXT 
	#ENDPLATFORM
	
	#PLATFORM==4
#		FOR i=0 TO 16
#		expectMsgSend  SUBB,Do.PredefKeys,PredefKeys.U1
#		wait 1000
#	NEXT
	#ENDPLATFORM
	
	expectMsgWait
	wait 4000		
	#Check phones are disconnected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
	expectMsgWait
	wait 3000
	#Initial state of phones
	send SUBA,Do.PredefKeys,PredefKeys.No
	send SUBB,Do.PredefKeys,PredefKeys.No
	send SUBC,Do.PredefKeys,PredefKeys.No
	send SUBD,Do.PredefKeys,PredefKeys.No	
	wait 7000
	#Initial state of phones
	send SUBC,Do.PredefKeys,PredefKeys.No
	send SUBD,Do.PredefKeys,PredefKeys.No	
	wait 2000
	#### Hooking on ####
	send SUBA,Do.Hook,Hook.On
	send SUBB,Do.Hook,Hook.On
	send SUBC,Do.Hook,Hook.On					
	wait 3000
	#setting call forward back to default
	wait 2000
	#Press Settings
	send SUBB,Do.PredefKeys,PredefKeys.Settings
	wait 3000
	#Call Forward Settings
	send SUBB,Do.PredefKeys,PredefKeys.Left
	wait 1000
	send SUBB,Do.PredefKeys,PredefKeys.Left
	wait 1000
	send SUBB,Do.PredefKeys,PredefKeys.U1
	wait 2000	
	#Set All Call Forwards off
	send SUBB,Do.PredefKeys,PredefKeys.Down
	send SUBB,Do.PredefKeys,PredefKeys.Down
	send SUBB,Do.PredefKeys,PredefKeys.Down
	send SUBB,Do.PredefKeys,PredefKeys.U6
	wait 2000
	send SUBB,Do.PredefKeys,PredefKeys.U1
	wait 2000
	
	#Quit
	send SUBB,Do.PredefKeys,PredefKeys.U4
	wait 2000
	send SUBB,Do.PredefKeys,PredefKeys.No
			
			
	wait 3000
	#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No


			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On		
	
ENDTC







###########################################################

TESTCASE 208104 
  RECINFO "TESTCASE 208104 Call Forward 8 ",RecFunc
  #Initializing variables
  
  #SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c) SUBD(m1s57d) SUBE(m1s57e)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"

	
	## Voice Mail should be turned off 
		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On						
		wait 3000
		#setting call forward No Answer on phone B 
		wait 2000
			#Press Settings
			send SUBB,Do.PredefKeys,PredefKeys.Settings
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 800
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 2000
			#Call Forward Settings
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			
			#Call Forwards No Answer
			
			count=0
			REPEAT
			send SUBB,Do.PredefKeys,PredefKeys.Down
			wait 1000
			count=count+1
			UNTIL count=4
			
			#Clearing if there was any number before
			LOCAL count=0
			REPEAT
			RECINFO "Count"+count
			send SUBB,Do.PredefKeys,PredefKeys.U2
			wait 500
			count=count+1
			UNTIL count=10
			#Entering Phone D's number as CF Busy on Phone B
			send SUBB,Do.Keys,SUBD.number
		wait 4000
			#Number of Rings 4 times
			send SUBB,Do.PredefKeys,PredefKeys.Down
			count=0
			REPEAT
			send SUBB,Do.PredefKeys,PredefKeys.Left
			wait 500
			count=count+1
			UNTIL count=5
			
			count=0
			REPEAT
			send SUBB,Do.PredefKeys,PredefKeys.Right
			wait 500
			count=count+1
			UNTIL count=3
			
			
			expectMsgWait "20:"
			wait 1500
			
			send SUBB,Do.PredefKeys,PredefKeys.Down
			#Select Call Forward On
			send SUBB,Do.PredefKeys,PredefKeys.U6
			
			#Quit
			send SUBB,Do.PredefKeys,PredefKeys.U1
			wait 1000
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.No
	
		wait 3000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
		wait 1000
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#Check the phone B ringing
			waitTill SUBB,Do.Ringing,Ringing.Yes
		wait 11000
			#Check the phone D ringing
			waitTill SUBD,Do.Ringing,Ringing.Yes
		wait 3000
			# Phone D answers 
			send SUBD,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a

    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	expectMsgWait
		wait 7000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On					
			
wait 3000

		#setting call forward No Answer back to Defaults
			#Press Settings
			send SUBB,Do.PredefKeys,PredefKeys.Settings
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 800
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 2000
			#Call Forward Settings
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			
			#Call Forwards No Answer
			
		count=0
			REPEAT
			RECINFO "Count"+count
			wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.Down
			count=count+1
			UNTIL count=5
			
			#Number of Rings 4 times
			
			send SUBB,Do.PredefKeys,PredefKeys.Left
			send SUBB,Do.PredefKeys,PredefKeys.Down
			
			#Select Call Forward Off
			send SUBB,Do.PredefKeys,PredefKeys.U6
			
			#Quit
			send SUBB,Do.PredefKeys,PredefKeys.U1
			wait 1000
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.No

		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No

	wait 2000
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On		
	
ENDTC







###########################################################
###########################################################

TESTCASE 208105 
  RECINFO "TESTCASE 208105 Call Forward 9 ",RecFunc
  #Initializing variables
  LOCAL count=0
  #SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c) SUBD(m1s57d) SUBE(m1s57e)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"

		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On					
		wait 3000
		#setting call forward ALL on phone B 
		wait 2000
			#Press Settings
			send SUBB,Do.PredefKeys,PredefKeys.Settings
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 800
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 2000
			#Call Forward Settings
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 2000	
			
			#Clearing if there was any number before
			LOCAL count=0
			REPEAT
			RECINFO "Count"+count
			send SUBB,Do.PredefKeys,PredefKeys.U2
			wait 2000
			count=count+1
			UNTIL count=10
			#Entering Phone D's number as CF Busy on Phone B
			send SUBB,Do.Keys,SUBD.number
		wait 4000

			#Setting Call Forward All On
			send SUBB,Do.PredefKeys,PredefKeys.Down
			send SUBB,Do.PredefKeys,PredefKeys.U6
		wait 2000
		
			#Quit
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 800
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.No
	
		wait 3000
			#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
		wait 1000
			send SUBA,Do.PredefKeys,PredefKeys.U1
			#Check the phone B not ringing
			waitTill SUBB,Do.Ringing,Ringing.Quiet
			#Check the phone D ringing
			waitTill SUBD,Do.Ringing,Ringing.Yes
		wait 3000
			# Phone D answers 
			send SUBD,Do.Hook,Hook.Off
			#Check phones are connected
    expectMsgWait			
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a

    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	expectMsgWait
		wait 3000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No	
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On					
		wait 3000
		
		#setting call forward back to default
		wait 2000
			#Press Settings
			send SUBB,Do.PredefKeys,PredefKeys.Settings
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 800
			send SUBB,Do.PredefKeys,PredefKeys.Left
		wait 2000
			#Call Forward Settings
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 2000	

			#Setting Call Forward All On
			send SUBB,Do.PredefKeys,PredefKeys.Down
			send SUBB,Do.PredefKeys,PredefKeys.U6
		wait 2000
		
			#Quit
			send SUBB,Do.PredefKeys,PredefKeys.U1
		wait 800
			send SUBB,Do.PredefKeys,PredefKeys.U4
		wait 2000
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 5000
		
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			send SUBD,Do.PredefKeys,PredefKeys.No

	wait 2000
			wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On		
	
ENDTC








###########################################################

TESTCASE 208106   
  RECINFO "TESTCASE 208106   DND Test 6 ",RecFunc
  #Initializing variables
  LOCAL count=0
  #SUBA(m1s57a)  SUBBB(m1s57b)  SUBC(m1s57c) SUBD(m1s57d) SUBE(m1s57e)
		setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"


	# DND Key is set as U5 on Phone B from Web UI
		#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send SUBD,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On					
		wait 3000
			#Activate DND 
			#send SUBB,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U10
		wait 3000

	#Phone A call the phone B
			send SUBA,Do.Keys,SUBB.number
		wait 1000
			send SUBA,Do.PredefKeys,PredefKeys.U1
		wait 2000			
			#Check the phone B not ringing
			expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet
			#Check phones are not connected
    expectMsgWait			
    #PLATFORM==1,2,4
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	#ENDPLATFORM
    
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b


	expectMsgWait
		wait 7000
			#Initial state of phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
		wait 5000
	
	#Phone C call the phone B
			send SUBC,Do.Keys,SUBB.number
		wait 1000
			send SUBC,Do.PredefKeys,PredefKeys.U1
		wait 2000
			#Check the phone B not ringing
			waitTill SUBB,Do.Ringing,Ringing.Quiet
			#Check phones are not connected
    expectMsgWait			
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #PLATFORM==1,2,4
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	#ENDPLATFORM
    
	expectMsgWait
		wait 7000
			#Initial state of phones
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
		wait 2000
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			send SUBD,Do.Hook,Hook.On					
		wait 3000
			#Deactivating DND 
			#send SUBB,Do.PredefKeys,PredefKeys.U1
			send SUBB,Do.PredefKeys,PredefKeys.U10
		wait 3000
			
			#Initializing phones
			send SUBA,Do.PredefKeys,PredefKeys.No
			send SUBB,Do.PredefKeys,PredefKeys.No
			send SUBC,Do.PredefKeys,PredefKeys.No
			#send SUBD,Do.PredefKeys,PredefKeys.No
			wait 2000
			
			#### Hooking on ####
			send SUBA,Do.Hook,Hook.On
			send SUBB,Do.Hook,Hook.On
			send SUBC,Do.Hook,Hook.On		
			#send SUBD,Do.Hook,Hook.On		
	
ENDTC






################################################################################################

'TC 209100- Call Forward AFE Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 209100
  LOCAL title="TC209100-Call Fwd. AFE Configuration"
  LOCAL count=0
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
	
	REPEAT
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count=count+1	
	
	UNTIL count=13
	expectMsgWait
	wait 2000
	
		
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
  WEND
ENDTC '209100






################################################################################################################################################

## 211_PARK/PICKUP

################################################################################################

'TC 211100- Park/Pickup Configuration
'
'aastra on A155-0389 the 03/16/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 211100
  LOCAL title="TC211100-Park/Pickup Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
	
	#expectMsgSend SUBA,Do.Keys,"10"
	#expectMsgSend SUBB,Do.Keys,"10"
	#expectMsgSend SUBC,Do.Keys,"10"
	#expectMsgSend SUBD,Do.Keys,"10"
	#expectMsgSend SUBE,Do.Keys,"10"
	#expectMsgWait
	#wait 2000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=14

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
  WEND
ENDTC '211100






####################################################################################################
###################################################################################################

## 236_Xfer_LIVE_DIAL_BROADSOFT 

###################################################################################################

'TC 236100- Xfer_Live_Dial Configuration 
'Edited By Weiling Chen
'aastra on A155-0389 the 10/11/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 236100
  LOCAL title="TC236100-Xfer Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 500
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=19

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 500
  WEND
ENDTC '236100







####################################################################################################

'B CALLS A, A XFERS B TO C 
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 14:27:23
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236101
  LOCAL count=0
  LOCAL title="TC236101-B CALLS A, A XFERS B TO C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 	REPEAT  
	RECINFO "Count : "+count  
	#Press GOODBYE
    pressPredefKey SUBA,PredefKeys.No  ' m1s57a  ' pseudo
    pressPredefKey SUBB,PredefKeys.No  ' m1s57b  ' pseudo
    pressPredefKey SUBC,PredefKeys.No  ' m1s57c  ' pseudo
    pressPredefKey SUBD,PredefKeys.No  ' m1s57d  ' pseudo
    wait 500
	
	#Hook ON
	send SUBA,Do.Hook,Hook.On  ' m1s57a  ' pseudo
    send SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
    send SUBC,Do.Hook,Hook.On  ' m1s57c  ' pseudo
    send SUBD,Do.Hook,Hook.On  ' m1s57d  ' pseudo
	wait 500
	
	#Hook Off Phone B
    send SUBB,Do.Hook,Hook.Off  ' m1s57b  ' pseudo
    waitTill SUBB,Do.Hook,Hook.Off  ' m1s57b
    waitTill SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    send SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo  
	pressPredefKey SUBB,PredefKeys.U1 	
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    waitTill SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#waitTill SUBA,Do.Ringing,Ringing.Yes  ' m1s57a  
	waitTill SUBA,Do.Ringing,Ringing.Yes  ' m1s57a  
	RECINFO "1:" 
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Hook Off Phone A
	send SUBA,Do.Hook,Hook.Off  ' m1s57a  ' pseudo
    waitTill SUBA,Do.Hook,Hook.Off  ' m1s57a
    waitTill SUBA,Do.Connected,Connected.Yes  ' m1s57a
    waitTill SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    waitTill SUBB,Do.Connected,Connected.Yes  ' m1s57b
    waitTill SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b 
	RECINFO	"2:"
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    wait 1000
	
	#Press XFER
	pressPredefKey SUBA,PredefKeys.U3  ' m1s57a  ' pseudo
	wait 500	
	#@#waitTill SUBA,Do.Connected,Connected.Yes    ' m1s57a
	waitTill SUBA,Do.Connected,Connected.Yes  ' m1s57a
	waitTill SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	waitTill SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgWait "15: "
	wait 1000	
    
	#Dial Phone C's number
	send SUBA,Do.Keys,SUBC.number  ' m1s57a  ' pseudo
    pressPredefKey SUBA,PredefKeys.U1  ' m1s57a  ' pseudo
	expectMsgWait
	wait 2000
	'waitTill SUBA,Do.Connected,Connected.Yes    ' m1s57a 
	RECINFO"3:"
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a   
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a 
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"4165142532"+JOCKER  ' m1s57a
    wait 1000
	
	#Press xfer
	pressPredefKey SUBA,PredefKeys.U4  ' m1s57a  
	RECINFO "4:"' pseudo 
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    waitTill SUBA,Do.Connected,Connected.No  ' m1s57a
    #waitTill SUBA,Do.InbandTone,InbandTone.Disconnect 
	RECINFO "5:" ' m1s57a    
    #expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    waitTill SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    waitTill SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
   
	#hook off Phone C
	send SUBC,Do.Hook,Hook.Off  ' m1s57c  ' pseudo
    waitTill SUBC,Do.Hook,Hook.Off  ' m1s57c
    waitTill SUBC,Do.Connected,Connected.Yes  ' m1s57c
    waitTill SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	wait 1000
	
	#HOOK ON PHONE C
    send SUBC,Do.Hook,Hook.On  ' m1s57c  ' pseudo
    waitTill SUBC,Do.Hook,Hook.On  ' m1s57c
    waitTill SUBB,Do.Connected,Connected.No  ' m1s57b
    #waitTill SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    waitTill SUBC,Do.Connected,Connected.No  ' m1s57c
    waitTill SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b    
    send SUBA,Do.Hook,Hook.On  ' m1s57a  ' pseudo
    waitTill SUBA,Do.Hook,Hook.On  ' m1s57a
    send SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
    waitTill SUBB,Do.Hook,Hook.On  ' m1s57b
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236101







##############################################################################################

'TC236102-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 14:25:03
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236102 
  LOCAL count=0
  LOCAL title="TC236102-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 500
	#Hook Off Phone B to Call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"6: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "13: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    #Check if Phone A is ringing
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
	#Check the display of Phone A
    expectMsgWait "16: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "17: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 500
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"18: "  ' m1s57a  ' pseudo
    #Check if Phone A and Phone B are connected
	expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    #Check display on Phone B
	expectMsgWait "25: "
	##@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"26: "  ' m1s57a  ' pseudo
	wait 500
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive' m1s57b
	expectMsgWait
    
    #Dial Phone C number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"29: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"26: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 2000
	'expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    #expectMsgWait "31: "
    #Check Phone A's display  
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
	
	expectMsgWait "32: "
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    wait 1000
	#Press Xfer to finish Blind Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"33: "  ' m1s57a  ' pseudo
    
	#Check display on Phone A
	expectMsgWait "34: "
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "35: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	#Check if Phone A is not connected anymore
	wait 500
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #Check If Phone C is ringing
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
	#Check display on Phone C
	expectMsgWait "39: "
   #expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57c
    expectMsgWait "40: "
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #expectMsgWait "41: "
	#Check display on Phone A
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	#Hook Off Phone C
    expectMsgSend SUBC,Do.Hook,Hook.Off,"45: "  ' m1s57c  ' pseudo
    #Check if Phone C and Phone B is connected
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgSend SUBA,Do.Hook,Hook.On,"50: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait "57: "    	
    wait 2000
	#Finish the call between B and C
	expectMsgSend SUBB,Do.Hook,Hook.On,"53: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	#expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
  
    expectMsgSend SUBC,Do.Hook,Hook.On,"64: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #expectMsgWait
	count=count+1 
	UNTIL count=1
   WEND
	
ENDTC '236102






##############################################################################################################################
'TC236103-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 15:31:17
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236103
  LOCAL count=0
  LOCAL title="TC236103-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
    #Press Good bye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "14: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "17: "
	#Check display On Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "18: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	#Check if A and B are connected
	expectMsgSend SUBA,Do.Hook,Hook.Off,"19: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "26: "
    ##@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"27: "  ' m1s57a  ' pseudo
    wait 500
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
    
    wait 1000
	expectMsgSend SUBA,Do.Keys,SUBC.number,"30: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"26: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 2000
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#expectMsgWait "32: "
    #Check Phone A display
	##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "33: "
	#Press Dial
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"34: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
	#Check Phone C's display
    expectMsgWait "36: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"38: "  ' m1s57a  ' pseudo
    
    #Check display on Phone C
	expectMsgWait "39: "
	wait 500
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    ###expectTextCheck SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "40: "
    #checkGetStateText SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    #Check if Phone A is disconnected
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
	#Check Phone A's display	
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check display of Phone C again
	expectMsgWait "49: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "50: "
    #checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
	wait 2000
    #Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"54: "  ' m1s57c  ' pseudo
    #Check if B and C Are connected
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgWait 
	wait 2000	
	expectMsgSend SUBB,Do.Hook,Hook.On,"59: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "69: "    
	expectMsgSend SUBC,Do.Hook,Hook.On,"72: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"75: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"76: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"77: "  ' m1s57a  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236103






##############################################################################################################################

'TC236104-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 16:08:50
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236104
  LOCAL count=0
  LOCAL title="TC236104-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hoon On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "15: "
    #Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	#Check Phone A's display
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 2000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "27: "
    #expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+"^C"+SUBA.number+JOCKER  ' m1s57b
    wait 2000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
	wait 500
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a

    
    #Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"34: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 2000
    expectMsgWait "35: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #Check display on Phone A
	#expectMsgWait "33: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    
	expectMsgWait
	#Press dial
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"35: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check Phone C's display
	expectMsgWait "37: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "38: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	expectMsgSend SUBC,Do.Hook,Hook.Off,"39: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgWait "40: "
    wait 4000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
    
    expectMsgWait "46: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "47: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    ##expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "50: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
    wait 2000
    expectMsgSend SUBB,Do.Hook,Hook.On,"54: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    
    
    expectMsgWait "57: "    
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ##expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgSend SUBC,Do.Hook,Hook.On,"63: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"71: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"72: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"74: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236104






#####################################################################################################

'TC236105-SPEEDDIAL/XFER
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 10:01:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236105
  LOCAL count=0
  LOCAL title="TC236105-SPEEDDIAL/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    wait 1000
	#Press More
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"12: "  ' m1s57a  ' pseudo
	wait 1000	   
	#Press U3-Speeddial/xfer with Phone B's number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"13: "  ' m1s57a  ' pseudo
    
	
    expectMsgWait "14: "
    #Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    
    expectMsgWait "17: "
    
	#Check display on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "18: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 2000
	
	#Hook Off Phone B 
	expectMsgSend SUBB,Do.Hook,Hook.Off,"19: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
   
   
    
    expectMsgWait "26: "

    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 2000
	expectMsgSend SUBB,Do.Hook,Hook.On,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "35: "

    expectMsgSend SUBA,Do.Hook,Hook.On,"38: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"41: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    
    expectMsgSend SUBC,Do.Keys,SUBA.number,"47: "  ' m1s57c  ' pseudo
    
    expectMsgWait "48: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
    expectMsgWait "51: "
    
	#Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "52: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    wait 2000
	
	expectMsgSend SUBA,Do.Hook,Hook.Off,"53: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    
    
    expectMsgWait "60: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"61: "  ' m1s57a  ' pseudo
    wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "65: "
    
	#Check display on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "67: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    expectMsgWait "68: "
    ##@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 2000
	
    expectMsgSend SUBB,Do.Hook,Hook.Off,"72: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgSend SUBA,Do.Hook,Hook.On,"77: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	wait 2000
	expectMsgSend SUBB,Do.Hook,Hook.On,"80: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait "84: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ##expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgWait "90: "
	
    expectMsgWait "92: "
	
    expectMsgSend SUBC,Do.Hook,Hook.On,"93: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"96: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"98: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236105






###############################################################################################

'TC236106-BLF/XFER
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 11:41:11
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236106
  LOCAL count=0
  LOCAL title="TC236106-BLF/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#HOOK ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57c  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    wait 1000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	wait 1000
	
	#Press More on Phone A
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"13: "  ' m1s57a  ' pseudo
    #expectMsgWait
	#wait 1000
	
	#Press U12- BLF/XFER with Phone B's number
	#stone
			#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
	#PLATFORM==2,4
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    expectMsgWait "15: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    
    
	#Check Display of Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgWait "24: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    #expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	expectMsgWait "23: "
	wait 2000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "46: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 2000
	
	#Hook On Phone B to end the Call
	expectMsgSend SUBB,Do.Hook,Hook.On,"47: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgSend SUBA,Do.Hook,Hook.On,"53: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    ##expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "62: "
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    
	#Hook Off Phone C to call Phone A
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgSend SUBC,Do.Hook,Hook.Off,"67: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    
    expectMsgSend SUBC,Do.Keys,SUBA.number,"74: "  ' m1s57c  ' pseudo
	 expectMsgWait "75: "
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "75: "
	wait 2000
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "83: "
    
	#Check display of Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "84: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    wait 2000
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"86: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a  
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a    
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    
    
    expectMsgWait "106: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000

	#Press More on Phone A
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"107: "  ' m1s57a  ' pseudo
    #wait 1000
	
	#Press U12 - BLF/XFER with Phone B's number  
	#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
	#PLATFORM==2,4
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    
	#Check display obn Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    #Check F1 key LED
	#@#expectMsgAdd SUBA,Do.KeyF1,Key.LightActiveBlink  ' m1s57a
  

	expectMsgWait
	wait 2000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"171: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBA,Do.KeyF4,Key.LightOff ' m1s57a
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "207: "
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    wait 2000

	#Hook On Phone B
    expectMsgSend SUBB,Do.Hook,Hook.On,"228: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF4,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   # #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "244: "
    expectMsgSend SUBC,Do.Hook,Hook.On,"247: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.Hook,Hook.On,"250: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"253: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"254: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"255: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	
	count=count+1 
	UNTIL count=1
  WEND

ENDTC '236106






#########################################################################################
'TC236107-Xfer with 2 outbound active calls
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 09:54:46
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236107 
  LOCAL count=0
  LOCAL title="TC236107-Xfer with 2 outbound active calls"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"7: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"8: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"9: "  ' m1s57d  ' pseudo
    
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"10: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
   
    #Dial Phone B's number
	expectMsgSend SUBA,Do.Keys,SUBB.number,"17: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "26: "
    
	#Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "27: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Hook off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"29: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b     
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b  
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a   
    expectMsgWait "49: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
	wait 5000
	
	#Press L2 on Phone A
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"192: "  ' m1s57a  ' pseudo 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57b     
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a  
	wait 1000
	
	#Type Phone C's number
    expectMsgSend SUBA,Do.Keys,SUBC.number,"159: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1    
    expectMsgWait "160: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c  
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c    
    expectMsgWait "168: "
	
	#Check Phone C's display
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "169: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "171: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	wait 2000
	
	#Hook Off Phone C
    expectMsgSend SUBC,Do.Hook,Hook.Off,"173: "  ' m1s57c  ' pseudo       
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a 
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	#stone
	expectMsgWait
    wait 5000
	
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"192: "  ' m1s57a  ' pseudo 
	expectMsgWait
	wait 2000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a  
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a   
    expectMsgWait "217: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer on L1 of Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"218: "  ' m1s57a  ' pseudo
    expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a 
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a

	#@###expectTextCheck SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a	
    expectMsgWait "246: "    
	wait 3000
	
	#Press L2
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"192: "  ' m1s57a  ' pseudo 
	expectMsgWait
	wait 3000
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    # expectMsgWait "320: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a   
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "387: "
	wait 1000   
    expectMsgSend SUBA,Do.Hook,Hook.On,"388: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    wait 2000
	
	#Hook On Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"391: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "408: "
    expectMsgSend SUBC,Do.Hook,Hook.On,"411: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236107






##########################################################################################################

'TC236109-Cancel Xfer while connected
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 13:22:19
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236109
  LOCAL count=0
  LOCAL title="TC236109-Cancel Xfer while connected"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo   
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a    
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a    
    expectMsgWait "18: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 2000
	
	#Hook Off Phone A
    expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "27: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	wait 2000
    
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
	wait 1000
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
 
    expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"28: "  ' m1s57a  ' pseudo
    expectMsgWait "33: "
	#@3expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a	
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a  
    #expectMsgWait "34: "
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "36: "
   
	#Check display on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "39: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"40: "  ' m1s57c  ' pseudo
	expectMsgWait "51: "
	wait 1000
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@3expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"46: "  ' m1s57a  ' pseudo    
    expectMsgWait "47: "

	#Check display on Phone A
	##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #expectMsgWait "48: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgWait "51: "
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "54: "
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	wait 2000
	
	#Hook On Phone C
    expectMsgSend SUBC,Do.Hook,Hook.On,"55: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b   
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "63: "   
    expectMsgWait "65: "   
    expectMsgSend SUBB,Do.Hook,Hook.On,"66: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBA,Do.Hook,Hook.On,"69: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236109






###############################################################################################

'TC236112- Xfer call after dialing a wrong number
'Edited BY Weiling Chen
'pvaastra on bos-bgalasso the 10/11/2012 16:31:18
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236112
 LOCAL count=0
  LOCAL title="TC236112- Xfer call after dialing a wrong number"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    
	#Hook Off Phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo    
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "19: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "20: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 1000
	
	#Hook Off Phone A
    expectMsgSend SUBA,Do.Hook,Hook.Off,"21: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "28: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
	#Press Xfer to dial the wrong number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57a  ' pseudo
	wait 1000
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a

    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Keys,"1231431","34: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "36: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57a  ' pseudo
    expectMsgWait "41: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom"+JOCKER  ' m1s57a
    
	#Wait until the Phone A comes back to hold
	#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	wait 4000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "43: "
	#expectMsgAdd SUBA,Do.Connected,Connected.Hold  ' m1s57a   
    #expectMsgWait
	'##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"1231431"+JOCKER  ' m1s57a  3.3.1.80 BUG - Wrong Number Is Cleared From Screen. Uncomment When Fixed
    expectMsgWait "44: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
	wait 1000
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
    expectMsgSend SUBA,Do.Keys,SUBC.number,"48: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"28: "  ' m1s57a  ' pseudo
    expectMsgWait "36: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a  
    '##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    'expectMsgWait "51: "
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"52: "  ' m1s57a  ' pseudo
    expectMsgWait "55: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a  
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgWait "56: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c  
    expectMsgWait "58: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "59: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "61: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a 
    wait 1000
	
	#Hook Off Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off,"62: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	wait 2000
	
	#Press xfer to finish the xfer between A and C
	expectMsgWait "69: "
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"68: "  ' m1s57a  ' pseudo
    
    #expectMsgWait "69: "
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "70: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "70: "
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    expectMsgWait "73: "   
    expectMsgWait "76: "  
    expectMsgSend SUBB,Do.Hook,Hook.On,"77: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "81: " 
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c      
    expectMsgWait "87: "    
    expectMsgWait "89: " 
    expectMsgSend SUBC,Do.Hook,Hook.On,"90: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBA,Do.Hook,Hook.On,"93: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236112





#################################################################################################
'TC236113-Consultative xfer on L2 when L1 is on HOLD
'
'aastra on A155-0389 the 03/13/2012 10:17:02
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 236113
  LOCAL count=0
  #Count for the number of xfer's on L2
  LOCAL count2=0  
  LOCAL title="TC236113-Consultative xfer on L2 when L1 is on HOLD"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
  REPEAT  
	RECINFO "Count : "+count	
	#'Press goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	#Hook On 
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 1000
	
	#Hook Off Phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"10: "  ' m1s57b  ' pseudo
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgSend SUBB,Do.Keys,SUBA.number,"17: "  ' m1s57b  ' pseudo
    expectMsgWait "18: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"19: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF4,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "35: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "36: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgWait
	wait 2000
	
	#Hook Off Phone A to recieve a call from Phone B on L1
	expectMsgSend SUBA,Do.Hook,Hook.Off,"39: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "58: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	
	REPEAT  
	RECINFO "Count2 : "+count2
    expectMsgWait
	wait 2000
		
	#Hook Off Phone C to call Phone A on L2
	expectMsgSend SUBC,Do.Hook,Hook.Off,"59: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.Keys,SUBA.number,"66: "  ' m1s57c  ' pseudo
    expectMsgWait "67: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"68: "  ' m1s57c  ' pseudo
	wait 1000
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    #expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "86: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "87: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgWait
	wait 2000
	
	#Press L2 on Phone A to pick up the call from Phone C
	expectMsgSend SUBA,Do.KeyL2,Key.Click,"88: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	#expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "112: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait
	wait 2000
	
	#Press Xfer on Phone A to Xfer Phone C to Phone D
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"113: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgWait
	wait 2000
	
	expectMsgSend SUBA,Do.Keys,SUBD.number,"125: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1  
    expectMsgWait "126: "
	wait 2000
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    '##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57a
    expectMsgWait
	wait 3000
	
    ##expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBD,Do.KeyL1,Key.LightActiveBlink  ' m1s57d
    #expectMsgAdd SUBD,Do.Ringing,Ringing.Yes  ' m1s57d
    expectMsgWait "135: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57d
    checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57d
    expectMsgAdd SUBD,Do.KeyMessage,Key.LightActiveBlink  ' m1s57d
    expectMsgWait
	wait 3000
	
	#Hook Off Phone D 
	expectMsgSend SUBD,Do.Hook,Hook.Off,"139: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 2000
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBD,Do.Ringing,Ringing.Quiet  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgWait
	wait 2000
	
	#Press Xfer to finish the consultative Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"156: "  ' m1s57a  ' pseudo
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	expectMsgWait
	wait 1000
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgWait "303: "
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "304: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bade1002"+JOCKER  ' m1s57a
	expectMsgWait
	wait 3000
	
	#Hook ON Phone C to finish the call with Phone D
	expectMsgSend SUBC,Do.Hook,Hook.On,"315: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    expectMsgSend SUBD,Do.Hook,Hook.On
	expectMsgAdd SUBD,Do.Hook,Hook.On 
	count2=count2+1 
	UNTIL count2=3
	
	#Press L1 to Pickup  the call with Phone A
    expectMsgSend SUBA,Do.KeyL1,Key.Click,"322: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait
	wait 3000
	
	#Hook ON Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"333: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgWait "336: "
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBD,Do.Hook,Hook.On,"352: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgSend SUBA,Do.Hook,Hook.On,"355: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236113






############################################################################################################
'TC236115- Consecutive Xfer 
'Edited by Weiling Chen 
'pvaastra on bos-bgalasso the 10/11/2012 16:31:18
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236115
 LOCAL count=0
  LOCAL title="New Testcase - TC236115 - Consecutive Xfer calls"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    
	#Hook Off Phone B to call Phone C
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
	expectMsgWait "9: "
	wait 1000
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgSend SUBB,Do.Keys,SUBC.number,"14: "  ' m1s57b  ' pseudo    
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"17: "  ' m1s57b  ' pseudo
	expectMsgWait "18: "
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c   
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "21: "
	
	#Check display on Phone C
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "22: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
	wait 1000
	
	#Hook Off Phone C
    expectMsgSend SUBC,Do.Hook,Hook.Off,"24: "  ' m1s57c  ' pseudo
	expectMsgWait "9: "
	wait 1000
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "28: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57b
    wait 1000
	
	#Press Xfer to dial the phone A number
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57c  ' pseudo
	wait 1000
	expectMsgAdd SUBC,Do.Connected,Connected.Yes    ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
	
    expectMsgWait "33: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"FN2531 LN2531"+JOCKER  ' m1s57a
    expectMsgSend SUBC,Do.Keys,SUBA.number,"34: "  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"28: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgWait "36: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DFN2531 LN2531"+JOCKER  ' m1s57a
	wait 3000

	#@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	
	#Hook off phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"53: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	
	
	#Check the display on phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a 
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a 	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgWait "51: "
	wait 2000
	
	
	#phone C press Xfer to phone A
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U2,"58: "  ' m1s57c  ' pseudo
	expectMsgWait "59: "
	wait 500
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57c
    expectMsgWait "61: "
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	
	expectMsgSend SUBC,Do.Hook,Hook.On,"63: "  ' m1s57c  ' pseudo
	expectMsgWait "62: "
	wait 1000
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	
	
	#Phone D is calling phone C, phone C picks up 
	expectMsgSend SUBD,Do.Hook,Hook.Off,"64: "  ' m1s57d  ' pseudo
	wait 500
	expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
	expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
	expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    expectMsgSend SUBD,Do.Keys,SUBC.number,"67: "  ' m1s57d  ' pseudo    
    expectMsgWait "68: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57d
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"70: "  ' m1s57d  ' pseudo
	expectMsgWait "71: "
	wait 1000
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c   
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "74: "
	wait 3000
	#Phone C answer the call after ringing for 3s
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"76: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.Off,"64: "  ' m1s57c  ' pseudo
	wait 1000
	expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgWait "79: "
	expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d

	#Check display on Phone C
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57c
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57c
	expectMsgWait "83: "
	wait 2000

	#C Xfer phone D to phone B
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"85: "  ' m1s57c  ' pseudo
	expectMsgWait "82: "
	wait 1000
	expectMsgAdd SUBC,Do.Connected,Connected.Yes    ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
	
	#expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"86: "  ' m1s57a  ' pseudo
	expectMsgSend SUBC,Do.Keys,SUBB.number,"34: "  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"28: "  ' m1s57c  ' pseudo
	expectMsgWait "87: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	'expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	
	#Phone B picks up the call on Line 2
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F2,"86: "  ' m1s57b  ' pseudo
	expectMsgWait "90: "
	wait 2000
	expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
	
	#Phone C Press Xfer
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U2,"86: "  ' m1s57c  ' pseudo
	expectMsgWait "90: "
	wait 500
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57c
	expectMsgWait "88: "
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	'expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	'expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
	expectMsgWait "94: "
    wait 2000
	
	#Hook on the phone A,B,C and D
	expectMsgSend SUBA,Do.Hook,Hook.On,"95: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBB,Do.Hook,Hook.On,"97: "  ' m1s57b  ' pseudo
    wait 1000
	expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgWait "100: "
	expectMsgSend SUBD,Do.Hook,Hook.On,"101: "  ' m1s57d  ' pseudo
	expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgWait
	wait 1000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236115







###################################################################################################
##################################################################################################

'B CALLS A, A XFERS B TO C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 14:27:23
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 2362011
  LOCAL count=0
  LOCAL title="TC236201(Speaker On) B CALLS A, A XFERS B TO C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 	REPEAT  
	RECINFO "Count : "+count  
	#Press GOODBYE
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 500
	
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
	wait 500
	
	#Press L1 on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 2000
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgWait
	wait 1000
	expectMsgWait
	
	#Phone A Picks up call by pressing Line 1
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b 
	expectMsgWait
	wait 1000
	
	#Press XFER
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: "  ' m1s57a  ' pseudo  
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
	
	#Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"50: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 2000
	
	#Press xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"50: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1500
    expectMsgAdd SUBA,Do.Connected,Connected.No
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink ' m1s57c
	expectMsgWait
	wait 1000
	expectMsgWait
   
	#Phone C picks up the call
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"55: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c 
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	wait 1000
	#Press Goodbye PHONE C
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"60: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 2000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 2000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '2362011





###################################################################################################
'TC236202-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 14:25:03
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 2362021
  LOCAL count=0
  LOCAL title="TC236202(Speaker On)-Blind Transfer-Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 500
	
	# Phone B to Call Phone A On Line 1
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
    expectMsgWait "13: "
    
    #Check if Phone A is ringing
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
    
	#Phone A press Line 1 to Picks up call & Check if Phone A and Phone B are connected
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    wait 1000
	
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"26: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive' m1s57b
	expectMsgWait
    
    #Dial Phone C number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"29: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: "  ' m1s57a  ' pseudo
    expectMsgWait
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgWait "32: "
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    wait 2000
	
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink ' m1s57c
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgWait
	wait 1500
	expectMsgWait
   
	#Phone C picks up the call
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"55: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c 
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    
	#Check if Phone C and Phone B is connected
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgWait "57: "    	
    wait 2000
	
	#Finish the call between B and C
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"60: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
    expectMsgWait
	wait 1000
	
	count=count+1 
	UNTIL count=1
   WEND
	
ENDTC '2362021





###################################################################################################

'TC236203-Blind Transfer - When Ringing, Phone B calls A, Phone A Blind Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 15:31:17
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236203
  LOCAL count=0
  LOCAL title="TC236203(Speaker On)-Blind Transfer-When Ringing, Phone B calls A, Phone A Blind Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count  
    #Press Good bye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    
	#Prees Line 1 on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
   
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"12: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "14: "
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "17: "
	
	#Check display On Phone A
	expectMsgWait "18: "
    wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgWait "26: "
    wait 2000
	
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"27: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 1000
	expectMsgSend SUBA,Do.Keys,SUBC.number,"30: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"50: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
	#Check Phone C's display
    expectMsgWait "36: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"38: "  ' m1s57a  ' pseudo
    
    #Check display on Phone C
	expectMsgWait "39: "
	wait 500
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check display of Phone C again
	expectMsgWait "49: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "50: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "53: "
	wait 2000
    
	#Phone C press Line 1 to answer the call
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"55: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	
	#Check if B and C Are connected
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
	expectMsgWait 
	wait 2000	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"59: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "69: "    
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"75: "  ' m1s57c  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"77: "  ' m1s57a  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236203






###################################################################################################

'TC236204-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 16:08:50
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236204
  LOCAL count=0
  LOCAL title="TC236204(Speaker On)-Consultative Transfer-Phone B calls A, Phone A Consultative Xfer to C"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
	RECINFO "Count : "+count  
	#Press Goodbye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	#Hoon On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"7: "  ' m1s57c  ' pseudo
    wait 1000
	#Press L1 on the Phone B to dial Phone A's number
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    
    #Dial Phone A's number
	expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    
	#Check Phone B's display
	expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
	#Check Phone A's display
    ##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"4165142531"+JOCKER  ' m1s57a
    checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    
	# Phone A press Line 1 to pick up call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgWait "27: "
    wait 2000
	
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    
	#Dial Phone C's number
	expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"50: "  ' m1s57a  ' pseudo
    expectMsgWait "34: "
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    #Check Phone C's display
	expectMsgWait "37: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "38: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    wait 2000
	
	#Phone C press L1 to answer the call
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"40: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgWait "53: "
    wait 2000
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"55: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"71: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"72: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57a  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236204






#####################################################################################################
'TC236205-SPEEDDIAL/XFER
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 10:01:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236205
  LOCAL count=0
  LOCAL title="TC236205(Speaker On)-SPEEDDIAL/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press L1 on Phone A 
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    wait 1000
	
	#Press More
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"12: "  ' m1s57a  ' pseudo
	wait 1000	   
	
	#Press U3-Speeddial/xfer with Phone B's number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"13: "  ' m1s57a  ' pseudo
	
	#Check display on Phone A
	##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    
	#Check display on Phone B
	expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "18: "
    checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    wait 2000
	
	#Phone B Press L1 to pick up the call 
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"55: "  ' m1s57b  ' pseudo
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"36: "  ' m1s57a  ' pseudo
	
	#Press L1 on Phone C
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"37: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    expectMsgSend SUBC,Do.Keys,SUBA.number,"47: "  ' m1s57c  ' pseudo
    expectMsgWait "48: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
	#Check display on Phone A
	##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"4165142532"+JOCKER  ' m1s57a
    expectMsgWait "52: "
    checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    wait 2000
	
	#Phone press L1
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"55: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"61: "  ' m1s57a  ' pseudo
    wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    
	#Check display on Phone A
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"70: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"85: "  ' m1s57a  ' pseudo
	wait 2000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"86: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"96: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236205






###############################################################################################

'TC236206-BLF/XFER
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 11:41:11
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 236206 
  LOCAL count=0
  LOCAL title="TC236206(Speaker On)-BLF/XFER"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#HOOK ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57c  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    wait 1000
	
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	wait 1000
	
	#Press More on Phone A
	#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
	#PLATFORM==2,4
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
    wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "23: "
    
	#Check Display of Phone B
	expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "24: "
    checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Phone B Press L1 to pick up call
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"27: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "32: "
    wait 2000
	
	#Press GoodBye on Phone B to end the Call
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"33: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"36: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    
	#Press L1 on Phone C to call Phone A
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"42: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
    expectMsgSend SUBC,Do.Keys,SUBA.number,"45: "  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
	expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "51: "
    
	#Check display of Phone A
	##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"4165142532"+JOCKER  ' m1s57a
    expectMsgWait "52: "
    checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    wait 2000
	
	#Phone A Press L1 to answer the call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"57: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a 
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
	wait 2000

	#Press BLF/Xfer on Phone A
		#PLATFORM==1,3
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U12,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
	#PLATFORM==2,4
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"13: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    wait 1000
	
	#Check display on Phone B
	#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"4165142532"+JOCKER  ' m1s57b
    expectMsgWait "136: "
    #checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	wait 2000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"145: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyF4,Key.LightOff ' m1s57b
    expectMsgAdd SUBB,Do.KeyF1,Key.LightOff  ' m1s57b
    expectMsgWait "207: "
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    wait 2000

	#Press GoodBye on Phone B
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"210: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF4,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgWait "244: "
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"246: "  ' m1s57c  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"247: "  ' m1s57a  ' pseudo
	expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND

ENDTC '236206






#########################################################################################

'TC236207-Xfer with 2 outbound active calls
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 09:54:46
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236207
  LOCAL count=0
  LOCAL title="TC236207(Speaker On)-Xfer with 2 outbound active calls"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBB,Do.Hook,Hook.On,"7: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"8: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"9: "  ' m1s57d  ' pseudo
    
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    
    #Dial Phone B's number
	expectMsgSend SUBA,Do.Keys,SUBB.number,"17: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "18: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "26: "
    
	#Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "27: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Phone B Press L1 to pick up the call
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"29: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b     
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b  
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a   
    expectMsgWait "49: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
	wait 2000
	
	#Press L2 on Phone A
    expectMsgSend SUBA,Do.KeyL2,Key.Click,"50: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a     
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a  
	wait 1000
	
	#Type Phone C's number
    expectMsgSend SUBA,Do.Keys,SUBC.number,"159: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1    
    expectMsgWait "160: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a    
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c  
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c    
    expectMsgWait "168: "
	
	#Check Phone C's display
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "169: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "171: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	wait 2000
	
	#Phone C Press L1 to pick up the call
    #expectMsgSend SUBC,Do.Hook,Hook.Off,"173: "  ' m1s57c  ' pseudo       
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c   
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a 
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    wait 2000
	
	#Press L1 on Phone A
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"192: "  ' m1s57a  ' pseudo 
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a  
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a   
    expectMsgWait "217: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer on L1 of Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"218: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a 	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "219: "
	#@###expectTextCheck SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a	
    expectMsgWait "246: "    
	wait 3000
	
	#Press L2
	expectMsgSend SUBA,Do.KeyL2,Key.Click,"50: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    expectMsgWait "320: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a   
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
    expectMsgWait "387: "
	wait 1000   
    #expectMsgSend SUBA,Do.Hook,Hook.On,"388: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"390: "  ' m1s57a  ' pseudo
	
	wait 2000
	
	#Hook On Phone B
	#expectMsgSend SUBB,Do.Hook,Hook.On,"391: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"395: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyF1,Key.LightOff  ' m1s57a   
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "410: "
    #expectMsgSend SUBC,Do.Hook,Hook.On,"411: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"450: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236207






##########################################################################################################

'TC236209-Cancel Xfer while connected
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 13:22:19
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236209
  LOCAL count=0
  LOCAL title="TC236209(Speaker On)-Cancel Xfer while connected"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press L1 on phone B to call Phone A
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b    
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo   
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a    
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a    
    expectMsgWait "18: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "19: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 2000
	
	#Phone A Press L1 to pick up call
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"20: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "27: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	wait 2000
    
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"28: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgSend SUBA,Do.Keys,SUBC.number,"31: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"32: "  ' m1s57a  ' pseudo
    expectMsgWait "33: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a	
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a 
	#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#expectMsgWait "34: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    expectMsgWait "36: "
   
	#Check display on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "37: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "39: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone C Press L1 to pick up the call
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"40: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"42: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	
	#Press Cancel Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"46: "  ' m1s57a  ' pseudo    
	expectMsgWait "47: "
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"46: "  ' m1s57a  ' pseudo
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"46: "  ' m1s57a  ' pseudo
	
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"65: "  ' m1s57b  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"66: "  ' m1s57a  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236209






#########################################################################################################
'TC236211-Swap calls before Consultative Xfer
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 16:17:30
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236211 
  LOCAL count=0
  LOCAL title="TC236211(Speaker On)-Swap calls before Consultative Xfer"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press L1 on Phone B to call Phone A
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  
	' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo    	
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "19: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "20: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone A Press L1 to pick up the call
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"21: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"22: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "28: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	wait 1000
	
	#Press Xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "33: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a   
    expectMsgSend SUBA,Do.Keys,SUBC.number,"34: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"32: "  ' m1s57a  ' pseudo
    expectMsgWait "36: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "37: "
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c   
    expectMsgWait "41: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "42: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "44: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone C Press L1 to answer the call
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"45: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"46: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	wait 1000
	
	#Press the arrow key
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"51: "  ' m1s57a  ' pseudo
    wait 1000
	#Press PickUp
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"52: "  ' m1s57a  ' pseudo
    wait 5000
	#Press Xfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"53: "  ' m1s57a  ' pseudo   
    expectMsgWait "54: "
    ##@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #expectMsgWait "55: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgWait "58: "   
	wait 2000
	
	#Hook On Phone B
    #expectMsgSend SUBB,Do.Hook,Hook.On,"59: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b    
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"60: "  ' m1s57b  ' pseudo
	expectMsgWait "62: "   
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    #expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "69: "    
    expectMsgWait "71: "
    #expectMsgSend SUBC,Do.Hook,Hook.On,"72: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #expectMsgSend SUBA,Do.Hook,Hook.On,"75: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"73: "  ' m1s57c  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"74: "  ' m1s57a  ' pseudo
	expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236211






###############################################################################################
'TC236212- Xfer call after dialing a wrong number
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/15/2012 16:31:18
'SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 236212
 LOCAL count=0
  LOCAL title="TC206212- Xfer call after dialing a wrong number"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
   REPEAT  
  	RECINFO "Count : "+count 
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook On
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
    
	#Press L1 on Phone B to call Phone A
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"14: "  ' m1s57b  ' pseudo    
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "19: "
	
	#Check display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "20: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 1000
	
	#Phone A Press L1 to pick up the call
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"21: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b   
    expectMsgWait "28: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
	#Press Xfer to dial the wrong number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"29: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "33: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Keys,"1231431","34: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgWait "36: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57a  ' pseudo
    expectMsgWait "41: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom"+JOCKER  ' m1s57a
    
	#Wait until the Phone A comes back to hold
	#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	wait 4000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
    expectMsgWait "43: "
	#expectMsgAdd SUBA,Do.Connected,Connected.Hold  ' m1s57a   
    #expectMsgWait
	'##expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"1231431"+JOCKER  ' m1s57a  3.3.1.80 BUG - Wrong Number Is Cleared From Screen. Uncomment When Fixed
    expectMsgWait "44: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Press Xfer to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"45: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #@3expectMsgAdd SUBA,Do.Connected,Connected.Intern  ' m1s57a   
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a   
    expectMsgSend SUBA,Do.Keys,SUBC.number,"48: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"38: "  ' m1s57a  ' pseudo
    expectMsgWait "50: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a  
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a 
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "51: "
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"52: "  ' m1s57a  ' pseudo
    expectMsgWait "55: "
	#@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a  
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a  
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "56: "
	expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c  
    expectMsgWait "58: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57c
    expectMsgWait "59: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgWait "61: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom^CCindy Christens"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone C Press L1 to answer the call
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"62: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"63: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    wait 2000
	
	#Press xfer to finish the xfer between A and C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"68: "  ' m1s57a  ' pseudo
    
    #expectMsgWait "69: "
    ###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    #expectMsgWait "70: "
    #checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	expectMsgWait "70: "
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a   
    expectMsgWait "73: "   
    expectMsgWait "76: "  
    #expectMsgSend SUBB,Do.Hook,Hook.On,"77: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"78: "  ' m1s57b  ' pseudo
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "81: " 
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c      
    expectMsgWait "87: "    
    expectMsgWait "89: " 
    #expectMsgSend SUBC,Do.Hook,Hook.On,"90: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    #expectMsgSend SUBA,Do.Hook,Hook.On,"93: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"91: "  ' m1s57c  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"92: "  ' m1s57a  ' pseudo
	expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '236212






#######################################################################################################

###################################################################################################

## 237_CONFERENCE_LIVE_DIAL_BROADSOFT 

###################################################################################################

 #### Intial state of the phone :
 #### --Phine A is DUT
 #### --BLF is set on U10 on DUT
 #### --Phone C speeddial is set in U4  on DUT
 #### --Pnone C speeddial/conference is set as U5 on DUT
 #### --Services is set on U7 on DUT
 #### --Directory is set on U8 on DUT
 #### --Callers List is set on U9 on DUT

###################################################################################################

#######################################################################

'TC 237100- Conference_Live_Dial Configuration
'Edited by Weiling Chen
'aastra on A155-0389 the 10/11/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 237100
  LOCAL title="TC237100-Conference Configuration"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	count=0
	REPEAT
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count =count+1
	UNTIL count=20


	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
  WEND
ENDTC '237100







####################################################################################################

'Clearing the Directory and the Callers List
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 16:09:57
'  SUBA(m1s57a)  SUBB(m1s57b)  
TESTCASE 2371001
  LOCAL title="TC2371001-Clearing the Directory and the Callers List"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
          #### Initial State of the Phones ####
  
  expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
		wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57e  ' pseudo
		wait 1000
		#### Clearing Directory ####

    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57e  ' pseudo
		wait 1000
		
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U8,"2: "  ' m1s57e  ' pseudo
		wait 1000

    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57e  ' pseudo
		wait 1000

    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57e  ' pseudo
		wait 3000

    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57e  ' pseudo
    expectMsgWait "10: "

wait 3000	
	 expectMsgWait "11: "
	#### Clearing Callers list /Initial staate of the Phones ####

    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57e  ' pseudo
    #expectMsgWait "14: "
	#	wait 1000
		
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U9,"12: "  ' m1s57e  ' pseudo
    expectMsgWait "14: "
		wait 1000

    expectMsgWait "15: "
	#Press Delete
    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57e  ' pseudo
	'	wait 1000

	#Press DeleteList to erase all items

	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57e  ' pseudo
	#wait 1000
	
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57e  ' pseudo
	'wait 1000
			
    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57e  ' pseudo
    'expectMsgWait "26: "
	'wait 3000	
    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57e  ' pseudo	
	#wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57e  ' pseudo
    expectMsgWait

  WEND
ENDTC '2371001






#############################################################################################################
 
'Basic Test 1 - Verify that conference host can initiate, execute and complete local conference when first call is incoming call.
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 10:36:56
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237101
  LOCAL title="Basic Test 1 "
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    
	#### Initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
    ### Phone B is calling PhoneA ###
	expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgWait "12: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
	expectMsgWait "15: "
	wait 500
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
     ### Ringing for 5s then phone A answer phone B ###
	expectMsgWait "23: "
	wait 5000
    expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgWait "26: "
	wait 1000
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
	
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530" + JOCKER  ' m1s57b
	     expectMsgWait
		wait 5000
  ### Starting a conference on phone A with phone C and phoneB ###
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
	    expectMsgWait
		wait 1000
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"63: "  ' m1s57a  ' pseudo
	
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "73: "
	wait 5000
 #### phone C answers ####	
    expectMsgSend SUBC,Do.Hook,Hook.Off,"74: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgWait "75: "
	wait 5000  
 #### making the conference ####	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "  ' m1s57a  ' pseudo
  	expectMsgWait "81: "
	wait 500
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgWait "81: "
	wait 7000
	
 #### hold the conference for 7s the phones hang up ####	
    expectMsgSend SUBB,Do.Hook,Hook.On,"91: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgWait "81: "
	wait 1000
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgWait "81: "
	wait 1000

    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    #expectMsgSend SUBA,Do.Hook,Hook.On,"110: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a	
    expectMsgWait "116: "
    
    
    expectMsgWait "117: "
    expectMsgSend SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait "121: "
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgSend SUBC,Do.Hook,Hook.On,"124: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "133: "
    expectMsgWait "135: "
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
	
	 #### initial state of the phones####
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"138: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237101






#############################################################################################################
  
'Basic Test 2 - Verify that conference host can initiate, execute and complete local conference when first call is outgoing call.
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 11:50:22
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237102
  LOCAL title="Basic Test 2"
   #### configuring phones ####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
     #### initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	 #### Phone A is calling pone B ####
   expectMsgWait 
	wait 1000  	 
	
	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.Off,"9: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a

    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
	
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    #### phone B rings for 5s then answers   ####   
   expectMsgWait "25: "
	wait 5000  
   
   expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "46: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
    #### start making a conference ####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgWait
	wait 1000	
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
    #### Dialing phone C #### 
    expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
 
    #### phone C rings for 5s and then answer #### 
	 expectMsgWait "75: "
	wait 5000
	expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgWait "80: "
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
     expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "83: "
	wait 5000  
    #### establishing the conference ####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "  ' m1s57a  ' pseudo
     expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "99: "
	wait 7000
	#### finishing the conference/phones are hooking  on  ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"108: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait "110: "
	wait 1000
     expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
     expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
	
    expectMsgSend SUBB,Do.Hook,Hook.On,"124: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"125: "  ' m1s57b  ' pseudo
	expectMsgWait "126: "
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
	
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "129: "
    expectMsgWait "131: "
    expectMsgWait "133: "
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBC,Do.Hook,Hook.On,"136: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgWait "138: "
	wait 500
	#### initial state of the phones ####	
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57a  ' pseudo
    expectMsgWait
  '  expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
	
  WEND
ENDTC '237102






#############################################################################################################

'Basic Test 3 - Verify that conference host can initiate, execute and complete local conference when 2 outbound active calls are already running.
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 14:17:44
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237103
  LOCAL title="Basic Test 3"
   ##### Configuring the phones #####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
       ##### phone A is calling phone B #####

	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
	
    expectMsgSend SUBA,Do.Hook,Hook.Off,"9: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    ##### phone B rings for 5s then answers #####
	  expectMsgWait "24: "  
	  wait 5000
	expectMsgSend SUBB,Do.Hook,Hook.Off,"25: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "44: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
     expectMsgWait "44.5: "  
	  wait 5000    
	    ##### phone A is calling phone C from L2 #####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"45: "  ' m1s57a  ' pseudo
	expectMsgWait "44.5: "  
	wait 500   
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"58: "  ' m1s57a  ' pseudo
    
    expectMsgWait "59: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
 	    expectMsgWait
		wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "68: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "69: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    ##### phone C rings for 5s then answers  #####      
	  expectMsgWait "70: "  
	  wait 5000   
	expectMsgSend SUBC,Do.Hook,Hook.Off,"73: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "93: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
	  expectMsgWait  
	  wait 2000        
	 ##### starting to make a conference form DUT(phone A) #####   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"94: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgWait
	wait 3000	
        #####  conference on phone A with phone B on L1 and phone C on L2#####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"111: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
         expectMsgWait "124: "  
	  wait 7000
    ##### finishing the conference/phones hook on/initial state of the phones  #####	  
      # #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a   
   expectMsgSend SUBA,Do.Hook,Hook.On,"136: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
   ' expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "149: "
   ' expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"151: "  ' m1s57a  ' pseudo
    
    
    expectMsgWait "152: "
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "164: "
	  '  'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgWait "166: "
    expectMsgSend SUBB,Do.Hook,Hook.On,"167: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"170: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"171: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"174: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237103






#############################################################################################################
'Advanced Test 1 - 2nd leg dropped by remote phone
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 10:44:39
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237105
  LOCAL title="Advanced Test 1"
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
     ##### Initial state of the phones #####	    
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	
	     ##### Phone B is Calling Phone A  #####	  

	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    
     ##### Phone A Rings for 5s Then Answers  #####		
	expectMsgWait "25: "
   wait 5000
   expectMsgSend SUBA,Do.Hook,Hook.Off,"26: "  ' m1s57a  ' pseudo
   expectMsgWait
	wait 1000
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
      expectMsgWait "46.5: "
   wait 5000 
   
 	##### Start Making a Conference Form Phone A  #####	  
	
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	'expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	    expectMsgWait
		wait 1000	
      ##### Phone A is Calling Phone C  #####	  
	  
	expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "75: "
   wait 5000    
   
   	      ##### Phone C Rings for 5s Then Answers  #####	

	expectMsgSend SUBC,Do.Hook,Hook.Off,"77: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
	expectMsgWait "75: "
   wait 1000   
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgWait
	wait 500
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
     expectMsgWait "94: "
   wait 7000  
   	 ##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
  	      ##### Phone C Hangs Up #####	
 
	expectMsgSend SUBC,Do.Hook,Hook.On,"95: "  ' m1s57c  ' pseudo
	expectMsgWait "75: "
    wait 1000   
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c

    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgWait "112: "
	
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"116: "  ' m1s57a  ' pseudo
    #@#expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	
  ##### Phone A Hangs Up #####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"118: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
      expectMsgWait "128: "
   wait 5000     
  ##### Phone B Hangs Up #####	
	expectMsgSend SUBB,Do.Hook,Hook.On,"129: "  ' m1s57b  ' pseudo
    expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "143: "
    expectMsgWait "145: "
    expectMsgWait
  WEND
ENDTC '237105






#############################################################################################################

'Advanced Test 2 - Drop & add participants
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 13:32:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 237106
  LOCAL title="Advanced Test 2 "
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
      ##### Initial state of the phones #####	         
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
     ##### Phone B is Calling Phone A  #####	  
	
	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"10: "  ' m1s57b  ' pseudo
    
    expectMsgWait "12: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
   
   expectMsgSend SUBB,Do.Hook,Hook.Off,"13: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "25: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "26: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
     expectMsgWait
		wait 5000
     ##### Phone A Rings for 5s Then Answers  #####		
	expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "48: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    
	     expectMsgWait
		wait 1000
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000	
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	    expectMsgWait
		wait 1000	
 	       ##### Phone A is Calling Phone C  #####	    
   expectMsgSend SUBA,Do.Keys,SUBC.number,"68: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"69: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "76: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "77: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
	      ##### Phone C Rings for 5s Then Answers  #####	
	 expectMsgWait
		wait 5000   
	expectMsgSend SUBC,Do.Hook,Hook.Off,"81: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
	      ##### Establishing a Conference between Phone A ,Phone B and Phone C #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"99: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	expectMsgWait
		wait 5000
	      ##### Phone A drops Phone C from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"112: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    
    expectMsgWait "119: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "120: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "122: "
	      ##### Phone C Hook On /Initial state for the Phone C #####	
   
   expectMsgSend SUBC,Do.Hook,Hook.On,"123: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgWait
		wait 5000   
   expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"126: "  ' m1s57c  ' pseudo
	     expectMsgWait
		wait 3000
	##### Start Making Another Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"127: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    
	    expectMsgWait
		wait 1000
	##### Phone A is Calling Phone D  #####	  
   expectMsgSend SUBA,Do.Keys,SUBD.number,"145: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"146: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActiveBlink  ' m1s57d	
    expectMsgAdd SUBD,Do.Ringing,Ringing.Yes  ' m1s57d
    
    expectMsgWait "153: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57d
    expectMsgWait "154: "
    checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57d
    expectMsgAdd SUBD,Do.KeyMessage,Key.LightActiveBlink  ' m1s57d


     ##### Phone D Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
		expectMsgSend SUBD,Do.Hook,Hook.Off,"157: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
    expectMsgAdd SUBD,Do.Ringing,Ringing.Quiet  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		   ##### Establishing a Conference between Phone A ,Phone B and Phone D #####			
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"174: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"187: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"192: "  ' m1s57a  ' pseudo
   
   expectMsgWait
		wait 5000
	      ##### Phone A drops Phone D from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"198: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Disconnect  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
    expectMsgWait "205: "
    expectMsgWait "206: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
  	      ##### Phone D Hook On /Initial state for the Phone D #####	  
	expectMsgSend SUBD,Do.Hook,Hook.On,"207: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
 expectMsgWait
		wait 5000  
   expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"210: "  ' m1s57d  ' pseudo
	     expectMsgWait
		wait 1000
		
	##### Start Making Another Conference Form Phone A  #####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"211: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	     expectMsgWait
		wait 3000	
	       ##### Phone A is Calling Phone E  #####	  
   
    expectMsgSend SUBA,Do.Keys,SUBE.number,"230: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"231: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBE,Do.KeyL1,Key.LightActiveBlink  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Yes  ' m1s57e
   
    expectMsgWait "238: "
    expectTextCheck SUBE,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57e
    expectMsgWait "239: "
    checkGetStateText SUBE,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57e
    expectMsgAdd SUBE,Do.KeyMessage,Key.LightActiveBlink  ' m1s57e
    'expectMsgAdd SUBE,Do.KeyMessage,Key.LightOff  ' m1s57e
	
     ##### Phone E Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
	expectMsgSend SUBE,Do.Hook,Hook.Off,"242: "  ' m1s57e  ' pseudo
    expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
    expectMsgAdd SUBE,Do.Hook,Hook.Off  ' m1s57e
    expectMsgAdd SUBE,Do.Connected,Connected.Yes  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Quiet  ' m1s57e
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		
		      ##### Establishing a Conference between Phone A ,Phone B and Phone E #####			
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"259: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    
	expectMsgWait
		wait 5000
		
	      ##### Phone A drops Phone E from the conference  #####			

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"282: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBE,Do.KeyL1,Key.LightOff  ' m1s57e
    expectMsgAdd SUBE,Do.Connected,Connected.No  ' m1s57e
    'expectMsgAdd SUBE,Do.InbandTone,InbandTone.Disconnect  ' m1s57e
    expectMsgAdd SUBE,Do.InbandTone,InbandTone.Quiet  ' m1s57e
    
    expectMsgWait "289: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "290: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "292: "
	
	      ##### Phone E Hook On /Initial state for the Phone E #####	
    expectMsgSend SUBE,Do.Hook,Hook.On,"293: "  ' m1s57e  ' pseudo
    expectMsgAdd SUBE,Do.Hook,Hook.On  ' m1s57e
 expectMsgWait
		wait 5000   
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"296: "  ' m1s57e  ' pseudo
  
  #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
  
	      ##### Ending The Calls /Phones Hook On /Initial state of the Phones #####	
  
  expectMsgSend SUBB,Do.Hook,Hook.On,"297: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    
    
    expectMsgWait "304: "
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"313: "  ' m1s57b  ' pseudo
    expectMsgWait "315: "
    expectMsgWait "317: "
    expectMsgSend SUBA,Do.Hook,Hook.On,"318: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"321: "  ' m1s57a  ' pseudo
    expectMsgWait
  WEND
ENDTC '237106






##################################################################################################
 
 
'Advanced Test 7 - Speeddial/conf softkey, w/ local conf.
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 10:59:48
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237110
	LOCAL title="Advanced Test 7"
  
 		##### configuring phones  #####	 
 
	setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
     ##### Initial state of the phones #####	 
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
    
     ##### Phone B is Calling Phone A  #####	  

	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo

       expectMsgSend SUBB,Do.Hook,Hook.Off,"12: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
   expectMsgWait "11: "
   wait 500 
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	
	
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgWait
	wait 1000
   	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "24: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgWait "27: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

 	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "28: "
	wait 5000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
 

    ##### Phone A is Dailing Phone C  Using  Speeddial/Conf Softkey #####
	expectMsgWait "47: "
	wait 5000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"48: "  ' m1s57a  ' pseudo
    expectMsgWait "48.5: "
	wait 1000  
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"48: "  ' m1s57a  ' pseudo
    expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c

    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57c
    expectMsgWait "78: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
  
	##### Phone C Rings for 5s Then Answers  #####	

	expectMsgWait "79: "
	wait 5000  
	expectMsgSend SUBC,Do.Hook,Hook.Off,"83: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "100: "
	wait 5000
  
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	
	##### Phone A Hook On /Initial state for the Phone A #####	
	#PLATFORM==1,2,3
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"118: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
	
		#PLATFORM==4
#	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"118: "  ' m1s57a  ' pseudo
	#ENDPLATFORM
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgWait "120: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a  
	expectMsgSend SUBA,Do.Hook,Hook.On,"122: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"134: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "28: "
	wait 1000
    expectMsgWait "145: "
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgWait "149: "
     expectMsgWait "149.5: "
	wait 5000  

	##### Phone B Hook On /Initial state for the Phone B #####	

	expectMsgSend SUBB,Do.Hook,Hook.On,"150: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"156: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c

	##### Phone C Hook On /Initial state for the Phone C #####	

    expectMsgSend SUBC,Do.Hook,Hook.On,"167: "  ' m1s57c  ' pseudo
    expectMsgWait "169: "
    expectMsgWait "171: "
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"173: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgWait
  WEND
ENDTC '237110





#############################################################################################################
 
'Verify that you can swap calls before the conference is completed
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 09:47:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237111
  LOCAL title="Advanced Test 8"
  
 		##### configuring phones  #####	 
 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

     ##### Initial state of the phones #####	 
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
   
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@#expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    
	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "24: "
	wait 5000
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "44.5: "
	wait 5000

	##### Start Making a Conference Form Phone A  #####	
		
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
	expectMsgWait 
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	    expectMsgWait
		wait 1000	       
	##### Phone A is Dailing Phone C  #####

    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"66: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
	##### Phone C Rings for 5s Then Answers  #####	

	expectMsgWait "74: "
	wait 5000
	expectMsgSend SUBC,Do.Hook,Hook.Off,"75: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "92: "
	wait 3000
	
	##### Press line 1 to swap calls ##### 
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"93: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait "100: "
	wait 1000
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"110: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgWait "122: "
	wait 7000
	
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	

	##### Phone B Hook On /Initial state for the Phone B #####	
	
	expectMsgSend SUBB,Do.Hook,Hook.On,"123: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    
    
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "126: " 
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "136: "
    
    
    expectMsgWait "137: "
    #@#expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"138: "  ' m1s57b  ' pseudo
     expectMsgWait "139: "
	wait 5000
	
	##### Phone A Hook On /Initial state for the Phone A #####	

	expectMsgSend SUBA,Do.Hook,Hook.On,"140: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "154: "
    expectMsgWait "156: "
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"157: "  ' m1s57a  ' pseudo

	##### Phone C Hook On /Initial state for the Phone C #####	
    
	expectMsgSend SUBC,Do.Hook,Hook.On,"158: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"161: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237111


################################################################################

'Advanced Test 9 - Using speeddial on 2nd leg
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 11:04:10
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237112 
  LOCAL title="Advanced Test 9"
  
  		##### configuring phones  #####	 

  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	

    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
   
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	##### Phone A Rings for 5s Then Answers  #####		      
    
	expectMsgWait "25: "
	wait 5000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"27: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "46.5: "
	wait 5000   
	
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
    expectMsgWait 
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	
	##### Phone A is Calling Phone C Using SpeedDial#####
 	expectMsgWait
	wait 2000    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"64: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 2000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"65: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c

	##### Phone C Rings for 5s Then Answers  #####	
	expectMsgWait "75: "
	wait 5000   
	expectMsgSend SUBC,Do.Hook,Hook.Off,"76: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "85: "
	wait 5000   
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"93: "  ' m1s57a  ' pseudo
	expectMsgWait "94: "
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
       expectMsgWait "95: "
		wait 5000   
    
    
    expectMsgWait "101: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b	
	

	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	##### Phone B Hook On /Initial state for the Phone B #####	

	expectMsgSend SUBB,Do.Hook,Hook.On,"106: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "117: "
    
    expectMsgWait "117.5: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "119: "
	wait 5000   
	
	##### Phone A Hook On /Initial state for the Phone A #####	
	
	expectMsgSend SUBA,Do.Hook,Hook.On,"120: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"129: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ''expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "135: "
    expectMsgWait "137: "
   
	##### Phone C Hook On /Initial state for the Phone C #####	
   
   expectMsgSend SUBC,Do.Hook,Hook.On,"138: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237112






##################################################################################################

'Advanced Test 10 - Using BLF on 2nd leg
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 11:35:38
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237113
  LOCAL title="Advanced Test 10"

  ##### configuring phones  #####	 
  
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 
      ##### Initial state of the phones #####	 

    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
 
     ##### Phone B is Calling Phone A  #####	  
	
	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
   
	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "23: "
	wait 5000
	expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "44.5: "
	wait 5000   

	##### Start Making a Conference Form Phone A  #####	
	
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
    expectMsgWait 
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	    expectMsgWait
		wait 1000	
 	##### Press the concerned BLF key on Phone A to call Phone C #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U10,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "80: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "81: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
   
	##### Phone C Rings for 5s Then Answers  #####	

   expectMsgWait "83: "
	wait 5000 
	expectMsgSend SUBC,Do.Hook,Hook.Off,"84: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "100: "
	wait 5000  
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"113: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	
	##### Phone A Is Leaving The Conference  #####	
	
    expectMsgWait "120: "
	wait 5000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"126: "  ' m1s57a  ' pseudo
	wait 1000 
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "140: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "143: "
	wait 5000
    
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	##### Phone A Hook On /Initial state for the Phone A #####	
	
	expectMsgSend SUBA,Do.Hook,Hook.On,"144: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"147: "  ' m1s57a  ' pseudo
    expectMsgWait "147.5: "
	wait 5000   

	##### Phone B Hook On /Initial state for the Phone B #####	
	
	expectMsgSend SUBB,Do.Hook,Hook.On,"148: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF10,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"162: "  ' m1s57b  ' pseudo
    expectMsgWait "164: "
    expectMsgWait "166: "
 
 	##### Phone C Hook On /Initial state for the Phone C #####	

	expectMsgSend SUBC,Do.Hook,Hook.On,"167: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"170: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237113






###################################################################################

'Advanced Test 18 - Incoming call before a Conference and Incoming call after making a Conference 
'Edited by Weiling Chen
'aastra on a155-0138 the 10/23/2012 10:15:31
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 237118
  LOCAL title="Advanced Test 18 "
      ##### configuring phones  #####	 
  
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	  
	   
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
   
     ##### Phone A is Calling Phone B  #####	  

   
    expectMsgSend SUBA,Do.Keys,SUBB.number,"10: "  ' m1s57a  ' pseudo
   
    expectMsgWait "12: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "25: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "26: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57b
    
     ##### Phone B Rings for 5s Then Answers  #####	

	expectMsgWait "27: "
	wait 5000
	expectMsgSend SUBB,Do.Hook,Hook.Off,"29: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "48: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBA.number+JOCKER  ' m1s57a
    expectMsgWait "48.5: "
	wait 5000    
		
	##### Start Making a Conference From Phone B  #####		
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57b  ' pseudo
	expectMsgWait 
	wait 1000
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    'expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveRecall  ' m1s57b
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b
    
	expectMsgWait
	wait 1000
	
	##### Phone B is Calling Phone C  #####
	expectMsgSend SUBB,Do.Keys,SUBC.number,"67: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"68: "  ' m1s57b  ' pseudo
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "75: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57c
    expectMsgWait "76: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
    ##### Phone C Rings for 5s Then Answers  #####	
  
    expectMsgWait "77: "
	wait 5000    
	expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "87: "
	wait 5000   
		
		
	#### Phone D calls Phone B b4 phone B press "Conf" L2 LED should be blinking and Screen still on L1 
	
	expectMsgSend SUBD,Do.Keys,SUBB.number,"10: "  ' m1s57d  ' pseudo
    expectMsgWait "12: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57d
    expectMsgSend SUBD,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "35: "
	##@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"C^CAndy Anderson"+JOCKER  ' m1s57b
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	
	#Hook on  phone D
	expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
	expectMsgWait "25: "
	expectMsgAdd SUBB,Do.KeyL2,Key.LightOff  ' m1s57b
    wait 1000
	
	##### Phone B press "Conf" to Establish a Conference between Phone A ,Phone B and Phone C #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57b  ' pseudo
	wait 5000
	##@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"C^CAndy Anderson"+JOCKER  ' m1s57b
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57b
	expectMsgWait "25: "
	wait 5000
	
	# Phone D calls Phone B again, L2 LED should be blinking and Screen should display incoming call on L2  
	
	expectMsgSend SUBD,Do.Keys,SUBB.number,"10: "  ' m1s57d  ' pseudo
    expectMsgWait "12: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57d
    expectMsgSend SUBD,Do.Hook,Hook.Off,"13: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBB,Do.KeyL2,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	expectMsgWait "26: "
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57b
    expectMsgWait "26: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57b
	expectMsgWait "77: "
	wait 2000    
      
    ##### Phone B answer the phone for 5s and drop the call  #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F2,"111: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
	expectMsgAdd SUBB,Do.KeyL2,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgWait "87: "
	wait 5000  

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
	wait 1000
	expectMsgAdd SUBB,Do.KeyL2,Key.LightOff  ' m1s57b
	expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
	
	 ##### Phone B is going back to the line 1 #####	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"164: "  ' m1s57b  ' pseudo
    'expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveRecall  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "177: "
	wait 2000
	
	##### Phone B Is Leaving The Recent Conference  #####	

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"187: "  ' m1s57b  ' pseudo
	expectMsgWait "177: "
	wait 1000
	##### Phone B Hook On /Initial state for the Phone  #####	

	expectMsgSend SUBB,Do.Hook,Hook.On,"268: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"282: "  ' m1s57b  ' pseudo
    expectMsgWait "285: "
   
	##### Phone C Hook On /Initial state for the Phone C #####	

	expectMsgSend SUBC,Do.Hook,Hook.On,"286: "  ' m1s57c  ' pseudo
    expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"289: "  ' m1s57c  ' pseudo
	
	##### Phone A Hook On /Initial state for the Phone A #####	

    expectMsgSend SUBA,Do.Hook,Hook.On,"298: "  ' m1s57a  ' pseudo
    expectMsgWait "299: "
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"316: "  ' m1s57a  ' pseudo
    expectMsgWait "318: "
    expectMsgSend SUBD,Do.Hook,Hook.On,"319: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57d  ' pseudo
    expectMsgWait
  WEND
ENDTC '237118





###############################################################################################
###################################################################################################
#
# 2371 Conf_Live_Dial_Broadsoft(Speaker On)
#
###################################################################################################
'Basic Test 1 - Verify that conference host can initiate, execute and complete local conference when first call is incoming call.
'Edited By Weiling Chen
'aastra on a155-0138 the 10/16/2012 10:36:56
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237201
  LOCAL title="Basic Test 1(Speaker On) "
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    
	#### Initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
    ### Phone B is calling PhoneA ###
	expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
     ### Ringing for 5s then phone A answer phone B ###
	expectMsgWait "23: "
	wait 5000
    #Phone A press L1 to answer the call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a

    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530" + JOCKER  ' m1s57b
	     expectMsgWait
		wait 5000
  ### Starting a conference on phone A with phone C and phoneB ###
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyL1,Key.LightActive' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
	expectMsgWait
	wait 1000
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"63: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "73: "
	wait 5000
 #### phone C press L1 to answer ####	
    #expectMsgSend SUBC,Do.Hook,Hook.Off,"74: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgWait "75: "
	wait 5000  
 #### making the conference ####	
  expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"80: "  ' m1s57a  ' pseudo
    expectMsgWait "81: "
	wait 500
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgWait "81: "
	wait 7000
	
 #### hold the conference for 7s the phones hang up ####	
    #expectMsgSend SUBB,Do.Hook,Hook.On,"91: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"23: "  ' m1s57b  ' pseudo
	expectMsgWait "81: "
	wait 1000
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b

    #expectMsgSend SUBA,Do.Hook,Hook.On,"110: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a	
    expectMsgWait "116: "
    
    
    expectMsgWait "117: "
	
    #expectMsgSend SUBA,Do.Hook,Hook.On  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"23: "  ' m1s57a  ' pseudo
	expectMsgWait "81: "
	wait 500
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    #expectMsgSend SUBC,Do.Hook,Hook.On,"124: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"23: "  ' m1s57c  ' pseudo
	expectMsgWait "81: "
	wait 500
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "133: "
    expectMsgWait "135: "
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
	 #### initial state of the phones####
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"138: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237201






#############################################################################################################

'Basic Test 2 - Verify that conference host can initiate, execute and complete local conference when first call is outgoing call.
'Edited By Weiling Chen
'aastra on a155-0138 the 10/16/2012 11:50:22
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237202
  LOCAL title="Basic Test 2(Speaker On)"
   #### configuring phones ####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
     #### initial state of the phones ####
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	 #### Phone A is calling pone B ####
   expectMsgWait 
	wait 1000  	 
	
	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"12: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"9: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a

    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
	
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    #### phone B rings for 5s then answers   ####   
   expectMsgWait "25: "
	wait 5000  
   #expectMsgSend SUBB,Do.Hook,Hook.Off,"27: "  ' m1s57b  ' pseudo
   #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
   expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57b  ' pseudo
   expectMsgWait
   wait 500
   expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
   expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
   expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
   expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
   expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
   expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
   expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "46: "
	wait 2000
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
    #### start making a conference ####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
	expectMsgWait "46: "
	wait 2000
	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	'expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	    expectMsgWait
		wait 1000	
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
    #### Dialing phone C #### 
    expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
 
    #### phone C rings for 5s and then answer #### 
	 expectMsgWait "75: "
	wait 5000
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"76: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
     expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "83: "
	wait 5000  
    #### establishing the conference ####	
  expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "  ' m1s57a  ' pseudo
     expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    
    expectMsgWait ": "
	wait 7000
	#### finishing the conference/phones are hooking  on  ####
	#expectMsgSend SUBA,Do.Hook,Hook.On,"108: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57a  ' pseudo
	expectMsgWait "98: "
	wait 1000
	 
	 expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
     expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
	
   # expectMsgSend SUBB,Do.Hook,Hook.On,"124: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.Hook,Hook.On,"125: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"102: "  ' m1s57b  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"103: "  ' m1s57c  ' pseudo
	expectMsgWait "104: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
	
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "129: "
    expectMsgWait "131: "
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    #expectMsgSend SUBC,Do.Hook,Hook.On,"136: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	#### initial state of the phones ####	
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"139: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"140: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57a  ' pseudo
    expectMsgWait
  '  expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
	
  WEND
ENDTC '237202






#############################################################################################################
'Basic Test 3 - Verify that conference host can initiate, execute and complete local conference when 2 outbound active calls are already running.
'Edited By Weiling Chen
'aastra on a155-0138 the 10/16/2012 14:17:44
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237203
  LOCAL title="Basic Test 3(Speaker On)"
   ##### Configuring the phones #####
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
       ##### phone A is calling phone B #####

	expectMsgSend SUBA,Do.Keys,SUBB.number,"6: "  ' m1s57a  ' pseudo
    
    expectMsgWait "8: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"12: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    expectMsgWait "21: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait "22: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    ##### phone B rings for 5s then answers #####
	  expectMsgWait "24: "  
	  wait 5000
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"25: "  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "44: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"'SUBB.number+JOCKER  ' m1s57a
     expectMsgWait "44.5: "  
	  wait 5000    
	    ##### phone A is calling phone C from L2 #####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"45: "  ' m1s57a  ' pseudo
	expectMsgWait "44.5: "  
	wait 500   
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"58: "  ' m1s57a  ' pseudo
    
    expectMsgWait "59: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
 	    expectMsgWait
		wait 1000
 expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"60: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "68: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "69: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    ##### phone C rings for 5s then answers  #####      
	  expectMsgWait "70: "  
	  wait 5000   
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"73: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
    
    expectMsgWait "93: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
	  expectMsgWait  
	  wait 2000        
	 ##### starting to make a conference form DUT(phone A) #####   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"94: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
	expectMsgWait
	wait 3000	
        #####  conference on phone A with phone B on L1 and phone C on L2#####
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"111: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "124: "  
	wait 7000
    ##### finishing the conference/phones hook on/initial state of the phones  #####	  
      # #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a   
    #expectMsgSend SUBA,Do.Hook,Hook.On,"136: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57a  ' pseudo
	expectMsgWait "98: "
	wait 1000
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
   ' expectMsgAdd SUBB,Do.InbandTone,InbandTone.Disconnect  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    expectMsgWait "149: "
   ' expectMsgAdd SUBA,Do.Connected,Connected.Yes    ' m1s57a
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"151: "  ' m1s57a  ' pseudo
    
    
    expectMsgWait "152: "
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "164: "
	  '  'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgWait "166: "
    #expectMsgSend SUBB,Do.Hook,Hook.On,"167: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57b  ' pseudo
	expectMsgWait "98: "
	wait 1000
	#expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"170: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.Hook,Hook.On,"171: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"97: "  ' m1s57c  ' pseudo
	expectMsgWait "98: "
	wait 1000
	#expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"174: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237203






#############################################################################################################

'Advanced Test 1 - 2nd leg dropped by remote phone
'Edited By Weiling Chen
'aastra on a155-0138 the 10/15/2012 10:44:39
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237205
  LOCAL title="Advanced Test 1(Speaker On)"
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
     ##### Initial state of the phones #####	    
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    
	
	##### Phone B is Calling Phone A  #####	  

	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
	#expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"12: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    
     ##### Phone A Rings for 5s Then Answers  #####		
	expectMsgWait "25: "
	wait 5000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"26: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
      expectMsgWait "46.5: "
   wait 5000 
   
 	##### Start Making a Conference Form Phone A  #####	  
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
   	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	'expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
	
	    expectMsgWait
		wait 1000	
      ##### Phone A is Calling Phone C  #####	  
	  
	expectMsgSend SUBA,Do.Keys,SUBC.number,"64: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"65: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    expectMsgWait "75: "
   wait 5000    
   
   	      ##### Phone C Rings for 5s Then Answers  #####	

	#expectMsgSend SUBC,Do.Hook,Hook.Off,"77: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
     expectMsgWait "94: "
   wait 7000  
   	 ##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
  	      ##### Phone C Hangs Up #####	
 
	#expectMsgSend SUBC,Do.Hook,Hook.On,"95: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"131: "  ' m1s57c  ' pseudo
	expectMsgWait "132: "
	wait 1000
	expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c

    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgWait "112: "
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a (Issue: Hold but Speaker LED is still on)
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57a  ' pseudo 
	expectMsgWait "132: "
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"116: "  ' m1s57a  ' pseudo
	#expectMsgWait "133: "
	#wait 1000
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	
  ##### Phone A Hangs Up #####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"118: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
      expectMsgWait "128: "
   wait 5000     
  ##### Phone B Hangs Up #####	
	#expectMsgSend SUBB,Do.Hook,Hook.On,"129: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"131: "  ' m1s57b  ' pseudo
	expectMsgWait "132: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    
	expectMsgWait "143: "
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"144: "  ' m1s57a  ' pseudo
	expectMsgWait "145: "
  WEND
ENDTC '237205






#############################################################################################################

'Advanced Test 2 - Drop & add participants
'Edited BY Weiling Chen
'aastra on a155-0138 the 10/15/2012 13:32:53
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 237206
  LOCAL title="Advanced Test 2(Speaker On) "
      ##### configuring phones  #####	 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
      ##### Initial state of the phones #####	         
	expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
     ##### Phone B is Calling Phone A  #####	  
	
	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"10: "  ' m1s57b  ' pseudo
    
    expectMsgWait "12: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
   
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"13: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
    #expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "25: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "26: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
     expectMsgWait
		wait 5000
     ##### Phone A Rings for 5s Then Answers  #####		
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"29: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "40: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    
	     expectMsgWait
		wait 1000
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	    expectMsgWait
		wait 1000	
 	       ##### Phone A is Calling Phone C  #####	    
	expectMsgSend SUBA,Do.Keys,SUBC.number,"68: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"69: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 1000	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "76: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "77: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
	      ##### Phone C Rings for 5s Then Answers  #####	
	 expectMsgWait
		wait 5000   
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"81: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"80: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
	      ##### Establishing a Conference between Phone A ,Phone B and Phone C #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"85: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    
	expectMsgWait
		wait 5000
	      ##### Phone A drops Phone C from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"90: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    
    expectMsgWait "95: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "98: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "100: "
	      ##### Phone C Hook On /Initial state for the Phone C #####	
   
   #expectMsgSend SUBC,Do.Hook,Hook.On,"123: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"111: "  ' m1s57c  ' pseudo
	expectMsgWait "112: "
		wait 5000   

	##### Start Making Another Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"127: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    
	expectMsgWait
	wait 1000
	##### Phone A is Calling Phone D  #####	  
	expectMsgSend SUBA,Do.Keys,SUBD.number,"145: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"146: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 1000	
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActiveBlink  ' m1s57d	
    expectMsgAdd SUBD,Do.Ringing,Ringing.Yes  ' m1s57d
    
    expectMsgWait "153: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57d
    expectMsgWait "154: "
    checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57d
    expectMsgAdd SUBD,Do.KeyMessage,Key.LightActiveBlink  ' m1s57d


     ##### Phone D Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
	#expectMsgSend SUBD,Do.Hook,Hook.Off,"157: "  ' m1s57d  ' pseudo
    #expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    #expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.F1,"156: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBD,Do.KeyLoudspeaker,Key.LightActive ' m1s57d
	expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
	expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
    expectMsgAdd SUBD,Do.Ringing,Ringing.Quiet  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		   ##### Establishing a Conference between Phone A ,Phone B and Phone D #####			
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"159: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"165: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"170: "  ' m1s57a  ' pseudo
   
   expectMsgWait
		wait 5000
	      ##### Phone A drops Phone D from the conference  #####	
		  

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"198: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 500	
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Disconnect  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
    expectMsgWait "205: "
    expectMsgWait "206: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
  	      ##### Phone D Hook On /Initial state for the Phone D #####	  
	expectMsgSend SUBD,Do.Hook,Hook.On,"207: "  ' m1s57d  ' pseudo
    expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
	expectMsgWait
	wait 5000  
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"210: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
		
	##### Start Making Another Conference Form Phone A  #####	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"211: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	expectMsgWait
	wait 3000	
	##### Phone A is Calling Phone E  #####	  
   '
    expectMsgSend SUBA,Do.Keys,SUBE.number,"230: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"231: "  ' m1s57a  ' pseudo
	expectMsgWait
		wait 1000	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBE,Do.KeyL1,Key.LightActiveBlink  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Yes  ' m1s57e
    
    expectMsgWait "238: "
    expectTextCheck SUBE,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57e
    expectMsgWait "239: "
    checkGetStateText SUBE,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57e
    expectMsgAdd SUBE,Do.KeyMessage,Key.LightActiveBlink  ' m1s57e
    'expectMsgAdd SUBE,Do.KeyMessage,Key.LightOff  ' m1s57e
	
     ##### Phone E Rings for 5s Then Answers  #####	
	expectMsgWait
		wait 5000
	#expectMsgSend SUBE,Do.Hook,Hook.Off,"242: "  ' m1s57e  ' pseudo
    #expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
    #expectMsgAdd SUBE,Do.Hook,Hook.Off  ' m1s57e
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.F1,"245: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBE,Do.KeyLoudspeaker,Key.LightActive ' m1s57e
	expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
	expectMsgAdd SUBE,Do.Connected,Connected.Yes  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Quiet  ' m1s57e
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	     expectMsgWait
		wait 1000
		
		      ##### Establishing a Conference between Phone A ,Phone B and Phone E #####			
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"259: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    
	expectMsgWait
		wait 5000
		
	      ##### Phone A drops Phone E from the conference  #####			

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"282: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBE,Do.KeyL1,Key.LightOff  ' m1s57e
    expectMsgAdd SUBE,Do.Connected,Connected.No  ' m1s57e
    'expectMsgAdd SUBE,Do.InbandTone,InbandTone.Disconnect  ' m1s57e
    expectMsgAdd SUBE,Do.InbandTone,InbandTone.Quiet  ' m1s57e
    
    expectMsgWait "289: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "290: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgWait "292: "
	
	      ##### Phone E Hook On /Initial state for the Phone E #####	
    #expectMsgSend SUBE,Do.Hook,Hook.On,"293: "  ' m1s57e  ' pseudo
    #expectMsgAdd SUBE,Do.Hook,Hook.On  ' m1s57e
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"295: "  ' m1s57e  ' pseudo

 expectMsgWait
		wait 5000   
	#expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"296: "  ' m1s57e  ' pseudo
  
  #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
  
	      ##### Ending The Calls /Phones Hook On /Initial state of the Phones #####	
  
    #expectMsgSend SUBB,Do.Hook,Hook.On,"297: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"300: "  ' m1s57b  ' pseudo
	expectMsgWait "302: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    
    
    expectMsgWait "304: "
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"313: "  ' m1s57b  ' pseudo
    expectMsgWait "315: "
    expectMsgWait "317: "
    #expectMsgSend SUBA,Do.Hook,Hook.On,"318: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"321: "  ' m1s57a  ' pseudo
    expectMsgWait
  WEND
ENDTC '237206






############################################################################################################
'Advanced Test 5 - Conf key interaction w/ conference
'Edited By Weiling Chen
'aastra on a155-0138 the 10/15/2012 10:15:31
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 237208
  LOCAL title="Advanced Test 5(Speaker On) "
  
      ##### configuring phones  #####	 
  
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	  
	   
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"6: "  ' m1s57d  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"7: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"8: "  ' m1s57e  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"9: "  ' m1s57e  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"10: "  ' m1s57b  ' pseudo
   
    expectMsgWait "12: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"13: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	'expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "25: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "26: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    
     ##### Phone A Rings for 5s Then Answers  #####	

	expectMsgWait "27: "
	wait 5000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"29: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"30: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "48: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
     expectMsgWait "48.5: "
		wait 5000    
		
	##### Start Making a Conference Form Phone A  #####	
		
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"49: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    
	    expectMsgWait
		wait 1000
	       ##### Phone A is Calling Phone C  #####	  
	
	expectMsgSend SUBA,Do.Keys,SUBC.number,"67: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"68: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "75: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "76: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
      ##### Phone C Rings for 5s Then Answers  #####	
  
   expectMsgWait "77: "
	wait 5000    
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"78: "  ' m1s57c  ' pseudo
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"80: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
     expectMsgWait "87: "
		wait 5000   
		
		 ##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
  
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"96: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	
 	       ##### Phone D is Calling Phone A  #####	  
  
   
    expectMsgSend SUBD,Do.Keys,SUBA.number,"109: "  ' m1s57d  ' pseudo
   
    expectMsgWait "111: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57d
       expectMsgWait "111.5: "
	wait 2000    
	#expectMsgSend SUBD,Do.Hook,Hook.Off,"112: "  ' m1s57d  ' pseudo
   #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"113: "  ' m1s57d  ' pseudo	
    #expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
   #expectMsgAdd SUBD,Do.Hook,Hook.Off  ' m1s57d
    expectMsgAdd SUBD,Do.KeyLoudspeaker,Key.LightActive ' m1s57d
	expectMsgAdd SUBD,Do.KeyL1,Key.LightActive ' m1s57d
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"120: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 1000
    #expectMsgAdd SUBD,Do.InbandTone,InbandTone.Dial  ' m1s57d
    'expectMsgAdd SUBD,Do.InbandTone,InbandTone.Alerting  ' m1s57d
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a

      
     ##### Phone A Rings for 5s Then Answers  #####	
	
	expectMsgWait "128: "
	wait 5000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"130: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Enquiry  ' m1s57a	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
   
    expectMsgWait "132: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57a
    expectMsgWait "133: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBD,Do.KeyL1,Key.LightActive  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.Yes  ' m1s57d
    expectMsgAdd SUBD,Do.InbandTone,InbandTone.Quiet  ' m1s57d
   
   
    expectMsgWait "161: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57d
    
      ##### Checking that Conf key is not functional when there is already an active conference  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"162: "  ' m1s57a  ' pseudo
      expectMsgWait "163: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57d
	    expectMsgWait
		wait 1000	
 expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"163: "  ' m1s57a  ' pseudo
        expectMsgWait "165: "
    expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57d
     expectMsgWait "167: "
		wait 5000	
		
	      ##### Phone A is going back to the line 1 #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"170: "  ' m1s57a  ' pseudo
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait
	wait 1000	
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "177: "
	wait 5000   
	
	##### Phone A Is Leaving The Recent Conference  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"187: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
   ' expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "192: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a (issure : on Hold but speaker LED is still on   )

    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2533"+JOCKER  ' m1s57a
   # expectMsgWait "199: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Daniel Dacascos"+JOCKER  ' m1s57a
 	
	##### Phone A is going back to the line 2 #####	
   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"200: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500	
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
     expectMsgWait "207: "
		wait 5000   
		
	##### Start Making a New Conference Form Phone A  #####	
		
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"209: "  ' m1s57a  ' pseudo
   	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
   
	    expectMsgWait
		wait 1000	      
	##### Phone A is Calling Phone E  #####	  

    expectMsgSend SUBA,Do.Keys,SUBE.number,"226: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"227: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgAdd SUBE,Do.KeyL1,Key.LightActiveBlink  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Yes  ' m1s57e
   
    expectMsgWait "234: "
    expectTextCheck SUBE,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57e
    expectMsgWait "235: "
    checkGetStateText SUBE,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57e
    expectMsgAdd SUBE,Do.KeyMessage,Key.LightActiveBlink  ' m1s57e
    'expectMsgAdd SUBE,Do.KeyMessage,Key.LightOff  ' m1s57e
    
	##### Phone E Rings for 5s Then Answers  #####	
	
	expectMsgWait "237: "
	wait 5000
	#expectMsgSend SUBE,Do.Hook,Hook.Off,"238: "  ' m1s57e  ' pseudo
    #expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
    #expectMsgAdd SUBE,Do.Hook,Hook.Off  ' m1s57e
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.F1,"23: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBE,Do.KeyLoudspeaker,Key.LightActive ' m1s57e
	expectMsgAdd SUBE,Do.KeyL1,Key.LightActive  ' m1s57e
	expectMsgAdd SUBE,Do.Connected,Connected.Yes  ' m1s57e
    expectMsgAdd SUBE,Do.Ringing,Ringing.Quiet  ' m1s57e
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgWait "247: "
	wait 5000    
	
	##### Establishing a Conference between Phone A ,Phone D and Phone E #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"255: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL2,Key.LightActive  ' m1s57a
    expectMsgWait "267: "
	wait 5000

	##### Phone B Hook On /Initial state for the Phone B #####	

	#expectMsgSend SUBB,Do.Hook,Hook.On,"268: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"250: "  ' m1s57b  ' pseudo
	expectMsgWait "253: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"257: "  ' m1s57b  ' pseudo
    expectMsgWait "258: "
	##### Phone C Hook On /Initial state for the Phone C #####	

	#expectMsgSend SUBC,Do.Hook,Hook.On,"286: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"262: "  ' m1s57c  ' pseudo
	expectMsgWait "265: "
	wait 1000
	
	#expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"289: "  ' m1s57c  ' pseudo
 

	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	
	##### Phone A Is Leaving The Recent Conference  #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"290: "  ' m1s57a  ' pseudo
	expectMsgWait "292: "
	wait 1000
    expectMsgAdd SUBA,Do.KeyL2,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
   'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "297: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	
	##### Phone D Hook On /Initial state for the Phone D #####	

    #expectMsgSend SUBD,Do.Hook,Hook.On,"298: "  ' m1s57d  ' pseudo
   	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"300: "  ' m1s57d  ' pseudo
	expectMsgWait "302: "
	wait 1000
   expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "303: "
	wait 5000   
   #expectMsgAdd SUBD,Do.Hook,Hook.On  ' m1s57d
    expectMsgAdd SUBD,Do.KeyL1,Key.LightOff  ' m1s57d
    expectMsgAdd SUBD,Do.Connected,Connected.No  ' m1s57d
    expectMsgAdd SUBE,Do.KeyL1,Key.LightOff  ' m1s57e
    expectMsgAdd SUBE,Do.Connected,Connected.No  ' m1s57e
    'expectMsgAdd SUBE,Do.InbandTone,InbandTone.Disconnect  ' m1s57e
    expectMsgAdd SUBE,Do.InbandTone,InbandTone.Quiet  ' m1s57e
    expectMsgWait "313: "
    expectMsgWait "315: "
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"316: "  ' m1s57d  ' pseudo
    expectMsgWait "318: "
    #expectMsgSend SUBE,Do.Hook,Hook.On,"319: "  ' m1s57e  ' pseudo
    #expectMsgAdd SUBE,Do.Hook,Hook.On  ' m1s57e
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"320: "  ' m1s57e  ' pseudo
	expectMsgWait "322: "
	wait 1000
	
	#expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"322: "  ' m1s57e  ' pseudo
    #expectMsgSend SUBA,Do.Hook,Hook.On,"323: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"325: "  ' m1s57a ' pseudo
	expectMsgWait "326: "
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"327: "  ' m1s57a  ' pseudo
    expectMsgWait
  WEND
ENDTC '237208








################################################################################

'Verify that you can swap calls before the conference is completed
'Edited By Weiling Chen
'aastra on a155-0138 the 10/16/2012 09:47:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237211
  LOCAL title="Advanced Test 8(Speaker On)"
  
 		##### configuring phones  #####	 
 
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

     ##### Initial state of the phones #####	 
  
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
   
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	'expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    
	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "24: "
	wait 5000
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    #expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "44.5: "
	wait 5000

	##### Start Making a Conference Form Phone A  #####	
		
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	    expectMsgWait
		wait 1000	       
	##### Phone A is Dailing Phone C  #####

    
    expectMsgSend SUBA,Do.Keys,SUBC.number,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"66: "  ' m1s57a  ' pseudo
    wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "70: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "71: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
   
	##### Phone C Rings for 5s Then Answers  #####	

	expectMsgWait "74: "
	wait 5000
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"75: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"81: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "92: "
	wait 3000
	#stone 
	#104.160.131.3
	##### Press line 1 to swap calls ##### 
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold,"93: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 500
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait "100: "
	wait 1000
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"110: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgWait "122: "
	wait 7000
	
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	

	##### Phone B Hook On /Initial state for the Phone B #####	
	
	#expectMsgSend SUBB,Do.Hook,Hook.On,"123: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"153: "  ' m1s57b ' pseudo
	expectMsgWait "155: "
	wait 1000
	
    
	##@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "126: " 
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "136: "
    
    
    expectMsgWait "137: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"138: "  ' m1s57b  ' pseudo
     expectMsgWait "139: "
	wait 5000
	
	##### Phone A Hook On /Initial state for the Phone A #####	

	#expectMsgSend SUBA,Do.Hook,Hook.On,"140: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"153: "  ' m1s57a ' pseudo
	expectMsgWait "155: "
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "154: "
    expectMsgWait "156: "
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"157: "  ' m1s57a  ' pseudo

	##### Phone C Hook On /Initial state for the Phone C #####	
    
	#expectMsgSend SUBC,Do.Hook,Hook.On,"158: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"153: "  ' m1s57c ' pseudo
	expectMsgWait "155: "
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"161: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237211






################################################################################

'Advanced Test 9 - Using speeddial on 2nd leg
'Edited By Weiling Chen
'aastra on a155-0138 the 10/16/2012 11:04:10
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237212
  LOCAL title="Advanced Test 9(Speaker On)"
  
  		##### configuring phones  #####	 

  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
  
       ##### Initial state of the phones #####	

    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
   
     ##### Phone B is Calling Phone A  #####	  

   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
   
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	'expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a

	##### Phone A Rings for 5s Then Answers  #####		      
    
	expectMsgWait "25: "
	wait 5000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"27: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
  
    expectMsgWait "46: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "46.5: "
	wait 5000   
	
	##### Start Making a Conference Form Phone A  #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"47: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
	
	##### Phone A is Calling Phone C Using SpeedDial#####
 	expectMsgWait
	wait 2000    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"64: "  ' m1s57a  ' pseudo
	    expectMsgWait
		wait 2000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"65: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000  
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "72: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "73: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c

	##### Phone C Rings for 5s Then Answers  #####	
    
	expectMsgWait "75: "
	wait 5000   
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"76: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "85: "
	wait 5000   
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"93: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
       expectMsgWait "95: "
		wait 5000   
    
    
    expectMsgWait "101: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b	
	

	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	##### Phone B Hook On /Initial state for the Phone B #####	

	#expectMsgSend SUBB,Do.Hook,Hook.On,"106: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57b ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"114: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgWait "117: "
    
    
    expectMsgWait "117.5: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"'SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "119: "
	wait 5000   
	
	##### Phone A Hook On /Initial state for the Phone A #####	
	
	#expectMsgSend SUBA,Do.Hook,Hook.On,"120: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57a ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"129: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
    ''expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgWait "135: "
   
	##### Phone C Hook On /Initial state for the Phone C #####	
   
	#expectMsgSend SUBC,Do.Hook,Hook.On,"138: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57c ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"141: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237212






##################################################################################################

'Advanced Test 10 - Using BLF on 2nd leg
'Edited By Weiling Chen
'aastra on a155-0138 the 10/16/2012 11:35:38
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 237213
  LOCAL title="Advanced Test 10(Speaker On)"

  ##### configuring phones  #####	 
  
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 
      ##### Initial state of the phones #####	 

    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"2: "  ' m1s57b  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"3: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"4: "  ' m1s57c  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"5: "  ' m1s57c  ' pseudo
 
     ##### Phone B is Calling Phone A  #####	  
	
	
    expectMsgSend SUBB,Do.Keys,SUBA.number,"6: "  ' m1s57b  ' pseudo
    
    expectMsgWait "8: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #expectMsgSend SUBB,Do.Hook,Hook.Off,"9: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b
    #expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000
	#expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
    expectMsgWait "21: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    expectMsgWait "22: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
   
	##### Phone A Rings for 5s Then Answers  #####		      

	expectMsgWait "23: "
	wait 5000
	#expectMsgSend SUBA,Do.Hook,Hook.Off,"25: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b
    
    
    expectMsgWait "44: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"'SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "44.5: "
	wait 5000   

	##### Start Making a Conference Form Phone A  #####	
	
   expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"45: "  ' m1s57a  ' pseudo
	expectMsgWait "219: "
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	    expectMsgWait
		wait 1000	
 	##### Press the concerned BLF key on Phone A to call Phone C #####	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U10,"62: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c
    
    expectMsgWait "80: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgWait "81: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57c
    'expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57c
   
	##### Phone C Rings for 5s Then Answers  #####	

   expectMsgWait "83: "
	wait 5000 
	#expectMsgSend SUBC,Do.Hook,Hook.Off,"84: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.Off  ' m1s57c
    #expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"33: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57c	
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57c
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgWait "100: "
	wait 5000  
	
	##### Establishing a Conference between Phone A ,Phone B and Phone C #####	
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"113: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveRecall  ' m1s57a
    'expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
	
	##### Phone A Is Leaving The Conference  #####	
	
    expectMsgWait "120: "
	wait 5000   
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"126: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    'expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    expectMsgWait "140: "
    ##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "143: "
	wait 5000
    
	##### Ending The conference /Phones Hook On /Initial state of the Phones #####	
	##### Phone A Hook On /Initial state for the Phone A #####	
	
	#expectMsgSend SUBA,Do.Hook,Hook.On,"144: "  ' m1s57a  ' pseudo
    #expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57a ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a	
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"147: "  ' m1s57a  ' pseudo
    expectMsgWait "147.5: "
	wait 5000   

	##### Phone B Hook On /Initial state for the Phone B #####	
	
	#expectMsgSend SUBB,Do.Hook,Hook.On,"148: "  ' m1s57b  ' pseudo
    #expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57b ' pseudo
	expectMsgWait "161: "
	wait 1000
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b
    expectMsgAdd SUBA,Do.KeyF10,Key.LightOff  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightOff  ' m1s57c
    expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57c
   ' 'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Disconnect  ' m1s57c
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Quiet  ' m1s57c
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"162: "  ' m1s57b  ' pseudo
    expectMsgWait "164: "
 	##### Phone C Hook On /Initial state for the Phone C #####	

	#expectMsgSend SUBC,Do.Hook,Hook.On,"167: "  ' m1s57c  ' pseudo
    #expectMsgAdd SUBC,Do.Hook,Hook.On  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"160: "  ' m1s57c ' pseudo
	expectMsgWait "161: "
	wait 1000
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"170: "  ' m1s57c  ' pseudo
    expectMsgWait
  WEND
ENDTC '237213





###################################################################################################

## 250_Far_End_Bye_BROADSOFT 

#######################################################################

'TC 250100- Far_End_Bye_Configuration
'Edited by Weiling Chen
'aastra on A155-0389 the 10/19/2012 16:57:07
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  SUBE(m1s57e)  
TESTCASE 250100
  LOCAL title="TC257100-Far_End_Bye_Configuration"
  LOCAL count=0
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
    
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U11,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U11,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U11,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U11,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U11,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 3000
	
	REPEAT
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	count = count+1	
	
	UNTIL count = 25
	expectMsgWait
	wait 2000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"5: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"6: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"8: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"9: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 2000
	
  WEND
ENDTC '250100







####################################################################################################

'Clearing the Directory and the Callers List
'Edited by Weiling Chen
'aastra on a155-0138 the 10/11/2012 16:09:57
'  SUBA(m1s57a)  SUBB(m1s57b)  
TESTCASE 2501001
  LOCAL title="TC2501001-Clearing the Directory and the Callers List"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
          #### Initial State of the Phones ####
  
  expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBE,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
		wait 1000

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"1: "  ' m1s57e  ' pseudo
		wait 1000
		
		
		#### Clearing Directory ####

    # expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57a  ' pseudo
    # expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57b  ' pseudo
    # expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57c  ' pseudo
    # expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57d  ' pseudo
    # expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"2: "  ' m1s57e  ' pseudo
		# wait 1000

    # expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57a  ' pseudo
    # expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57b  ' pseudo
    # expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57c  ' pseudo
    # expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57d  ' pseudo
    # expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"3: "  ' m1s57e  ' pseudo
		# wait 1000

    # expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57a  ' pseudo
    # expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57b  ' pseudo
    # expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57c  ' pseudo
    # expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57d  ' pseudo
    # expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"7: "  ' m1s57e  ' pseudo
		# wait 3000

    # expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57a  ' pseudo
    # expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57b  ' pseudo
    # expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57c  ' pseudo
    # expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57d  ' pseudo
    # expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57e  ' pseudo
    # expectMsgWait "10: "

wait 3000	
	 expectMsgWait "11: "
	#### Clearing Callers list /Initial staate of the Phones ####

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U8,"12: "  ' m1s57e  ' pseudo
    expectMsgWait "14: "
		wait 1000

    expectMsgWait "15: "
	#Press Delete
    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"16: "  ' m1s57e  ' pseudo
	'	wait 1000

	#Press DeleteList to erase all items

	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"21: "  ' m1s57e  ' pseudo
	#wait 1000
	'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"21: "  ' m1s57e  ' pseudo
	'wait 1000
			
    'expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57a  ' pseudo
    'expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57b  ' pseudo
    'expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57c  ' pseudo
    'expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57d  ' pseudo
    'expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"23: "  ' m1s57e  ' pseudo
    'expectMsgWait "26: "
	'wait 3000	
    #expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57a  ' pseudo
    #expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57b  ' pseudo
    #expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57c  ' pseudo
    #expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57d  ' pseudo
    #expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"9: "  ' m1s57e  ' pseudo	
	#wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.End,"27: "  ' m1s57e  ' pseudo
    expectMsgWait
	wait 1000

  WEND
ENDTC '2501001








###########################################################################################
'
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250101
 LOCAL count=0
  LOCAL title="TC150101-Single Active Call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d" 
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off Phone B to call Phone A
	expectMsgSend SUBB,Do.Hook,Hook.Off,"8: "  
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  
    expectMsgAdd SUBB,Do.Hook,Hook.Off  
    expectMsgSend SUBB,Do.Keys,SUBA.number  
    expectMsgWait "15: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
    expectMsgWait "19: "
	wait 2000
	
	#Check Display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
	#Hook Off Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"21: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	wait 1000
	
	#Press Goodbye on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No  ' m1s57b  ' pseudo
    wait 2000
	
	#Check for Call Terminated Msg on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a

	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#send SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250101






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250102
 LOCAL count=0
  LOCAL title="TC150102-Single Active Call On Hold"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off Phone B to call Phone A  
    expectMsgSend SUBB,Do.Keys,SUBA.number  
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off  
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
	#Press Dial
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
    expectMsgWait "19: "
	wait 2000
	
	#Check Display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
	#Answer Call on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"21: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	wait 1000
	
	#Place Inbound Call on Hold
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold
	expectMsgWait
	wait 4000
	
	#End Call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No  ' m1s57b  ' pseudo
    wait 2000
	
	#Check for Call Terminated Msg on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a

	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#send SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250102






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250103
 LOCAL count=0
  LOCAL title="TC150103-Single Active Call Not In Focus"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off Phone B to call Phone A  
    expectMsgSend SUBB,Do.Keys,SUBA.number  
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off  
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
	#Press Dial
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
    expectMsgWait "19: "
	wait 2000
	
	#Check Display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
	#Answer Call on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"21: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	wait 1000
	
	#Switch focus to L2 on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 4000
	
	#End Call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No  ' m1s57b  ' pseudo
	
	#Check for Disconnect Tone
	#expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect ' m1s57a
	
	#Switch focus to L1 on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Left
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Left
	wait 1000
	
	#Check for Call Terminated Msg on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER  ' m1s57a

	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#send SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250103






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250104
 LOCAL count=0
  LOCAL title="TC150104-Single Active Call on Hold Not In Focus"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off Phone B to call Phone A  
    expectMsgSend SUBB,Do.Keys,SUBA.number  
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off  
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
	#Press Dial
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"16: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    #@#expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  
    expectMsgWait "19: "
	wait 2000
	
	#Check Display on Phone A
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	
	#Answer Call on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"21: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
	wait 1000
	
	#Place Active call on Hold and swicth focus to L2
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	expectMsgWait
	wait 4000
	
	#End Call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On  ' m1s57b  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No  ' m1s57b  ' pseudo
    wait 2000
	
	#Check for Disconnect Tone
	#expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
	
	#Switch focus to L1 on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Left
	#expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Left
	wait 1000
	
	#Check for Call Terminated Msg on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER  ' m1s57a

	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#send SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250104






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 2501051
 LOCAL count=0
  LOCAL title="TC150105-One call on hold, one call active, release active call from far end"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off Phone A to call Phone B  
    expectMsgSend SUBA,Do.Keys,SUBB.number  
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgSend SUBA,Do.Hook,Hook.Off
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    wait 1000
	
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    #@#expectMsgAdd SUBB,Do.Ringing,Ringing.Yes
	expectMsgAdd SUBB,Do.Ringing,Ringing.Yes
    expectMsgWait "19: "
	wait 2000
	
	#Check Display on Phone B
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
	
	#Answer Call on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"21: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgWait "22: "
	wait 1000
	
	#Place Active call on Hold and swicth focus to L2
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold
	expectMsgWait "23"
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2
	
	#Phone A calls Phone C
	expectMsgSend SUBA,Do.Keys,SUBC.number  
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgSend SUBA,Do.Hook,Hook.Off
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    wait 1000

	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Yes  ' m1s57c    
    expectMsgWait "24: "
	wait 2000

	#Check Display on Phone C
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 3000
	
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	
	#End Call on Phone C
	#expectMsgSend SUBC,Do.Hook,Hook.On  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1  ' m1s57c  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End  ' m1s57c  ' pseudo
    wait 1000
	
	#Check for Disconnect Tone
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
	#Check for Call Terminated Msg on Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER  ' m1s57a

	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#send SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '2501051






######################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250106
 LOCAL count=0
  LOCAL title="TC150106-One call on hold, one call active, release on hold call from far end"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Switch focus to L2 on Phone A and dial Phone C's number
	expectMsgSend SUBA,Do.KeyL2,Key.Click
	expectMsgWait
	wait 2000
	
	#Dial Phone C
	expectMsgSend SUBA,Do.Keys,SUBC.number
	expectMsgSend SUBA,Do.KeyL2,Key.Click
	expectMsgWait
	wait 1000
	
	#Check Call Display on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
	expectMsgWait
	wait 2000
	#End Call on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	wait 1000
	
	#Check Display on Phone A
	#@#checkGetStateText SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER  ' m1s57a
	wait 1000

	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#send SUBA,Do.Hook,Hook.On
	expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250106







#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250107
 LOCAL count=0
  LOCAL title="TC250107-One call on hold, one call active, release active call from far end and locally"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Switch focus to L2 on Phone A and dial Phone C's number
	expectMsgSend SUBA,Do.KeyL2,Key.Click
	expectMsgWait
	wait 2000
	
	#Dial Phone C
	expectMsgSend SUBA,Do.Keys,SUBC.number
	expectMsgSend SUBA,Do.KeyL2,Key.Click
	wait 1000
	
	#Check Call Display on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57c
	expectMsgWait
	wait 1000
	
	#Answer the call on Phone C
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Press Goodbye on Phone C check for Call Terminated Msg then Press Goodbye on Phone A
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgWait
	wait 1000
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER  ' m1s57a
	expectMsgWait
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	#expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	

	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#send SUBA,Do.Hook,Hook.On
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250107








#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250108
 LOCAL count=0
  LOCAL title="TC250108-Application in focus"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Press Option Key on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Menu	
	expectMsgWait 
	wait 2000
	
	#End call on Phone C
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 2000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect
	expectMsgWait
	wait 5000
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250108






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250109
 LOCAL count=0
  LOCAL title="TC250109-Application in focus stopped"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Press Option Key on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Menu	
	expectMsgWait 
	wait 2000
	
	#End call on Phone C
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER  ' m1s57a
	expectMsgWait
	wait 3000
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250109






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250110
 LOCAL count=0
  LOCAL title="TC250110-Handling of keys - Hard goodbye key"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#End call on Phone C
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect
	expectMsgWait
	wait 1000
	
	#Check for Call Terminated Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait 
	wait 1000
	
	#Press Goodbye on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250110






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250111
 LOCAL count=0
  LOCAL title="TC250111-Handling of keys - idle hard line key"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#End call on Phone C
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect
	expectMsgWait
	wait 1000
	
	#Check for Call Terminated Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait 
	wait 1000
	
	#Switch to an idle Line
	expectMsgSend SUBA,Do.KeyL2,Key.Click
	expectMsgWait
	wait 1000
	
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial
	expectMsgWait 
	wait 1000
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000		
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250111






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250112
 LOCAL count=0
  LOCAL title="TC250112-Handling of incoming call on disconnected line - no call on hold"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Call Phone A from Phone C
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#End call on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	expectMsgWait
	wait 1000
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250112






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250113
 LOCAL count=0
  LOCAL title="TC250113-Handling of incoming call on disconnected line - call on hold"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Call Phone A from Phone C
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#End call on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	expectMsgWait
	wait 1000
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250113






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250114
 LOCAL count=0
  LOCAL title="TC 250114 - Handling of incoming call on disconnected line - call on hold"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 2000
	
	#Place Call on Hold
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold
	expectMsgWait
	wait 1000
	
	#Call Phone A from Phone C
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#Check display on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	expectMsgWait
	wait 1000
	
	#Answer Call on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 3000
	
	#End Call on Phone C
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 3000
	
	#Redial Phone A from Phone 
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Redialing
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Redialing
	expectMsgWait
	wait 2000
	
	#Check states of phone A
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER
	expectMsgWait
	wait 2000
	
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000		
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250114






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250115
 LOCAL count=0
  LOCAL title="TC 250115 - Handling of incoming call - on a different line than the disconnected line"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000
	
	#End Call From Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Call Phone A from Phone C
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#Check display on Phone A
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	expectMsgWait
	wait 1000
	
	#Answer Call on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 3000
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250115






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 2501161
 LOCAL count=0
  LOCAL title="TC 250116 -An active call is blind xfer by pressing xfer - there is active call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone A to call Phone B 
	expectMsgSend SUBA,Do.Keys,SUBB.number
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgAdd SUBA,Do.Hook,Hook.Off
	expectMsgSend SUBA, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Answer the call on Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000
	
	#Phone A places call on Hold
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold
	expectMsgWait
	wait 1000
	
	#Call Phone A from Phone C
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#Check display on Phone A
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	expectMsgWait
	wait 1000
	
	#Answer Call on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 3000
	
	#Initiate Blind Transfer to Phone D
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBD.number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait 
	wait 1000
	
	#Check Phone D display
	expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER
	expectMsgWait
	wait 1000
	
	#Check Phone A display
	send SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgWait
	wait 1000
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait
	wait 1000
	
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '2501161






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 2501171
 LOCAL count=0
  LOCAL title="TC 250117-An active call is blind xfer by pressing xfer - there is no active call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone B to call Phone A 
	expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off
	expectMsgSend SUBB, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000
	
	#Phone A starts blind transfer to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBC.number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Phone C answers Call
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check for Call Transferred Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER
	expectMsgWait
	wait 5000

	#Check for Call Terminated Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait
	wait 1000
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '2501171






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250118
 LOCAL count=0
  LOCAL title="TC 250118-An active call is attended xfer by pressing xfer - there is active cal"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone B to call Phone A 
	expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off
	expectMsgSend SUBB, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000
	
	#Phone A starts attended transfer to Phone C
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBC.number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone C
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER	
	
	#Phone C answers Call
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#Phone A completes Transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	#Check for Call Transferred Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER
	expectMsgWait
	wait 5000

	#Check for Call Terminated Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait
	wait 1000
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250118






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250119
 LOCAL count=0
  LOCAL title="TC 250119-An active call is attended xfer by pressing Goodbye - there is active call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone B to call Phone A 
	expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgSend SUBB,Do.Hook,Hook.Off
	wait 1000
	expectMsgAdd SUBB,Do.Hook,Hook.Off
	expectMsgSend SUBB, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000
	
	#Hook Off Phone C to call Phone A 
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgAdd SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER	
	
	
	#Phone A answers the call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#Phone A starts attended Transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBD.number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone D
	expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER
	expectMsgWait
	wait 1000
	
	#Phone D answers
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Phone A presses Goodbye to complete attended transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Check for Call Transferred Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER
	expectMsgWait
	wait 5000

	#Check for Call Terminated Msg
	##@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER
	#expectMsgWait
	#wait 1000
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000		
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250119






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250120
 LOCAL count=0
  LOCAL title="TC 250120-An active call is attended xfer by pressing Goodbye - there is no active call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone B to call Phone A 
	expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off
	expectMsgSend SUBB, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000
	
	#Phone A starts Transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBC.number
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER
	expectMsgWait
	wait 1000
	
	#Phone C answers
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Phone A presses Goodbye to complete attended transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
	#Check for Call Transferred Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER
	expectMsgWait
	wait 5000

	#Check for Call Terminated Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait
	wait 1000
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250120






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250121
 LOCAL count=0
  LOCAL title="TC 250121-An active call is attended xfer by handset on hook- there is active call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone B to call Phone A 
	expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgSend SUBB,Do.Hook,Hook.Off
	wait 1000
	expectMsgAdd SUBB,Do.Hook,Hook.Off
	expectMsgSend SUBB, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000
	
	#Hook Off Phone C to call Phone A 
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	wait 1000
	expectMsgAdd SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER	
	
	
	#Phone A answers the call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 2000
	
	#Phone A starts attended Transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBD.number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone D
	#expectTextCheck SUBD,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#checkGetStateText SUBD,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER
	expectMsgWait
	wait 1000
	expectMsgWait
	wait 1000
	
	#Phone D answers
	expectMsgSend SUBD,Do.Hook,Hook.Off
	expectMsgWait
	wait 1000
	
	#Phone A hangs up to complete transfer
	expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgWait
	wait 1000
	
	#Check for Call Transferred Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER
	expectMsgWait
	wait 5000	

	#Check for Call Terminated Msg
	send SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgWait
	wait 1000
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait 
	wait 1000
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000		
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250121






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250122
 LOCAL count=0
  LOCAL title="TC 250122-An active call is attended xfer by handset on hook- there is no active call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone B to call Phone A 
	expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off
	expectMsgSend SUBB, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000

	
	#Phone A starts attended Transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBC.number
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone C
	#expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	#checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER
	expectMsgWait
	wait 1000
	
	#Phone C answers
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgWait
	wait 1000
	
	#Phone A hangs completes transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	#Check for Call Transferred Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER
	expectMsgWait
	wait 5000

	#Check for Call Terminated Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait 
	wait 1000
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250122






#########################################################################################################

'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 2501231
 LOCAL count=0
  LOCAL title="TC 2501231-An active call is one button xfer by pressing xfer - there is active call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
		expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone C to call Phone A 
	expectMsgSend SUBC,Do.Keys,SUBA.number
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgAdd SUBC,Do.Hook,Hook.Off
	expectMsgSend SUBC, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000

	
	#Phone A starts attended Transfer
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U6 
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3
	expectMsgWait
	wait 1000
	
	
	#Check Call dsiplay on Phone B
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2532"+JOCKER
	#@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER
	expectMsgWait
	wait 1000
	
	#Check for Call Transferred Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER
	expectMsgWait
	wait 5000

	#Check for Call Terminated Msg
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Terminated"+JOCKER
	expectMsgWait
	wait 1000
	
	#PhoneB answers
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait 
	wait 1000
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '2501231






#########################################################################################################
'pvaastra on bos-bgalasso the 02/15/2012 13:49:25
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 250124
 LOCAL count=0
  LOCAL title="TC 250124-Regression Conference call"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"3: "  ' m1s57d  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"7: "  ' m1s57d  ' pseudo
    wait 5000
	
	#Hook Off Phone B to call Phone A 
	expectMsgSend SUBB,Do.Keys,SUBA.number
	expectMsgSend SUBB,Do.Hook,Hook.Off
	expectMsgAdd SUBB,Do.Hook,Hook.Off
	expectMsgSend SUBB, Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	#Check Call dsiplay on Phone A
	#@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER	
	
	#Answer the call on Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off
	expectMsgWait
	wait 4000

	
	#Phone A starts Conference
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBA,Do.Keys,SUBC.number
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1
	expectMsgWait
	wait 1000
	
	
	#Check Call dsiplay on Phone C
	# expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER
	# checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER
	expectMsgWait
	wait 1000
	
	#PhoneC answers
	expectMsgSend SUBC,Do.Hook,Hook.Off
	expectMsgWait
	wait 1000
	
	#Complete the Conference Call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2
	expectMsgWait
	wait 4000

	#Press Goodbye on Phone C
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End
	expectMsgWait 
	wait 1000
	
	#Check State of Phone A
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER
	expectMsgWait
	wait 1000
	
	#Press Goodbye on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End
	expectMsgWait
	wait 1000
	
		
	#Initial state of phones
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No
	
	#### Hooking on ####
	#expectMsgSend SUBA,Do.Hook,Hook.On
	expectMsgSend SUBB,Do.Hook,Hook.On
	expectMsgSend SUBC,Do.Hook,Hook.On	
	expectMsgSend SUBD,Do.Hook,Hook.On	
	expectMsgWait
	wait 1000	
	
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '250124






#################################################################################

'TC130-TopKeys LED's
'
'pvaastra on bos-bgalasso the 02/13/2012 13:12:22
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 401130
  LOCAL title="TC101130-TopKeys LED's"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	wait 1000
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U10,"3: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyF10,Key.LightActive  ' m1s57a
    wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U10,"5: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyF10,Key.LightOff ' m1s57a
    expectMsgWait
  WEND
ENDTC '401130






#######################################################################################

'TC134-Redial
### 28 Sep 2015, Hong Dao, Add press right commands after pressing redial keys.
'
'pvaastra on bos-bgalasso the 02/13/2012 15:54:16
'  SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  
TESTCASE 401134
  LOCAL count=0
  LOCAL title="TC101134-Redial"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)
   REPEAT  
  	RECINFO "Count : "+count 
	#Hook On
    expectMsgSend SUBA,Do.Hook,Hook.On,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"2: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Press GoodBye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"5: "  ' m1s57c  ' pseudo
    wait 1000
	
	#Hook Off Phone A to call Phone B
	expectMsgSend SUBA,Do.Hook,Hook.Off,"6: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a   
    expectMsgSend SUBA,Do.Keys,SUBB.number,"13: "  ' m1s57a  ' pseudo    
    expectMsgWait "14: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a    
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgWait "22: "
    
	#Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "23: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
    wait 2000
		
	#Hook Off Phone B
	expectMsgSend SUBB,Do.Hook,Hook.Off,"25: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightOff  ' m1s57b   
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b  
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b 
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a    
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #'number '^C9057604202' found in pco 'm1s57b' (9057604202) -> "^C"+SUBB.number
    #'number '9057604202^C9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number+"^C"+SUBB.number
    expectMsgWait "45: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 2000
	
	#Hook On Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"46: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b    
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a   
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "60: "  
    expectMsgWait "62: "    
    expectMsgSend SUBA,Do.Hook,Hook.On,"63: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
	
	#Press Redial
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Redialing,"66: "  ' m1s57a  ' pseudo
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right
	wait 1000
    #'number '9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number
    expectMsgWait "68: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    
	#Hook Off Phone A
	expectMsgSend SUBA,Do.Hook,Hook.Off,"70: "  ' m1s57a  ' pseudo   
    expectMsgAdd SUBA,Do.Hook,Hook.Off  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightOff  ' m1s57a    
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActiveBlink  ' m1s57b
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Alerting  ' m1s57a
    expectMsgAdd SUBB,Do.Ringing,Ringing.Yes  ' m1s57b
    'number '9057604201' found in pco 'm1s57a' (9057604201) -> SUBA.number
    expectMsgWait "84: "
    
	#Check Phone B's display
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait "85: "
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Andy Anderson"+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.KeyMessage,Key.LightActiveBlink  ' m1s57b
	wait 2000
	
	#Hook Off Phone B
    expectMsgSend SUBB,Do.Hook,Hook.Off,"88: "  ' m1s57b  ' pseudo    
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b  
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.Ringing,Ringing.Quiet  ' m1s57b
    expectMsgAdd SUBB,Do.Hook,Hook.Off  ' m1s57b    
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a  
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    #'number '^C9057604202' found in pco 'm1s57b' (9057604202) -> "^C"+SUBB.number
    #'number '9057604202^C9057604202' found in pco 'm1s57b' (9057604202) -> SUBB.number+"^C"+SUBB.number
    expectMsgWait "107: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    wait 2000
	
	#Hook On Phone B
	expectMsgSend SUBB,Do.Hook,Hook.On,"108: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57b 
    expectMsgAdd SUBB,Do.Hook,Hook.On  ' m1s57b 
    expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a   
    expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
    expectMsgSend SUBA,Do.Hook,Hook.On,"119: "  ' m1s57a  ' pseudo
    ##expectMsgAdd SUBA,Do.InbandTone,InbandTone.Disconnect  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
    expectMsgWait "123: " 
    expectMsgWait "125: "    
    expectMsgAdd SUBA,Do.Hook,Hook.On  ' m1s57a
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"128: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"129: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"130: "  ' m1s57c  ' pseudo
    expectMsgWait
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '401134






###############################################################################################################################
'Verify ringing and MWI on second incoming call after dropping the first call drop 1st call by pressing Goodbye
'Edited By Weiling Chen
'pvaastra on bos-bgalasso the 10/24/2012 14:27:23
' SUBA(m1s57a)  SUBB(m1s57b)  SUBC(m1s57c)  SUBD(m1s57d)  
TESTCASE 401138
  LOCAL count=0
  LOCAL title="TC 101138-Verify ringing and MWI on second incoming call after dropping the first call drop 1st call by pressing Goodbye"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d"
  WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())
 	REPEAT  
	RECINFO "Count : "+count  
	#Press GOODBYE
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    wait 500
	
	#Hook ON
	expectMsgSend SUBA,Do.Hook,Hook.On,"4: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.Hook,Hook.On,"6: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.Hook,Hook.On,"7: "  ' m1s57d  ' pseudo
	wait 1000
	
	#Press L1 on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.KeyL1,Key.LightActive ' m1s57b
	expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b
	expectMsgWait
    expectMsgSend SUBB,Do.Keys,SUBA.number  ' m1s57b  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 2000
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+"2531"+JOCKER  ' m1s57a
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    wait 1000
	
	#Phone A answers in handsfree mode
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"21: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Quiet  ' m1s57b 
	#@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57b
    expectMsgWait
	wait 1000
	
	#Phone A put the call on hold
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Hold,"26: "  ' m1s57a  ' pseudo
	wait 1000
	'expectMsgAdd SUBA,Do.Connected,Connected.Hold  ' m1s57a
	
	#Phone C calls Phone from L1, Verify LED flashing on L2
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57c  ' pseudo
	expectMsgWait
	wait 500
	expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive ' m1s57c
	expectMsgAdd SUBC,Do.KeyL1,Key.LightActive ' m1s57c
	'expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
	expectMsgWait
    expectMsgSend SUBC,Do.Keys,SUBA.number  ' m1s57c  ' pseudo
	expectMsgWait
	wait 1000	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"15: "  ' m1s57c  ' pseudo
	expectMsgWait
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57c
	expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+"2530"+JOCKER  ' m1s57c
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
	wait 2000
	
	#Phone A unhold the 1st call from Phone B on L1, then verify LED lights again
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F1,"8: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 1000
	expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a	
	expectMsgAdd SUBA,Do.KeyL1,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
	expectMsgWait
	wait 2000

	
	#Phone A press "Goodbye" to drop the 1st call on L1 
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
	wait 1000
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57b
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActiveBlink ' m1s57a
	
	wait 2000
	#Phone A Press L2 to answer the call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.F2,"8: "  ' m1s57a  ' pseu
	expectMsgAdd SUBA,Do.KeyL2,Key.LightActive ' m1s57a
	expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57c
	expectMsgAdd SUBA,Do.Connected,Connected.Yes
	wait 2000
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"62: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"63: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"64: "  ' m1s57d  ' pseudo
	expectMsgWait
	wait 2000
	count=count+1 
	UNTIL count=1
  WEND
ENDTC '401138





##################################################################################################
'TC 411101- Basic Metaswitch Park/Pickup Testcase
TESTCASE 411101
  LOCAL title="411101- Basic Metaswitch Park/Pickup Testcase"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)

# Press Goodbye Key
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57e  ' pseudo
    wait 1000
	
# Ensure Hook ON

	expectMsgSend SUBC,Do.Hook,Hook.On,"3: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"5: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"5: "  ' m1s57e  ' pseudo

	
# Press L1 on Phone B to call Phone A

	expectMsgSend SUBB,Do.KeyL1,Key.Click,"45: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"46: "  ' m1s57b  ' pseudo   
    expectMsgWait "47: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
#Press Dial
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"48: "  ' m1s57b  ' pseudo    
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "49: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "50: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait
	wait 2000
	
# Press L1 on Phone A to pick up the call
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"51: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "52: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 2000

# Press xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"53: "  ' m1s57a  ' pseudo
	wait 2000
	
# Dial *301 to park the call
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
	wait 2000
	expectMsgSend SUBA,Do.Keys,"*301","54: "  ' m1s57a  ' pseudo
    expectMsgWait "55: "
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"56: "  ' m1s57a  ' pseudo
	expectMsgWait "57: "
	wait 3000
	#expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DBruno Bartholom"+JOCKER  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"58: "  ' m1s57a  ' pseudo
	wait 2000
	expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	expectMsgWait "59: "
	wait 2000
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a

# Press L1 on Phone C to call Phone A

	expectMsgSend SUBC,Do.KeyL1,Key.Click,"60: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    expectMsgSend SUBC,Do.Keys,SUBA.number,"61: "  ' m1s57b  ' pseudo   
    expectMsgWait "62: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
#Press Dial
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"63: "  ' m1s57b  ' pseudo    
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "64: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "65: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait
	wait 2000
	
# Press L1 on Phone A to pick up the call
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"66: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "67: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 3000

# Press xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"68: "  ' m1s57a  ' pseudo
	wait 2000
	
# Dial *301 to park the call
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
	wait 2000
	expectMsgSend SUBA,Do.Keys,"*301","69: "  ' m1s57a  ' pseudo
    expectMsgWait "70: "
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"71: "  ' m1s57a  ' pseudo
	expectMsgWait "72: "
	wait 3000
	#expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink ' m1s57a
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"^DCindy Christens"+JOCKER  ' m1s57a
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"73: "  ' m1s57a  ' pseudo
	wait 2000
	expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	expectMsgWait "74: "
	wait 2000
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
    
# Pickup Phone B
	expectMsgWait "75: "
	wait 5000
	expectMsgSend SUBA,Do.Keys,"*302100","76: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"77: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink ' m1s57a
    expectMsgAdd SUBA,Do.KeyF9,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 5000
	
# Press Goodbye on Phone A
	expectMsgWait "78: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"79: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a

# Pickup Phone C
	expectMsgWait "80: "
	wait 5000
	expectMsgSend SUBA,Do.Keys,"*302101","81: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"82: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF9,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
# Press Goodbye on Phone A
	expectMsgWait "83: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"84: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF9,Key.LightOff  ' m1s57a	

# Press Goodbye on Phone A, Phone B and Phone C
	expectMsgWait "85: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"86: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"87: "  ' m1s57a  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"88: "  ' m1s57a  ' pseudo
	
    
	    
  WEND
ENDTC '411101






################################################################################################

'TC 411102- Basic Metaswitch Park/Pickup Testcase Park on One Phone and Pick from the other Phone.
TESTCASE 411102
  LOCAL title="411102- Basic Metaswitch Park/Pickup on Two Phones"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)

# Press Goodbye Key
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57e  ' pseudo
    wait 1000
	
# Ensure Hook ON

	expectMsgSend SUBC,Do.Hook,Hook.On,"3: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"5: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"5: "  ' m1s57e  ' pseudo
	
# Press L1 on Phone B to call Phone C

	expectMsgSend SUBB,Do.KeyL1,Key.Click,"45: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBC.number,"46: "  ' m1s57b  ' pseudo   
    expectMsgWait "47: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57b
    wait 1000
	
#Press Dial
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"48: "  ' m1s57b  ' pseudo    
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57a   
    expectMsgWait "49: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "50: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait
	wait 2000
	
# Press L1 on Phone C to pick up the call
	expectMsgSend SUBC,Do.KeyL1,Key.Click,"51: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "52: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 2000

# Press xfer on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"53: "  ' m1s57a  ' pseudo
	wait 2000
	
# Dial *301 to park the call
	expectMsgSend SUBB,Do.Keys,"*301","54: "  ' m1s57a  ' pseudo
    expectMsgWait "55: "
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"56: "  ' m1s57a  ' pseudo
	expectMsgWait "57: "
	wait 3000
	#expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57a
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"58: "  ' m1s57a  ' pseudo
	wait 2000
	expectMsgAdd SUBB,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	
	expectMsgWait "59: "
	wait 2000
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57a


# Pickup Phone C from A
	expectMsgWait "75: "
	wait 5000
	expectMsgSend SUBA,Do.Keys,"*302100","76: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"77: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a
	expectMsgAdd SUBB,Do.KeyF8,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 5000
	
# Press Goodbye on Phone A
	expectMsgWait "78: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"79: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a


# Press Goodbye on Phone A, Phone B and Phone C
	expectMsgWait "85: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"86: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"87: "  ' m1s57a  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"88: "  ' m1s57a  ' pseudo
	

	    
  WEND
ENDTC '411102






################################################################################################

'TC 411201- Enhanced Metaswitch Park/Pickup Testcase
TESTCASE 411201
  LOCAL title="411201- Enhanced Metaswitch Park/Pickup Testcase"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)

# Press Goodbye Key
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57e  ' pseudo
    wait 1000
	
# Ensure Hook ON

	expectMsgSend SUBC,Do.Hook,Hook.On,"3: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"5: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"5: "  ' m1s57e  ' pseudo

	
# Press L1 on Phone B to call Phone A

	expectMsgSend SUBB,Do.KeyL1,Key.Click,"45: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBA.number,"46: "  ' m1s57b  ' pseudo   
    expectMsgWait "47: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
#Press Dial
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"48: "  ' m1s57b  ' pseudo    
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "49: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "50: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    #expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait
	wait 2000
	
# Press L1 on Phone A to pick up the call
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"51: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "52: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 2000

# Press blf/xfer on Phone A to park the call
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"53: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 5000
	
	
# Check TUI for Phone A
	expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	expectMsgWait "59: "
	#@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a
	wait 2000
    

# Press L1 on Phone C to call Phone A

	expectMsgSend SUBC,Do.KeyL1,Key.Click,"60: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    expectMsgSend SUBC,Do.Keys,SUBA.number,"61: "  ' m1s57b  ' pseudo   
    expectMsgWait "62: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    wait 1000
	
#Press Dial
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"63: "  ' m1s57b  ' pseudo    
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Yes  ' m1s57a   
    expectMsgWait "64: "
    #@###expectTextCheck SUBA,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57a
    expectMsgWait "65: "
    #@#checkGetStateText SUBA,Do.Name,GET_MATCHTEXT+JOCKER+"Cindy Christens"+JOCKER  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait
	wait 2000
	
# Press L1 on Phone A to pick up the call
	expectMsgSend SUBA,Do.KeyL1,Key.Click,"66: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBA,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "67: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBA.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 3000

# Press blf/xfer on Phone A
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"53: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 5000
	
# Check TUI for Phone A
	expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF9,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBA,Do.KeyL1,Key.LightOff  ' m1s57a
	expectMsgWait "59: "
	wait 5000
 
# Pickup Phone B
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"53.5: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF9,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
	
# Press Goodbye on Phone A
	expectMsgWait "78: "
	wait 6000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"79: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBB,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF9,Key.LightActiveBlink  ' m1s57a

# Pickup Phone C
	expectMsgWait "80: "
	wait 5000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U9,"82: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF9,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	
# Press Goodbye on Phone A
	expectMsgWait "83: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"84: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF9,Key.LightOff  ' m1s57a	

# Press Goodbye on Phone A, Phone B and Phone C
	expectMsgWait "85: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"86: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"87: "  ' m1s57a  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"88: "  ' m1s57a  ' pseudo
	

	    
  WEND
ENDTC '411201






################################################################################################

'TC 411202- Enhanced Metaswitch Park/Pickup Testcase Park on One Phone and Pick from the other Phone.
TESTCASE 411202
  LOCAL title="411103- Enhanced Metaswitch Park/Pickup on Two Phones"
  setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
  WHILE SETTERM(title,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x,M.I5x)

# Press Goodbye Key
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57e  ' pseudo
    wait 1000
	
# Ensure Hook ON

	expectMsgSend SUBC,Do.Hook,Hook.On,"3: "  ' m1s57c  ' pseudo
    expectMsgSend SUBB,Do.Hook,Hook.On,"4: "  ' m1s57b  ' pseudo
    expectMsgSend SUBA,Do.Hook,Hook.On,"5: "  ' m1s57a  ' pseudo
	expectMsgSend SUBD,Do.Hook,Hook.On,"5: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Hook,Hook.On,"5: "  ' m1s57e  ' pseudo
	
# Press L1 on Phone B to call Phone C

	expectMsgSend SUBB,Do.KeyL1,Key.Click,"45: "  ' m1s57b  ' pseudo
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Dial  ' m1s57b   
    expectMsgSend SUBB,Do.Keys,SUBC.number,"46: "  ' m1s57b  ' pseudo   
    expectMsgWait "47: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57b
    wait 1000
	
#Press Dial
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"48: "  ' m1s57b  ' pseudo    
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.InbandTone,InbandTone.Alerting  ' m1s57b
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Intern  ' m1s57a   
    expectMsgWait "49: "
    expectTextCheck SUBC,Do.Number,GET_MATCHTEXT+JOCKER+SUBB.number+JOCKER  ' m1s57a
    expectMsgWait "50: "
    checkGetStateText SUBC,Do.Name,GET_MATCHTEXT+JOCKER+"Bruno Bartholom"+JOCKER  ' m1s57a
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightActiveBlink  ' m1s57a
    expectMsgAdd SUBC,Do.KeyMessage,Key.LightOff  ' m1s57a
    expectMsgWait
	wait 2000
	
# Press L1 on Phone C to pick up the call
	expectMsgSend SUBC,Do.KeyL1,Key.Click,"51: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBC,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.KeyL1,Key.LightActive  ' m1s57a
    expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57a
    expectMsgAdd SUBC,Do.Ringing,Ringing.Quiet  ' m1s57a
    expectMsgAdd SUBB,Do.KeyLoudspeaker,Key.LightActive  ' m1s57b
    expectMsgAdd SUBB,Do.KeyL1,Key.LightActive  ' m1s57b
    expectMsgWait "52: "
    #@#expectTextCheck SUBB,Do.Number,GET_MATCHTEXT+JOCKER+SUBC.number+JOCKER  ' m1s57b
    expectMsgWait
	wait 2000

# Press blf/xfer on Phone B
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U8,"53: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 4000
	
# Check TUI for Phone A
	expectMsgAdd SUBA,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBB,Do.KeyF8,Key.LightActiveBlink  ' m1s57a
	expectMsgAdd SUBB,Do.KeyL1,Key.LightOff  ' m1s57a
	expectMsgWait "59: "
	wait 2000
    #@#checkGetStateText SUBB,Do.Name,GET_MATCHTEXT+JOCKER+"Call Transferred"+JOCKER  ' m1s57a


# Pickup Phone C from A
	expectMsgWait "75: "
	wait 2000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U8,"77: "  ' m1s57a  ' pseudo
    expectMsgAdd SUBA,Do.KeyLoudspeaker,Key.LightActive  ' m1s57a
    expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a
	expectMsgAdd SUBB,Do.KeyF8,Key.LightOff  ' m1s57a
    expectMsgAdd SUBA,Do.KeyL1,Key.LightActive  ' m1s57a
    #expectMsgAdd SUBA,Do.InbandTone,InbandTone.Dial  ' m1s57a
	expectMsgAdd SUBA,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.Yes  ' m1s57a
	expectMsgAdd SUBA,Do.InbandTone,InbandTone.Quiet  ' m1s57a
	wait 5000
	
# Press Goodbye on Phone A
	expectMsgWait "78: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"79: "  ' m1s57a  ' pseudo
	expectMsgAdd SUBA,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBC,Do.Connected,Connected.No  ' m1s57a
	expectMsgAdd SUBA,Do.KeyF8,Key.LightOff  ' m1s57a


# Press Goodbye on Phone A, Phone B and Phone C
	expectMsgWait "85: "
	wait 3000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"86: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"87: "  ' m1s57a  ' pseudo
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.End,"88: "  ' m1s57a  ' pseudo
	

	    
  WEND
ENDTC '411202






##########################################################################################################
####################################################################################################################

'TC 75 Adding Numbers to the Directories
TESTCASE 75
LOCAL title="Testcase 75 Adding Numbers to the Directories"
setFixSubNames BMode.temphard,"m1s57a","m1s57b","m1s57c","m1s57d","m1s57e"
	WHILE SETTERM(title,ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY(),ANY())

	#Press Goodbye
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"0: "
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"0: "
	
	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"5: "
    expectMsgSend SUBB,Do.Hook,Hook.On,"5: "
	expectMsgSend SUBC,Do.Hook,Hook.On,"5: "
	expectMsgSend SUBD,Do.Hook,Hook.On,"5: "
	expectMsgSend SUBE,Do.Hook,Hook.On,"5: "
	expectMsgWait
	wait 1000

	#Delete Directory
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"10: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"10: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"15: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"15: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"20: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"20: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U5,"25: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U5,"25: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"30: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"30: "
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U4,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U4,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U4,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	
	############################# Adding directory to Phone A ########################

	#Add Andy Anderson
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"35: "
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"40: "

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"2", "45: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"50: " 
	expectMsgSend SUBA,Do.Keys,"663999","55: "

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"2","70: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"75: "
	
    expectMsgSend SUBA,Do.Keys,"6631","80: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"85: "

    expectMsgSend SUBA,Do.Keys,"337771","90: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"95: "
	
    expectMsgSend SUBA,Do.Keys,"77776661","100: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"105: "
	
    expectMsgSend SUBA,Do.Keys,"66","110: "  ' m1s57a  ' pseudo

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"115: "  ' m1s57a  ' pseudo
	expectMsgWait "116"
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"120: "  ' m1s57a  ' pseudo
	expectMsgWait "117"
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"121: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.Keys,SUBA.number,"125: "  ' m1s57a  ' pseudo

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"130: "  ' m1s57a  ' pseudo	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"135: "  ' m1s57b  ' pseudo
	expectMsgWait "140: "
	wait 10000
	
	#Add Bruno Bartholom
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"22", "155: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"160: "
	
	expectMsgSend SUBA,Do.Keys,"77788661","165: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"170: "
	
	expectMsgSend SUBA,Do.Keys,"666","175: "  ' m1s57a  ' pseudo
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"22","190: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"195: "
	
	expectMsgSend SUBA,Do.Keys,"27778446665556661","200: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"205: "
	
	expectMsgSend SUBA,Do.Keys,"6","210: "  ' m1s57b  ' pseudo

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"215: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"220: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.Keys,SUBB.number,"225: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"230: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"235: "  ' m1s57a  ' pseudo
	expectMsgWait "240: "
	wait 10000
	
	#Add Cindy Christens
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"222", "255: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"260: "
	
	expectMsgSend SUBA,Do.Keys,"444663999","265: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"222","280: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"285: "
	
	expectMsgSend SUBA,Do.Keys,"447774447777833667777","290: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"295: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"300: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo
	expectMsgWait
	wait 10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 2000
    expectMsgSend SUBA,Do.Keys,SUBC.number,"305: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"310: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"315: "  ' m1s57a  ' pseudo
	expectMsgWait "320: "
	wait 10000
	
	#Add Daniel Dacascos
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"3", "335: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"340: "

	expectMsgSend SUBA,Do.Keys,"26644433555","345: "  ' m1s57a  ' pseudo
	

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"3","360: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"365: "
	
	expectMsgSend SUBA,Do.Keys,"21","370: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"375: "
	
	expectMsgSend SUBA,Do.Keys,"2221","380: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"385: "
	
	expectMsgSend SUBA,Do.Keys,"277772226667777","390: "  ' m1s57a  ' pseudo

    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"395: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"400: "
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"400: "
	expectMsgWait
	wait 10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.Keys,SUBD.number,"405: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"410: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"415: "  ' m1s57a  ' pseudo
	expectMsgWait "420: "
	wait 10000
	
	#Add Emile Eastwood
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"33", "435: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"440: "
	
	expectMsgSend SUBA,Do.Keys,"644455533","445: "  ' m1s57a  ' pseudo

	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBA,Do.Keys,"33","460: "
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U3,"465: "

	expectMsgSend SUBA,Do.Keys,"27777896661","470: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U2,"475: "
	
	expectMsgSend SUBA,Do.Keys,"6663","480: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up,"485: "  ' m1s57a  ' pseudo
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Up
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Right,"400: "
	expectMsgWait
	wait 10000
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBA,Do.Keys,SUBE.number,"490: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.U1,"495: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBA,Do.PredefKeys,PredefKeys.End,"500: "  ' m1s57a  ' pseudo
	expectMsgWait "505: "
	wait 10000

	
	################ Adding directory to Phone B #############################

	#Add Andy Anderson
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"35: "
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"40: "

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"2", "45: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"50: " 
	expectMsgSend SUBB,Do.Keys,"663999","55: "

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"2","70: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"75: "
	
    expectMsgSend SUBB,Do.Keys,"6631","80: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"85: "

    expectMsgSend SUBB,Do.Keys,"337771","90: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"95: "
	
    expectMsgSend SUBB,Do.Keys,"77776661","100: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"105: "
	
    expectMsgSend SUBB,Do.Keys,"66","110: "  ' m1s57a  ' pseudo

    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"115: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"120: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"121: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.Keys,SUBA.number,"125: "  ' m1s57a  ' pseudo

    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"130: "  ' m1s57a  ' pseudo	
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"135: "  ' m1s57b  ' pseudo
	expectMsgWait "140: "
	wait 10000
	
	#Add Bruno Bartholom
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"22", "155: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"160: "
	
	expectMsgSend SUBB,Do.Keys,"77788661","165: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"170: "
	
	expectMsgSend SUBB,Do.Keys,"666","175: "  ' m1s57a  ' pseudo
	

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"22","190: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"195: "
	
	expectMsgSend SUBB,Do.Keys,"27778446665556661","200: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"205: "
	
	expectMsgSend SUBB,Do.Keys,"6","210: "  ' m1s57b  ' pseudo

    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"215: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"220: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.Keys,SUBB.number,"225: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"230: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"235: "  ' m1s57a  ' pseudo
	expectMsgWait "240: "
	wait 10000
	
	#Add Cindy Christens
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"222", "255: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"260: "
	
	expectMsgSend SUBB,Do.Keys,"444663999","265: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"222","280: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"285: "
	
	expectMsgSend SUBB,Do.Keys,"447774447777833667777","290: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"295: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"300: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.Keys,SUBC.number,"305: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"310: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"315: "  ' m1s57a  ' pseudo
	expectMsgWait "320: "
	wait 10000
	
	#Add Daniel Dacascos
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"3", "335: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"340: "

	expectMsgSend SUBB,Do.Keys,"26644433555","345: "  ' m1s57a  ' pseudo
	

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"3","360: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"365: "
	
	expectMsgSend SUBB,Do.Keys,"21","370: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"375: "
	
	expectMsgSend SUBB,Do.Keys,"2221","380: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"385: "
	
	expectMsgSend SUBB,Do.Keys,"277772226667777","390: "  ' m1s57a  ' pseudo

    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"395: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"400: "
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"400: "

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.Keys,SUBD.number,"405: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"410: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"415: "  ' m1s57a  ' pseudo
	expectMsgWait "420: "
	wait 10000
	
	#Add Emile Eastwood
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U7,"145: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"120: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"150: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"33", "435: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"440: "
	
	expectMsgSend SUBB,Do.Keys,"644455533","445: "  ' m1s57a  ' pseudo

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBB,Do.Keys,"33","460: "
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U3,"465: "

	expectMsgSend SUBB,Do.Keys,"27777896661","470: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U2,"475: "
	
	expectMsgSend SUBB,Do.Keys,"6663","480: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up,"485: "  ' m1s57a  ' pseudo
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Up
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Right,"400: "

	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
    expectMsgSend SUBB,Do.Keys,SUBE.number,"490: "  ' m1s57a  ' pseudo
	
	expectMsgSend SUBB,Do.PredefKeys,PredefKeys.U1,"495: "  ' m1s57a  ' pseudo
	
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.End,"500: "  ' m1s57a  ' pseudo
	expectMsgWait "505: "
	wait 10000

	
	################ Adding Directory to Phones C, D and E #################################
	#Add Andy Anderson
   
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.Keys,"2663999**","2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"2663999**","2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"2663999**","2: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"2","11: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"2","11: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"2","11: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
	expectMsgSend SUBC,Do.Keys,"663","12: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"663","12: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"663","12: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
	expectMsgSend SUBC,Do.Keys,"33777","15: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"33777","15: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"33777","15: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"7777666","20: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"7777666","20: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"7777666","20: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"66","26: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"66","26: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"66","26: "  ' m1s57e  ' pseudo


	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Keys,SUBA.number,"35: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,SUBA.number,"35: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,SUBA.number,"35: "  ' m1s57e  ' pseudo    

	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57e  ' pseudo
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57b  ' pseudo
    
	#Add Bruno Bartholom
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
   
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.Keys,"227778866","2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"227778866","2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"227778866","2: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 4000
	
	expectMsgSend SUBC,Do.Keys,"666**","11: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"666**","11: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"666**","11: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"22","15: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"22","15: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"22","15: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"2777844666555666","20: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"2777844666555666","20: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"2777844666555666","20: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 5000
	
	expectMsgSend SUBC,Do.Keys,"6","26: "  ' m1s57b  ' pseudo
	expectMsgSend SUBD,Do.Keys,"6","26: "  ' m1s57b  ' pseudo
	expectMsgSend SUBE,Do.Keys,"6","26: "  ' m1s57b  ' pseudo
	expectMsgWait
	wait 3000
	

	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Keys,SUBB.number,"35: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,SUBB.number,"35: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,SUBB.number,"35: "  ' m1s57e  ' pseudo  
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57e  ' pseudo
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57e  ' pseudo
	
	#Add Cindy Christens
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.Keys,"222444663999**","2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"222444663999**","2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"222444663999**","2: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 4500
	
	expectMsgSend SUBC,Do.Keys,"222","9: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"222","9: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"222","9: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
	expectMsgSend SUBC,Do.Keys,"447774447777833667777","11: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"447774447777833667777","11: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"447774447777833667777","11: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	

	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Keys,SUBC.number,"35: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,SUBC.number,"35: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,SUBC.number,"35: "  ' m1s57e  ' pseudo  
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57e  ' pseudo
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57e  ' pseudo
	
	#Add Daniel Dacascos
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.Keys,"326644433555**","2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"326644433555**","2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"326644433555**","2: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 7500

	expectMsgSend SUBC,Do.Keys,"3","11: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"3","11: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"3","11: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
	expectMsgSend SUBC,Do.Keys,"2","13: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"2","13: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"2","13: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"222","15: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"222","15: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"222","15: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"277772226667777","20: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"277772226667777","20: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"277772226667777","20: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 4000
	

	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Keys,SUBD.number,"35: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,SUBD.number,"35: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,SUBD.number,"35: "  ' m1s57e  ' pseudo  
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57e  ' pseudo
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57e  ' pseudo
	
	#Add Emile Eastwood
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U7,"0: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U3,"1: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 1000
	
	expectMsgSend SUBC,Do.Keys,"33644455533**","2: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"33644455533**","2: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"33644455533**","2: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 4000
	
	expectMsgSend SUBC,Do.Keys,"33","11: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"33","11: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"33","11: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	
	expectMsgSend SUBC,Do.Keys,"2777789666","11: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"2777789666","11: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"2777789666","11: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 3000
	
	expectMsgSend SUBC,Do.Keys,"6663","11: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,"6663","11: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,"6663","11: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2000
	

	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.Down
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.Down
	expectMsgWait
	wait 1000
	expectMsgSend SUBC,Do.Keys,SUBE.number,"35: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.Keys,SUBE.number,"35: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.Keys,SUBE.number,"35: "  ' m1s57e  ' pseudo  
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U1,"40: "  ' m1s57e  ' pseudo
	
	expectMsgSend SUBC,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57c  ' pseudo
	expectMsgSend SUBD,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57d  ' pseudo
	expectMsgSend SUBE,Do.PredefKeys,PredefKeys.U6,"41: "  ' m1s57e  ' pseudo
	expectMsgWait "535: "
	wait 5000
	
	#Initial State
	
	expectMsgSend SUBA,Do.PredefKeys,PredefKeys.No,"0: "  ' m1s57a  ' pseudo
    expectMsgSend SUBB,Do.PredefKeys,PredefKeys.No,"1: "  ' m1s57b  ' pseudo
    expectMsgSend SUBC,Do.PredefKeys,PredefKeys.No,"2: "  ' m1s57c  ' pseudo
    expectMsgSend SUBD,Do.PredefKeys,PredefKeys.No,"3: "  ' m1s57d  ' pseudo
    expectMsgSend SUBE,Do.PredefKeys,PredefKeys.No,"4: "  ' m1s57e  ' pseudo
	expectMsgWait
	wait 2500

	#Hook On Phones
	expectMsgSend SUBA,Do.Hook,Hook.On,"550: "
	expectMsgSend SUBB,Do.Hook,Hook.On,"550: "
	expectMsgSend SUBC,Do.Hook,Hook.On,"550: "
	expectMsgSend SUBD,Do.Hook,Hook.On,"550: "
	expectMsgSend SUBE,Do.Hook,Hook.On,"550: "
	expectMsgWait "555: "
	wait 3000

	WEND
ENDTC '75





